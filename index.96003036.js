let t,e,i,n,r;function s(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}function a(t){return t&&t.__esModule?t.default:t}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},h={},l={},u=o.parcelRequire075c;null==u&&((u=function(t){if(t in h)return h[t].exports;if(t in l){var e=l[t];delete l[t];var i={id:t,exports:{}};return h[t]=i,e.call(i.exports,i,i.exports),i.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){l[t]=e},o.parcelRequire075c=u);var c=u.register;c("hFpCu",function(t,e){/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(e,i){var n=(e=e||u("gFNhN")).window,r=e.document,s=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],n=e.slice,r=Object.create,s=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=e.forEach||function(t,e){for(var i=0,n=this.length;i<n;i++)t.call(e,this[i],i,this)},h=function(t,e){for(var i in this)this.hasOwnProperty(i)&&t.call(e,this[i],i,this)},l=Object.assign||function(t){for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t},u=function(t,e,i){if(t){var n=s(t,"length");(n&&"number"==typeof n.value?o:h).call(t,e,i=i||t)}return i};function c(e,i,n,r,o){var h={};function l(t,l){"string"==typeof(l=l||(l=s(i,t))&&(l.get?l:l.value))&&"#"===l[0]&&(l=e[l.substring(1)]||l);var u,c="function"==typeof l,f=l,p=o||c&&!l.base?l&&l.get?t in e:e[t]:null;o&&p||(c&&p&&(l.base=p),c&&!1!==r&&(u=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(h[u[3].toLowerCase()+u[4]]=u[2]),f&&!c&&f.get&&"function"==typeof f.get&&d.isPlainObject(f)||(f={value:f,writable:!0}),(s(e,t)||{configurable:!0}).configurable&&(f.configurable=!0,f.enumerable=null!=n?n:!u),a(e,t,f))}if(i){for(var u in i)i.hasOwnProperty(u)&&!t.test(u)&&l(u);for(var u in h){var c=h[u],f=e["set"+c],p=e["get"+c]||f&&e["is"+c];p&&(!0===r||0===p.length)&&l(u,{get:p,set:f})}}return e}function d(){for(var t=0,e=arguments.length;t<e;t++){var i=arguments[t];i&&l(this,i)}return this}return c(d,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,i=t.beans,n=t.preserve;e!==t&&c(this.prototype,t,t.enumerable,i,n),c(this,e,null,i,n)}for(var r=1,s=arguments.length;r<s;r++)this.inject(arguments[r]);return this},extend:function(){for(var t,e,i,n=this,s=0,o=arguments.length;s<o&&!(t&&e);s++)i=arguments[s],t=t||i.initialize,e=e||i.prototype;return a(e=(t=t||function(){n.apply(this,arguments)}).prototype=e||r(this.prototype),"constructor",{value:t,writable:!0,configurable:!0}),c(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=n,t}}).inject({enumerable:!1,initialize:d,set:d,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var i=arguments[t];i&&c(this,i,i.enumerable,i.beans,i.preserve)}return this},extend:function(){var t=r(this);return t.inject.apply(t,arguments)},each:function(t,e){return u(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:l,each:u,create:r,define:a,describe:s,clone:function(t){return l(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===d||"Object"===e.name)},pick:function(t,e){return t!==i?t:e},slice:function(t,e,i){return n.call(t,e,i)}}})};t.exports=s,s.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+s.each(this,function(t,e){if(!/^_/.test(e)){var i=typeof t;this.push(e+": "+("number"===i?c.instance.number(t):"string"===i?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return s.importJSON(t,this)},exportJSON:function(t){return s.exportJSON(this,t)},toJSON:function(){return s.serialize(this)},set:function(t,e){return t&&s.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),i=e.prototype._class;return i&&!s.exports[i]&&(s.exports[i]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){var i=t.length;if(i!==e.length)return!1;for(;i--;)if(!s.equals(t[i],e[i]))return!1}else{var n=Object.keys(t),i=n.length;if(i!==Object.keys(e).length)return!1;for(;i--;){var r=n[i];if(!(e.hasOwnProperty(r)&&s.equals(t[r],e[r])))return!1}}return!0}return!1},read:function(t,e,n,r){if(this===s){var a=this.peek(t,e);return t.__index++,a}var o=this.prototype,h=o._readIndex,l=e||h&&t.__index||0,u=t.length,c=t[l];if(r=r||u-l,c instanceof this||n&&n.readNull&&null==c&&r<=1)return h&&(t.__index=l+1),c&&n&&n.clone?c.clone():c;if(c=s.create(o),h&&(c.__read=!0),c=c.initialize.apply(c,l>0||l+r<u?s.slice(t,l,l+r):t)||c,h){t.__index=l+c.__read;var d=c.__filtered;d&&(t.__filtered=d,c.__filtered=i),c.__read=i}return c},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,i,n){for(var r,s=[],a=e||0,o=n?a+n:t.length,h=a;h<o;h++)s.push(Array.isArray(r=t[h])?this.read(r,0,i):this.read(t,h,i,1));return s},readNamed:function(t,e,n,r,a){var o=this.getNamed(t,e),h=o!==i;if(h){var l=t.__filtered;if(!l){var u=this.getSource(t);(l=t.__filtered=s.create(u)).__unfiltered=u}l[e]=i}return this.read(h?[o]:t,n,r,a)},readSupported:function(t,e){var n=this.getSource(t),r=this,s=!1;return n&&Object.keys(n).forEach(function(n){if(n in e){var a=r.readNamed(t,n);a!==i&&(e[n]=a),s=!0}}),s},getSource:function(t){var e=t.__source;if(e===i){var n=1===t.length&&t[0];e=t.__source=n&&s.isPlainObject(n)?n:null}return e},getNamed:function(t,e){var i=this.getSource(t);if(i)return e?i[e]:t.__filtered||i},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,n,r){function s(r){if(!(n&&r in n)&&!(a&&r in a)){var s=e[r];s!==i&&(t[r]=s)}}if(r){for(var a,o,h={},l=0,u=r.length;l<u;l++)(o=r[l])in e&&(s(o),h[o]=!0);a=h}return Object.keys(e.__unfiltered||e).forEach(s),t},isPlainValue:function(t,e){return s.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,i,n){e=e||{};var r,a=!n;if(a&&(e.formatter=new c(e.precision),n={length:0,definitions:{},references:{},add:function(t,e){var i="#"+t._id,n=this.references[i];if(!n){this.length++;var r=e.call(t),s=t._class;s&&r[0]!==s&&r.unshift(s),this.definitions[i]=r,n=this.references[i]=[i]}return n}}),t&&t._serialize){r=t._serialize(e,n);var o=t._class;o&&!t._compactSerialize&&(a||!i)&&r[0]!==o&&r.unshift(o)}else if(Array.isArray(t)){r=[];for(var h=0,l=t.length;h<l;h++)r[h]=s.serialize(t[h],e,i,n)}else if(s.isPlainObject(t)){r={};for(var u=Object.keys(t),h=0,l=u.length;h<l;h++){var d=u[h];r[d]=s.serialize(t[d],e,i,n)}}else r="number"==typeof t?e.formatter.number(t,e.precision):t;return a&&n.length>0?[["dictionary",n.definitions],r]:r},deserialize:function(t,e,i,n,r){var a=t,o=!i,h=o&&t&&t.length&&"dictionary"===t[0][0];if(i=i||{},Array.isArray(t)){var l=t[0],u="dictionary"===l;if(1==t.length&&/^#/.test(l))return i.dictionary[l];l=s.exports[l],a=[];for(var c=l?1:0,d=t.length;c<d;c++)a.push(s.deserialize(t[c],e,i,u,h));if(l){var f=a;a=e?e(l,f,o||r):new l(f)}}else if(s.isPlainObject(t))for(var p in a={},n&&(i.dictionary=a),t)a[p]=s.deserialize(t[p],e,i);return h?a[1]:a},exportJSON:function(t,e){var i=s.serialize(t,e);return e&&!1==e.asString?i:JSON.stringify(i)},importJSON:function(t,e){return s.deserialize("string"==typeof t?JSON.parse(t):t,function(t,i,n){var r=n&&e&&e.constructor===t,a=r?e:s.create(t.prototype);if(1===i.length&&a instanceof k&&(r||!(a instanceof S))){var o=i[0];s.isPlainObject(o)&&(o.insert=!1,r&&(i=i.concat([k.INSERT])))}return(r?a.set:t).apply(a,i),r&&(e=null),a})},push:function(t,e){var i=e.length;if(i<4096)t.push.apply(t,e);else{var n=t.length;t.length+=i;for(var r=0;r<i;r++)t[n+r]=e[r]}return t},splice:function(t,e,n,r){var a=e&&e.length,o=n===i;(n=o?t.length:n)>t.length&&(n=t.length);for(var h=0;h<a;h++)e[h]._index=n+h;if(o)return s.push(t,e),[];var l=[n,r];e&&s.push(l,e);for(var u=t.splice.apply(t,l),h=0,c=u.length;h<c;h++)u[h]._index=i;for(var h=n+a,c=t.length;h<c;h++)t[h]._index=h;return u},capitalize:function(t){return t.replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(t,e){return e.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function(t,e){if("string"!=typeof t)s.each(t,function(t,e){this.on(e,t)},this);else{var i=this._eventTypes,n=i&&i[t],r=this._callbacks=this._callbacks||{};-1===(r=r[t]=r[t]||[]).indexOf(e)&&(r.push(e),n&&n.install&&1===r.length&&n.install.call(this,t))}return this},off:function(t,e){if("string"!=typeof t){s.each(t,function(t,e){this.off(e,t)},this);return}var i,n=this._eventTypes,r=n&&n[t],a=this._callbacks&&this._callbacks[t];return a&&(e&&(-1===(i=a.indexOf(e))||1!==a.length)?-1!==i&&a.splice(i,1):(r&&r.uninstall&&r.uninstall.call(this,t),delete this._callbacks[t])),this},once:function(t,e){return this.on(t,function i(){e.apply(this,arguments),this.off(t,i)})},emit:function(t,e){var i=this._callbacks&&this._callbacks[t];if(!i)return!1;var n=s.slice(arguments,1),r=e&&e.target&&!e.currentTarget;i=i.slice(),r&&(e.currentTarget=this);for(var a=0,o=i.length;a<o;a++)if(!1==i[a].apply(this,n)){e&&e.stop&&e.stop();break}return r&&delete e.currentTarget,!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,i=this._callbacks,n=t?"install":"uninstall";if(e){for(var r in i)if(i[r].length>0){var s=e[r],a=s&&s[n];a&&a.call(this,r)}}},statics:{inject:function t(e){var i=e._events;if(i){var n={};s.each(i,function(t,i){var r="string"==typeof t,a=r?t:i,o=s.capitalize(a),h=a.substring(2).toLowerCase();n[h]=r?{}:t,a="_"+a,e["get"+o]=function(){return this[a]},e["set"+o]=function(t){var e=this[a];e&&this.off(h,e),t&&this.on(h,t),this[a]=t}}),e._eventTypes=n}return t.base.apply(this,arguments)}}},o=s.extend({_class:"PaperScope",initialize:function t(){th=this,this.settings=new s({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var i=t.prototype;if(!this.support){var n=tr.getContext(1,1)||{};i.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:ts.nativeModes},tr.release(n)}if(!this.agent){var r=e.navigator.userAgent.toLowerCase(),a=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(r)||[])[0],o="darwin"===a?"mac":a,h=i.agent=i.browser={platform:o};o&&(h[o]=!0),r.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(t,e,i,n,r){if(!h.chrome){var s="opera"===e?n:/^(node|trident)$/.test(e)?r:i;h.version=s,h.versionNumber=parseFloat(s),e=({trident:"msie",jsdom:"node"})[e]||e,h.name=e,h[e]=!0}}),h.chrome&&delete h.webkit,h.atom&&delete h.chrome}},version:"0.12.17",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var i=th.PaperScript.execute(t,this,e);return W.updateFocus(),i},install:function(t){var e=this;for(var i in s.each(["project","view","tool"],function(i){s.define(t,i,{configurable:!0,get:function(){return e[i]}})}),this)!/^_/.test(i)&&this[i]&&(t[i]=this[i])},setup:function(t){return th=this,this.project=new w(t),this},createCanvas:function(t,e){return tr.getCanvas(t,e)},activate:function(){th=this},clear:function(){for(var t=this.projects,e=this.tools,i=t.length-1;i>=0;i--)t[i].remove();for(var i=e.length-1;i>=0;i--)e[i].remove()},remove:function(){this.clear(),delete o._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,i){return e[t](i)||e[t]("data-paper-"+i)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),h=s.extend(a,{initialize:function(t){this._scope=th,this._index=this._scope[this._list].push(this)-1,(t||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(s.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),l={findItemBoundsCollisions:function(t,e,i){function n(t){for(var e=Array(t.length),i=0;i<t.length;i++){var n=t[i].getBounds();e[i]=[n.left,n.top,n.right,n.bottom]}return e}var r=n(t),s=e&&e!==t?n(e):r;return this.findBoundsCollisions(r,s,i||0)},findCurveBoundsCollisions:function(t,e,i,n){function r(t){for(var e=Math.min,i=Math.max,n=Array(t.length),r=0;r<t.length;r++){var s=t[r];n[r]=[e(s[0],s[2],s[4],s[6]),e(s[1],s[3],s[5],s[7]),i(s[0],s[2],s[4],s[6]),i(s[1],s[3],s[5],s[7])]}return n}var s=r(t),a=e&&e!==t?r(e):s;if(n){for(var o=this.findBoundsCollisions(s,a,i||0,!1,!0),h=this.findBoundsCollisions(s,a,i||0,!0,!0),l=[],u=0,c=o.length;u<c;u++)l[u]={hor:o[u],ver:h[u]};return l}return this.findBoundsCollisions(s,a,i||0)},findBoundsCollisions:function(t,e,i,n,r){var s=!e||t===e,a=s?t:t.concat(e),o=t.length,h=a.length;function l(t,e,i){for(var n=0,r=t.length;n<r;){var s=r+n>>>1;a[t[s]][e]<i?n=s+1:r=s}return n-1}for(var u=n?1:0,c=u+2,d=n?0:1,f=d+2,p=Array(h),g=0;g<h;g++)p[g]=g;p.sort(function(t,e){return a[t][u]-a[e][u]});for(var m=[],_=Array(o),g=0;g<h;g++){var v=p[g],y=a[v],b=s?v:v-o,x=v<o,w=s||!x,k=x?[]:null;if(m.length){var C=l(m,c,y[u]-i)+1;if(m.splice(0,C),s&&r){k=k.concat(m);for(var S=0;S<m.length;S++){var I=m[S];_[I].push(b)}}else for(var E=y[f],T=y[d],S=0;S<m.length;S++){var I=m[S],A=a[I],P=I<o,M=s||I>=o;(r||(x&&M||w&&P)&&E>=A[d]-i&&T<=A[f]+i)&&(x&&M&&k.push(s?I:I-o),w&&P&&_[I].push(b))}}if(x&&(t===e&&k.push(v),_[v]=k),m.length){var O=y[c],L=l(m,c,O);m.splice(L+1,0,v)}else m.push(v)}for(var g=0;g<_.length;g++){var N=_[g];N&&N.sort(function(t,e){return t-e})}return _}},c=s.extend({initialize:function(t){this.precision=s.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,i){return this.number(t)+(i||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});c.instance=new c;var d=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],i=Math.abs,n=Math.sqrt,r=Math.pow,s=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function a(t,e,i){return t<e?e:t>i?i:t}function o(t,e,n){function r(t){var e=134217729*t,i=t-e+e;return[i,t-i]}var s=e*e-t*n,a=e*e+t*n;if(3*i(s)<a){var o=r(t),h=r(e),l=r(n),u=e*e,c=h[0]*h[0]-u+2*h[0]*h[1]+h[1]*h[1],d=t*n,f=o[0]*l[0]-d+o[0]*l[1]+o[1]*l[0]+o[1]*l[1];s=u-d+(c-f)}return s}function h(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?r(2,-Math.round(s(t))):0}return{EPSILON:1e-12,MACHINE_EPSILON:112e-18,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(n(2)-1)/3,isZero:function(t){return t>=-.000000000001&&t<=1e-12},isMachineZero:function(t){return t>=-.000000000000000112&&t<=112e-18},clamp:a,integrate:function(i,n,r,s){for(var a=t[s-2],o=e[s-2],h=(r-n)*.5,l=h+n,u=0,c=s+1>>1,d=1&s?o[u++]*i(l):0;u<c;){var f=h*a[u];d+=o[u++]*(i(l+f)+i(l-f))}return h*d},findRoot:function(t,e,n,r,s,o,h){for(var l=0;l<o;l++){var u=t(n),c=u/e(n),d=n-c;if(i(c)<h){n=d;break}u>0?(s=n,n=d<=r?(r+s)*.5:d):(r=n,n=d>=s?(r+s)*.5:d)}return a(n,r,s)},solveQuadratic:function(t,e,r,s,l,u){var c,d=1/0;if(1e-12>i(t)){if(1e-12>i(e))return 1e-12>i(r)?-1:0;c=-r/e}else{var f=o(t,e*=-.5,r);if(f&&112e-18>i(f)){var p=h(i(t),i(e),i(r));p&&(t*=p,e*=p,r*=p,f=o(t,e,r))}if(f>=-.000000000000000112){var g=f<0?0:n(f),m=e+(e<0?-g:g);0===m?d=-(c=r/t):(c=m/t,d=r/m)}}var _=0,v=null==l,y=l-1e-12,b=u+1e-12;return isFinite(c)&&(v||c>y&&c<b)&&(s[_++]=v?c:a(c,l,u)),d!==c&&isFinite(d)&&(v||d>y&&d<b)&&(s[_++]=v?d:a(d,l,u)),_},solveCubic:function(t,e,s,o,l,u,c){var f,p,g,m,_,v=h(i(t),i(e),i(s),i(o));function y(i){var n=t*(f=i);g=(p=n+e)*f+s,m=(n+p)*f+g,_=g*f+o}if(v&&(t*=v,e*=v,s*=v,o*=v),1e-12>i(t))t=e,p=s,g=o,f=1/0;else if(1e-12>i(o))p=e,g=s,f=0;else{y(-(e/t)/3);var b=_/t,x=r(i(b),1/3),w=b<0?-1:1,k=-m/t,C=k>0?1.324717957244746*Math.max(x,n(k)):x,S=f-w*C;if(S!==f){do y(S),S=0===m?f:f-_/m/1.0000000000000002;while(w*S>w*f)i(t)*f*f>i(o/f)&&(p=((g=-o/f)-s)/f)}}var I=d.solveQuadratic(t,p,g,l,u,c),E=null==u;return isFinite(f)&&(0===I||I>0&&f!==l[0]&&f!==l[1])&&(E||f>u-1e-12&&f<c+1e-12)&&(l[I++]=E?f:a(f,u,c)),I}}},f={_id:1,_pools:{},get:function(t){if(!t)return this._id++;var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}},p=s.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var i=typeof t,n=this.__read,r=0;if("number"===i){var s="number"==typeof e;this._set(t,s?e:t),n&&(r=s?2:1)}else if("undefined"===i||null===t)this._set(0,0),n&&(r=null===t?1:0);else{var a="string"===i?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"x"in a?this._set(a.x||0,a.y||0):"width"in a?this._set(a.width||0,a.height||0):"angle"in a?(this._set(a.length||0,0),this.setAngle(a.angle||0)):(this._set(0,0),r=0)}return n&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new p(this.x,this.y)},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var i=t/this.getLength();d.isZero(i)&&this.getAngle(),this._set(this.x*i,this.y*i)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);var t=p.read(arguments),e=this.getLength()*t.getLength();if(d.isZero(e))return NaN;var i=this.dot(t)/e;return Math.acos(i<-1?-1:i>1?1:i)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=p.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=p.read(t),i=e.x-this.x,n=e.y-this.y,r=i*i+n*n;return s.read(t)?r:Math.sqrt(r)},normalize:function(t){t===i&&(t=1);var e=this.getLength(),n=0!==e?t/e:0,r=new p(this.x*n,this.y*n);return n>=0&&(r._angle=this._angle),r},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var i=e?this.subtract(e):this,n=Math.sin(t),r=Math.cos(t);return i=new p(i.x*r-i.y*n,i.x*n+i.y*r),e?i.add(e):i},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=p.read(arguments);return new p(this.x+t.x,this.y+t.y)},subtract:function(){var t=p.read(arguments);return new p(this.x-t.x,this.y-t.y)},multiply:function(){var t=p.read(arguments);return new p(this.x*t.x,this.y*t.y)},divide:function(){var t=p.read(arguments);return new p(this.x/t.x,this.y/t.y)},modulo:function(){var t=p.read(arguments);return new p(this.x%t.x,this.y%t.y)},negate:function(){return new p(-this.x,-this.y)},isInside:function(){return v.read(arguments).contains(this)},isClose:function(){var t=arguments,e=p.read(t),i=s.read(t);return this.getDistance(e)<=i},isCollinear:function(){var t=p.read(arguments);return p.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=p.read(arguments);return p.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=d.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=p.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=p.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=p.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new p(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=p.read(t),i=p.read(t);return new p(Math.min(e.x,i.x),Math.min(e.y,i.y))},max:function(){var t=arguments,e=p.read(t),i=p.read(t);return new p(Math.max(e.x,i.x),Math.max(e.y,i.y))},random:function(){return new p(Math.random(),Math.random())},isCollinear:function(t,e,i,n){return Math.abs(t*n-e*i)<=1e-8*Math.sqrt((t*t+e*e)*(i*i+n*n))},isOrthogonal:function(t,e,i,n){return Math.abs(t*i+e*n)<=1e-8*Math.sqrt((t*t+e*e)*(i*i+n*n))}}},s.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new p(e(this.x),e(this.y))}},{})),g=p.extend({initialize:function(t,e,i,n){this._x=t,this._y=e,this._owner=i,this._setter=n},_set:function(t,e,i){return this._x=t,this._y=e,i||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),m=s.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var i=typeof t,n=this.__read,r=0;if("number"===i){var s="number"==typeof e;this._set(t,s?e:t),n&&(r=s?2:1)}else if("undefined"===i||null===t)this._set(0,0),n&&(r=null===t?1:0);else{var a="string"===i?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"width"in a?this._set(a.width||0,a.height||0):"x"in a?this._set(a.x||0,a.y||0):(this._set(0,0),r=0)}return n&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new m(this.width,this.height)},toString:function(){var t=c.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=m.read(arguments);return new m(this.width+t.width,this.height+t.height)},subtract:function(){var t=m.read(arguments);return new m(this.width-t.width,this.height-t.height)},multiply:function(){var t=m.read(arguments);return new m(this.width*t.width,this.height*t.height)},divide:function(){var t=m.read(arguments);return new m(this.width/t.width,this.height/t.height)},modulo:function(){var t=m.read(arguments);return new m(this.width%t.width,this.height%t.height)},negate:function(){return new m(-this.width,-this.height)},isZero:function(){var t=d.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new m(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new m(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new m(Math.random(),Math.random())}}},s.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new m(e(this.width),e(this.height))}},{})),_=m.extend({initialize:function(t,e,i,n){this._width=t,this._height=e,this._owner=i,this._setter=n},_set:function(t,e,i){return this._width=t,this._height=e,i||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),v=s.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,e,n,r){var a,o=arguments,h=typeof t;if("number"===h?(this._set(t,e,n,r),a=4):"undefined"===h||null===t?(this._set(0,0,0,0),a=null===t?1:0):1===o.length&&(Array.isArray(t)?(this._set.apply(this,t),a=1):t.x!==i||t.width!==i?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),a=1):t.from===i&&t.to===i&&(this._set(0,0,0,0),s.readSupported(o,this)&&(a=1))),a===i){var l,u,c=p.readNamed(o,"from"),d=s.peek(o),f=c.x,g=c.y;if(d&&d.x!==i||s.hasNamed(o,"to")){var _=p.readNamed(o,"to");l=_.x-f,u=_.y-g,l<0&&(f=_.x,l=-l),u<0&&(g=_.y,u=-u)}else{var v=m.read(o);l=v.width,u=v.height}this._set(f,g,l,u),a=o.__index}var y=o.__filtered;return y&&(this.__filtered=y),this.__read&&(this.__read=a),this},set:"#initialize",_set:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},clone:function(){return new v(this.x,this.y,this.width,this.height)},equals:function(t){var e=s.isPlainValue(t)?v.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?p:g)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?m:_)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=m.read(arguments),e=this._sx,i=this._sy,n=t.width,r=t.height;e&&(this.x+=(this.width-n)*e),i&&(this.y+=(this.height-r)*i),this.width=n,this.height=r,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=(t-this.x)*2*this._sx),this.width=(t-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=(t-this.y)*2*this._sy),this.height=(t-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?p:g)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=p.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==i||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(v.read(arguments)):this._containsPoint(p.read(arguments))},_containsPoint:function(t){var e=t.x,i=t.y;return e>=this.x&&i>=this.y&&e<=this.x+this.width&&i<=this.y+this.height},_containsRectangle:function(t){var e=t.x,i=t.y;return e>=this.x&&i>=this.y&&e+t.width<=this.x+this.width&&i+t.height<=this.y+this.height},intersects:function(){var t=v.read(arguments),e=s.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=v.read(arguments),e=Math.max(this.x,t.x),i=Math.max(this.y,t.y);return new v(e,i,Math.min(this.x+this.width,t.x+t.width)-e,Math.min(this.y+this.height,t.y+t.height)-i)},unite:function(){var t=v.read(arguments),e=Math.min(this.x,t.x),i=Math.min(this.y,t.y);return new v(e,i,Math.max(this.x+this.width,t.x+t.width)-e,Math.max(this.y+this.height,t.y+t.height)-i)},include:function(){var t=p.read(arguments),e=Math.min(this.x,t.x),i=Math.min(this.y,t.y);return new v(e,i,Math.max(this.x+this.width,t.x)-e,Math.max(this.y+this.height,t.y)-i)},expand:function(){var t=m.read(arguments),e=t.width,i=t.height;return new v(this.x-e/2,this.y-i/2,this.width+e,this.height+i)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===i?t:e)-this.height)}},s.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,e){var i=t.join(""),n=/^[RL]/.test(i);e>=4&&(t[1]+=n?"Y":"X");var r=t[n?0:1],s=t[n?1:0],a="get"+r,o="get"+s,h="set"+r,l="set"+s,u="get"+i,c="set"+i;this[u]=function(t){return new(t?p:g)(this[a](),this[o](),this,c)},this[c]=function(){var t=p.read(arguments);this[h](t.x),this[l](t.y)}},{beans:!0})),y=v.extend({initialize:function(t,e,i,n,r,s){this._set(t,e,i,n,!0),this._owner=r,this._setter=s},_set:function(t,e,i,n,r){return this._x=t,this._y=e,this._width=i,this._height=n,r||this._owner[this._setter](this),this}},new function(){var t=v.prototype;return s.each(["x","y","width","height"],function(t){var e=s.capitalize(t),i="_"+t;this["get"+e]=function(){return this[i]},this["set"+e]=function(t){this[i]=t,this._dontNotify||this._owner[this._setter](this)}},s.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var i="set"+e;this[i]=function(){this._dontNotify=!0,t[i].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),b=s.extend({_class:"Matrix",initialize:function t(e,i){var n=arguments,r=n.length,s=!0;if(r>=6?this._set.apply(this,n):1===r||2===r?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,i):Array.isArray(e)?this._set.apply(this,i?e.concat([i]):e):s=!1:r?s=!1:this.reset(),!s)throw Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,i,n,r,s,a){return this._a=t,this._b=e,this._c=i,this._d=n,this._tx=r,this._ty=s,a||this._changed(),this},_serialize:function(t,e){return s.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new b(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=c.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var i=this._owner;return!!i&&(i.transform(null,s.pick(t,!0),e),this.isIdentity())},translate:function(){var t=p.read(arguments),e=t.x,i=t.y;return this._tx+=e*this._a+i*this._c,this._ty+=e*this._b+i*this._d,this._changed(),this},scale:function(){var t=arguments,e=p.read(t),i=p.read(t,0,{readNull:!0});return i&&this.translate(i),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,i&&this.translate(i.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=p.read(arguments,1),i=e.x,n=e.y,r=Math.cos(t),s=Math.sin(t),a=i-i*r+n*s,o=n-i*s-n*r,h=this._a,l=this._b,u=this._c,c=this._d;return this._a=r*h+s*u,this._b=r*l+s*c,this._c=-s*h+r*u,this._d=-s*l+r*c,this._tx+=a*h+o*u,this._ty+=a*l+o*c,this._changed(),this},shear:function(){var t=arguments,e=p.read(t),i=p.read(t,0,{readNull:!0});i&&this.translate(i);var n=this._a,r=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*n,this._d+=e.x*r,i&&this.translate(i.negate()),this._changed(),this},skew:function(){var t=arguments,e=p.read(t),i=p.read(t,0,{readNull:!0}),n=Math.PI/180,r=new p(Math.tan(e.x*n),Math.tan(e.y*n));return this.shear(r,i)},append:function(t,e){if(t){var i=this._a,n=this._b,r=this._c,s=this._d,a=t._a,o=t._c,h=t._b,l=t._d,u=t._tx,c=t._ty;this._a=a*i+h*r,this._c=o*i+l*r,this._b=a*n+h*s,this._d=o*n+l*s,this._tx+=u*i+c*r,this._ty+=u*n+c*s,e||this._changed()}return this},prepend:function(t,e){if(t){var i=this._a,n=this._b,r=this._c,s=this._d,a=this._tx,o=this._ty,h=t._a,l=t._c,u=t._b,c=t._d,d=t._tx,f=t._ty;this._a=h*i+l*n,this._c=h*r+l*s,this._b=u*i+c*n,this._d=u*r+c*s,this._tx=h*a+l*o+d,this._ty=u*a+c*o+f,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,i=this._c,n=this._d,r=this._tx,s=this._ty,a=t*n-e*i,o=null;return a&&!isNaN(a)&&isFinite(r)&&isFinite(s)&&(this._a=n/a,this._b=-e/a,this._c=-i/a,this._d=t/a,this._tx=(i*s-n*r)/a,this._ty=(e*r-t*s)/a,o=this),o},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new b(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,i){return arguments.length<3?this._transformPoint(p.read(arguments)):this._transformCoordinates(t,e,i)},_transformPoint:function(t,e,i){var n=t.x,r=t.y;return e||(e=new p),e._set(n*this._a+r*this._c+this._tx,n*this._b+r*this._d+this._ty,i)},_transformCoordinates:function(t,e,i){for(var n=0,r=2*i;n<r;n+=2){var s=t[n],a=t[n+1];e[n]=s*this._a+a*this._c+this._tx,e[n+1]=s*this._b+a*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,i=t.y,n=e+t.width,r=i+t.height,s=[e,i,n,i,n,r,e,r];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,i){for(var n=this._transformCorners(t),r=n.slice(0,2),s=r.slice(),a=2;a<8;a++){var o=n[a],h=1&a;o<r[h]?r[h]=o:o>s[h]&&(s[h]=o)}return e||(e=new v),e._set(r[0],r[1],s[0]-r[0],s[1]-r[1],i)},inverseTransform:function(){return this._inverseTransform(p.read(arguments))},_inverseTransform:function(t,e,i){var n=this._a,r=this._b,s=this._c,a=this._d,o=this._tx,h=this._ty,l=n*a-r*s,u=null;if(l&&!isNaN(l)&&isFinite(o)&&isFinite(h)){var c=t.x-this._tx,d=t.y-this._ty;e||(e=new p),u=e._set((c*a-d*s)/l,(d*n-c*r)/l,i)}return u},decompose:function(){var t,e,i,n=this._a,r=this._b,s=this._c,a=this._d,o=n*a-r*s,h=Math.sqrt,l=Math.atan2,u=180/Math.PI;if(0!==n||0!==r){var c=h(n*n+r*r);t=Math.acos(n/c)*(r>0?1:-1),e=[c,o/c],i=[l(n*s+r*a,c*c),0]}else if(0!==s||0!==a){var d=h(s*s+a*a);t=Math.asin(s/d)*(a>0?1:-1),e=[o/d,d],i=[0,l(n*s+r*a,d*d)]}else t=0,i=e=[0,0];return{translation:this.getTranslation(),rotation:t*u,scaling:new p(e),skewing:new p(i[0]*u,i[1]*u)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new p(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},s.each(["a","b","c","d","tx","ty"],function(t){var e=s.capitalize(t),i="_"+t;this["get"+e]=function(){return this[i]},this["set"+e]=function(t){this[i]=t,this._changed()}},{})),x=s.extend({_class:"Line",initialize:function(t,e,i,n,r){var s=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=i,this._vy=n,s=r):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,s=i),s||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new p(this._px,this._py)},getVector:function(){return new p(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return x.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return x.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return x.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return p.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return p.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,i,n,r,s,a,o,h,l){h||(i-=t,n-=e,a-=r,o-=s);var u=i*o-n*a;if(!d.isMachineZero(u)){var c=t-r,f=e-s,g=(a*f-o*c)/u,m=(i*f-n*c)/u;if(l||-.000000000001<g&&g<1.000000000001&&-.000000000001<m&&m<1.000000000001)return l||(g=g<=0?0:g>=1?1:g),new p(t+g*i,e+g*n)}},getSide:function(t,e,i,n,r,s,a,o){a||(i-=t,n-=e);var h=r-t,l=h*n-(s-e)*i;return!o&&d.isMachineZero(l)&&(l=(h*i+h*i)/(i*i+n*n))>=0&&l<=1&&(l=0),l<0?-1:l>0?1:0},getSignedDistance:function(t,e,i,n,r,s,a){return a||(i-=t,n-=e),0===i?n>0?r-t:t-r:0===n?i<0?s-e:e-s:((r-t)*n-(s-e)*i)/(n>i?n*Math.sqrt(1+i*i/(n*n)):i*Math.sqrt(1+n*n/(i*i)))},getDistance:function(t,e,i,n,r,s,a){return Math.abs(x.getSignedDistance(t,e,i,n,r,s,a))}}}),w=h.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){h.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Z(null,null,this),this._view=W.create(this,t||tr.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return s.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var i=this._view;i&&(i._needsUpdate=!0,!i._requested&&i._autoUpdate&&i.requestUpdate())}var n=this._changes;if(n&&e){var r=this._changesById,s=e._id,a=r[s];a?a.flags|=t:n.push(r[s]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new S({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:T,match:function(i){var n=i._definition,r=n._id;return e[r]||(e[r]=!0,t.push(n)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var i in t){var n=t[i],r=n._selection;1&r&&n.isInserted()?e.push(n):r||this._updateSelection(n)}return e},_updateSelection:function(t){var e=t._id,i=this._selectionItems;t._selection?i[e]!==t&&(this._selectionCount++,i[e]=t):i[e]===t&&(this._selectionCount--,delete i[e])},selectAll:function(){for(var t=this._children,e=0,i=t.length;e<i;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(i,t)},insertLayer:function(t,e){if(e instanceof S){e._remove(!1,!0),s.splice(this._children,[e],t,0),e._setProject(this,!0);var i=e._name;i&&e.setName(i),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,n){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(i,new S(k.NO_INSERT),!0)).insertChild(t,e),n&&e.activate&&e.activate(),e},getItems:function(t){return k._getItems(this,t)},getItem:function(t){return k._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return s.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var i=e[t];if(i){for(var n in i){var r=i[n];for(var s in e){var a=e[s];a&&a!=i&&delete a[r._id]}r.remove()}e[t]=null}}},draw:function(t,e,i){this._updateVersion++,t.save(),e.applyToContext(t);for(var n=this._children,r=new s({offset:new p(0,0),pixelRatio:i,viewMatrix:e.isIdentity()?null:e,matrices:[new b],updateMatrix:!0}),a=0,o=n.length;a<o;a++)n[a].draw(t,r);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var h=this._selectionItems,l=this._scope.settings.handleSize,u=this._updateVersion;for(var c in h)h[c]._drawSelection(t,e,l,h,u);t.restore()}}}),k=s.extend(a,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=s.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new b,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return s.each(t,function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var n=t&&s.isPlainObject(t),r=n&&!0===t.internal,a=this._matrix=new b,o=n&&t.project||th.project,h=th.settings;return this._id=r?null:f.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&h.applyMatrix,e&&a.translate(e),a._owner=this,this._style=new Z(o._currentStyle,this,o),r||n&&!1==t.insert||!h.insertItems&&!(n&&!0==t.insert)?this._setProject(o):(n&&t.parent||o)._insertItem(i,this,!0),n&&t!==k.NO_INSERT&&t!==k.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(t,e){var i={},n=this;function r(r){for(var a in r){var o=n[a];s.equals(o,"leading"===a?1.2*r.fontSize:r[a])||(i[a]=s.serialize(o,t,"data"!==a,e))}}return r(this._serializeFields),this instanceof C||r(this._style._defaults),[this._class,i]},_changed:function(t){var e=this._symbol,n=this._parent||e,r=this._project;8&t&&(this._bounds=this._position=this._decomposed=i),16&t&&(this._globalMatrix=i),n&&72&t&&k._clearBoundsCache(n),2&t&&k._clearBoundsCache(this),r&&r._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var n=e._children,r=e._namedChildren;(r[t]=r[t]||[]).push(this),t in n||(n[t]=this)}this._name=t||i,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},s.each(["locked","visible","blendMode","opacity","guide"],function(t){var e=s.capitalize(t),i="_"+t,n={locked:256,visible:265};this["get"+e]=function(){return this[i]},this["set"+e]=function(e){e!=this[i]&&(this[i]=e,this._changed(n[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var i=this._selection;this.setSelection(e?i|t:i&~t)},isSelected:function(){if(this._selectChildren){for(var t=this._children,e=0,i=t.length;e<i;e++)if(t[e].isSelected())return!0}return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,i=0,n=e.length;i<n;i++)e[i].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var i=0,n=t.length;i<n;i++)if(!t[i].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var i=0,n=e.length;i<n;i++)e[i].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?p:g,i=this._position||(this._position=this._getPositionFromBounds());return new e(i.x,i.y,this,"setPosition")},setPosition:function(){this.translate(p.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new g(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=p.read(arguments,0,{clone:!0,readNull:!0}),this._position=i}},s.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,e){this[e]=function(e){return this.getBounds(e,t)}},{beans:!0,getBounds:function(t,e){var i=e||t instanceof b,n=s.set({},i?e:t,this._boundsOptions);(!n.stroke||this.getStrokeScaling())&&(n.cacheItem=this);var r=this._getCachedBounds(i&&t,n).rect;return arguments.length?r:new y(r.x,r.y,r.width,r.height,this,"setBounds")},setBounds:function(){var t=v.read(arguments),e=this.getBounds(),i=this._matrix,n=new b,r=t.getCenter();n.translate(r),(t.width!=e.width||t.height!=e.height)&&(i.isInvertible()||(i.set(i._backup||new b().translate(i.getTranslation())),e=this.getBounds()),n.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),r=e.getCenter(),n.translate(-r.x,-r.y),this.transform(n)},_getBounds:function(t,e){var i=this._children;return i&&i.length?(k._updateBoundsCache(this,e.cacheItem),k._getBounds(i,t,e)):new v},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,i){t=t&&t._orNullIfIdentity();var n=e.internal&&!i,r=e.cacheItem,s=n?null:this._matrix._orNullIfIdentity(),a=r&&(!t||t.equals(s))&&this._getBoundsCacheKey(e,n),o=this._bounds;if(k._updateBoundsCache(this._parent||this._symbol,r),a&&o&&a in o){var h=o[a];return{rect:h.rect.clone(),nonscaling:h.nonscaling}}var l=this._getBounds(t||s,e),u=l.rect||l,c=this._style,d=l.nonscaling||c.hasStroke()&&!c.getStrokeScaling();if(a){o||(this._bounds=o={});var h=o[a]={rect:u.clone(),nonscaling:d,internal:n}}return{rect:u,nonscaling:d}},_getStrokeMatrix:function(t,e){var i=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,n=i?i.getViewMatrix().invert():t;return n&&n._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var i=e._id,n=t._boundsCache=t._boundsCache||{ids:{},list:[]};n.ids[i]||(n.list.push(e),n.ids[i]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=i;for(var n=0,r=e.list,s=r.length;n<s;n++){var a=r[n];a!==t&&(a._bounds=a._position=i,a._boundsCache&&k._clearBoundsCache(a))}}},_getBounds:function(t,e,i){var n=1/0,r=-1/0,s=1/0,a=r,o=!1;i=i||{};for(var h=0,l=t.length;h<l;h++){var u=t[h];if(u._visible&&!u.isEmpty(!0)){var c=u._getCachedBounds(e&&e.appended(u._matrix),i,!0),d=c.rect;n=Math.min(d.x,n),s=Math.min(d.y,s),r=Math.max(d.x+d.width,r),a=Math.max(d.y+d.height,a),c.nonscaling&&(o=!0)}}return{rect:isFinite(n)?new v(n,s,r-n,a-s):new v,nonscaling:o}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var i=this._decomposed;this.rotate(t-e),i&&(i.rotation=t,this._decomposed=i)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new g(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var i=this.getRotation(),n=this._decomposed,r=new b,s=d.isZero;if(s(t.x)||s(t.y))r.translate(n.translation),i&&r.rotate(i),r.scale(e.x,e.y),this._matrix.set(r);else{var a=this.getPosition(!0);r.translate(a),i&&r.rotate(i),r.scale(e.x/t.x,e.y/t.y),i&&r.rotate(-i),r.translate(a.negate()),this.transform(r)}n&&(n.scaling=e,this._decomposed=n)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var i=this._parent,n=[];i;){if(!i._globalMatrix){e=null;for(var r=0,s=n.length;r<s;r++)n[r]._globalMatrix=null;break}n.push(i),i=i._parent}if(!e){e=this._globalMatrix=this._matrix.clone();var i=this._parent;i&&e.prepend(i.getGlobalMatrix(!0))}return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var i=this._children,n=0,r=i&&i.length;n<r;n++)i[n]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var i=this._children,n=0,r=i&&i.length;n<r;n++)i[n]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof S)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return s.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(k.NO_INSERT),n=this._children,r=s.pick(t?t.insert:i,t===i||!0===t),a=s.pick(t?t.deep:i,!0);n&&e.copyAttributes(this),(!n||a)&&e.copyContent(this),n||e.copyAttributes(this),r&&e.insertAbove(this);var o=this._name,h=this._parent;if(o&&h){for(var n=h._children,l=o,u=1;n[o];)o=l+" "+u++;o!==l&&e.setName(o)}return e},copyContent:function(t){for(var e=t._children,i=0,n=e&&e.length;i<n;i++)this.addChild(e[i].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var i=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],n=0,r=i.length;n<r;n++){var a=i[n];t.hasOwnProperty(a)&&(this[a]=t[a])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,h=t._name;this._data=o?s.clone(o):null,h&&this.setName(h)},rasterize:function(t,e){s.isPlainObject(t)?(n=t.resolution,r=t.insert,a=t.raster):(n=t,r=e),a||(a=new E(k.NO_INSERT));var n,r,a,o=this.getStrokeBounds(),h=(n||this.getView().getResolution())/72,l=o.getTopLeft().floor(),u=new m(o.getBottomRight().ceil().subtract(l)),c=u.multiply(h);if(a.setSize(c,!0),!c.isZero()){var d=a.getContext(!0),f=new b().scale(h).translate(l.negate());d.save(),f.applyToContext(d),this.draw(d,new s({matrices:[f]})),d.restore()}return a._matrix.set(new b().translate(l.add(u.divide(2))).scale(1/h)),(r===i||r)&&a.insertAbove(this),a},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(p.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var i=e.length-1;i>=0;i--)if(e[i].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return v.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new z.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof k&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(p.read(t),P.getOptions(t))}function e(){var t=arguments,e=p.read(t),i=P.getOptions(t),n=[];return this._hitTest(e,new s({all:n},i)),n}function i(t,e,i,n){var r=this._children;if(r)for(var s=r.length-1;s>=0;s--){var a=r[s],o=a!==n&&a._hitTest(t,e,i);if(o&&!e.all)return o}return null}return w.inject({hitTest:t,hitTestAll:e,_hitTest:i}),{hitTest:t,hitTestAll:e,_hitTestChildren:i}},{_hitTest:function(t,e,i){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var n=this._matrix,r=i?i.appended(n):this.getGlobalMatrix().prepend(this.getView()._matrix),a=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new m(z._getStrokePadding(a,n._shiftless().invert()));if(!(t=n._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var h,l,u=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==s.hyphenate(this._class)||e.class&&!(this instanceof e.class)),c=e.match,d=this;function f(t){return t&&c&&!c(t)&&(t=null),t&&e.all&&e.all.push(t),t}function p(e,i){var n=i?h["get"+i]():d.getPosition();if(t.subtract(n).divide(o).length<=1)return new P(e,d,{name:i?s.hyphenate(i):e,point:n})}var g=e.position,_=e.center,v=e.bounds;if(u&&this._parent&&(g||_||v)){if((_||v)&&(h=this.getInternalBounds()),!(l=g&&p("position")||_&&p("center","Center"))&&v)for(var y=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],b=0;b<8&&!l;b++)l=p("bounds",y[b]);l=f(l)}return l||(l=this._hitTestChildren(t,e,r)||u&&f(this._hitTestSelf(t,e,r,this.getStrokeScaling()?null:r._shiftless().invert()))||null),l&&l.point&&(l.point=n.transform(l.point)),l},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new P("fill",this)},matches:function(t,e){var i=typeof t;if("object"===i){for(var n in t)if(t.hasOwnProperty(n)&&!this.matches(n,t[n]))return!1;return!0}if("function"===i)return t(this);if("match"===t)return e(this);var r=/^(empty|editable)$/.test(t)?this["is"+s.capitalize(t)]():"type"===t?s.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;r=this._class}if("function"==typeof e)return!!e(r);if(e){if(e.test)return e.test(r);if(s.isPlainObject(e))return function t(e,i){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],a=i[n];if(s.isPlainObject(r)&&s.isPlainObject(a)){if(!t(r,a))return!1}else if(!s.equals(r,a))return!1}return!0}(e,r)}return s.equals(r,e)},getItems:function(t){return k._getItems(this,t,this._matrix)},getItem:function(t){return k._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,i,n,r,a){if(!r){var o="object"==typeof i&&i,h=o&&o.overlapping,l=o&&o.inside,u=h||l,c=u&&v.read([u]);r={items:[],recursive:o&&!1!==o.recursive,inside:!!l,overlapping:!!h,rect:c,path:h&&new z.Rectangle({rectangle:c,insert:!1})},o&&(i=s.filter({},i,{recursive:!0,inside:!0,overlapping:!0}))}var d=e._children,f=r.items,c=r.rect;n=c&&(n||new b);for(var p=0,g=d&&d.length;p<g;p++){var m=d[p],_=n&&n.appended(m._matrix),y=!0;if(c){var u=m.getBounds(_);if(!c.intersects(u))continue;c.contains(u)||r.overlapping&&(u.contains(c)||r.path.intersects(m,_))||(y=!1)}if(y&&m.matches(i)&&(f.push(m),a)||(!1!==r.recursive&&t(m,i,_,r,a),a&&f.length>0))break}return f}}},{importJSON:function(t){var e=s.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(i,t)},insertChild:function(t,e){var i=e?this.insertChildren(t,[e]):null;return i&&i[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var i=this._children;if(i&&e&&e.length>0){e=s.slice(e);for(var n={},r=e.length-1;r>=0;r--){var a=e[r],o=a&&a._id;!a||n[o]?e.splice(r,1):(a._remove(!1,!0),n[o]=!0)}s.splice(i,e,t,0);for(var h=this._project,l=h._changes,r=0,u=e.length;r<u;r++){var a=e[r],c=a._name;a._parent=this,a._setProject(h,!0),c&&a.setName(c),l&&a._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var i=t&&t._getOwner(),n=t!==this&&i?this:null;return n&&(n._remove(!1,!0),i._insertItem(t._index+e,n)),n},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(i,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(i,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var i=e[0].reduce(t);return this._parent?(i.insertAbove(this),this.remove()):i.remove(),i}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,i=t._namedChildren,n=this._name,r=i[n],s=r?r.indexOf(this):-1;-1!==s&&(e[n]==this&&delete e[n],r.splice(s,1),r.length?e[n]=r[0]:delete i[n])}},_remove:function(t,e){var i=this._getOwner(),n=this._project,r=this._index;return this._style&&this._style._dispose(),!!i&&(this._name&&this._removeNamed(),null!=r&&(n._activeLayer===this&&(n._activeLayer=this.getNextSibling()||this.getPreviousSibling()),s.splice(i._children,null,r,1)),this._installEvents(!1),t&&n._changes&&this._changed(5),e&&i._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=s.pick(e,this._children.length);for(var i=s.splice(this._children,null,t,e-t),n=i.length-1;n>=0;n--)i[n]._remove(!0,!1);return i.length>0&&this._changed(11),i},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,i=e?e.length:0;if(t){for(var n=0;n<i;n++)if(!e[n].isEmpty(t))return!1;return!0}return!i},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do e.unshift(t);while(t=t._parent)return e}for(var i=e(this),n=e(t),r=0,s=Math.min(i.length,n.length);r<s;r++)if(i[r]!=n[r])return i[r]._index<n[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return -1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},s.each(["rotate","scale","shear","skew"],function(t){var e="rotate"===t;this[t]=function(){var i=arguments,n=(e?s:p).read(i),r=p.read(i,0,{readNull:!0});return this.transform(new b()[t](n,r||this.getPosition(!0)))}},{translate:function(){var t=new b;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,i){var n=this._matrix,r=t&&!t.isIdentity(),s=i&&this._canApplyMatrix||this._applyMatrix&&(r||!n.isIdentity()||e&&this._children);if(!r&&!s)return this;if(r){!t.isInvertible()&&n.isInvertible()&&(n._backup=n.getValues()),n.prepend(t,!0);var a=this._style,o=a.getFillColor(!0),h=a.getStrokeColor(!0);o&&o.transform(t),h&&h.transform(t)}if(s&&(s=this._transformContent(n,e,i))){var l=this._pivot;l&&n._transformPoint(l,l,!0),n.reset(!0),i&&this._canApplyMatrix&&(this._applyMatrix=!0)}var u=this._bounds,c=this._position;(r||s)&&this._changed(25);var d=r&&u&&t.decompose();if(d&&d.skewing.isZero()&&d.rotation%90==0){for(var f in u){var p=u[f];if(p.nonscaling)delete u[f];else if(s||!p.internal){var g=p.rect;t._transformBounds(g,g)}}this._bounds=u;var m=u[this._getBoundsCacheKey(this._boundsOptions||{})];m&&(this._position=this._getPositionFromBounds(m.rect))}else r&&c&&this._pivot&&(this._position=t._transformPoint(c,c));return this},_transformContent:function(t,e,i){var n=this._children;if(n){for(var r=0,s=n.length;r<s;r++)n[r].transform(t,e,i);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(p.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(p.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(p.read(arguments))},localToParent:function(){return this._matrix._transformPoint(p.read(arguments))},fitBounds:function(t,e){t=v.read(arguments);var i=this.getBounds(),n=i.height/i.width,r=t.height/t.width,s=(e?n>r:n<r)?t.width/i.width:t.height/i.height,a=new v(new p,new m(i.width*s,i.height*s));a.setCenter(t.getCenter()),this.setBounds(a)}}),{_setStyles:function(t,e,i){var n=this._style,r=this._matrix;if(n.hasFill()&&(t.fillStyle=n.getFillColor().toCanvasStyle(t,r)),n.hasStroke()){t.strokeStyle=n.getStrokeColor().toCanvasStyle(t,r),t.lineWidth=n.getStrokeWidth();var s=n.getStrokeJoin(),a=n.getStrokeCap(),o=n.getMiterLimit();if(s&&(t.lineJoin=s),a&&(t.lineCap=a),o&&(t.miterLimit=o),th.support.nativeDash){var h=n.getDashArray(),l=n.getDashOffset();h&&h.length&&("setLineDash"in t?(t.setLineDash(h),t.lineDashOffset=l):(t.mozDash=h,t.mozDashOffset=l))}}if(n.hasShadow()){var u=e.pixelRatio||1,c=i._shiftless().prepend(new b().scale(u,u)),d=c.transform(new p(n.getShadowBlur(),0)),f=c.transform(this.getShadowOffset());t.shadowColor=n.getShadowColor().toCanvasStyle(t),t.shadowBlur=d.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,i){if(this._updateVersion=this._project._updateVersion,this._visible&&0!==this._opacity){var n=e.matrices,r=e.viewMatrix,s=this._matrix,a=n[n.length-1].appended(s);if(a.isInvertible()){r=r?r.appended(a):a,n.push(a),e.updateMatrix&&(this._globalMatrix=a);var o,h,l,u=this._blendMode,c=d.clamp(this._opacity,0,1),f="normal"===u,p=ts.nativeModes[u],g=f&&1===c||e.dontStart||e.clip||(p||f&&c<1)&&this._canComposite(),m=e.pixelRatio||1;if(!g){var _=this.getStrokeBounds(r);if(!_.width||!_.height){n.pop();return}l=e.offset,h=e.offset=_.getTopLeft().floor(),o=t,t=tr.getContext(_.getSize().ceil().add(1).multiply(m)),1!==m&&t.scale(m,m)}t.save();var v=i?i.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,y=!g&&e.clipItem,b=!v||y;if(g?(t.globalAlpha=c,p&&(t.globalCompositeOperation=u)):b&&t.translate(-h.x,-h.y),b&&(g?s:r).applyToContext(t),y&&e.clipItem.draw(t,e.extend({clip:!0})),v){t.setTransform(m,0,0,m,0,0);var x=e.offset;x&&t.translate(-x.x,-x.y)}this._draw(t,e,r,v),t.restore(),n.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),g||(ts.process(u,t,o,c,h.subtract(l).multiply(m)),tr.release(t),e.offset=l)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof D)return e._isUpdated(t);var i=this._updateVersion===t;return!i&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,i=!0),i},_drawSelection:function(t,e,i,n,r){var s=this._selection,a=1&s,o=2&s||a&&this._selectBounds,h=4&s;if(this._drawSelected||(a=!1),(a||o||h)&&this._isUpdated(r)){var l,u=this.getSelectedColor(!0)||(l=this.getLayer())&&l.getSelectedColor(!0),c=e.appended(this.getGlobalMatrix(!0)),d=i/2;if(t.strokeStyle=t.fillStyle=u?u.toCanvasStyle(t):"#009dec",a&&this._drawSelected(t,c,n),h){var f=this.getPosition(!0),p=this._parent,g=p?p.localToGlobal(f):f,m=g.x,_=g.y;t.beginPath(),t.arc(m,_,d,0,2*Math.PI,!0),t.stroke();for(var v=[[0,-1],[1,0],[0,1],[-1,0]],y=i+1,b=0;b<4;b++){var x=v[b],w=x[0],k=x[1];t.moveTo(m+w*d,_+k*d),t.lineTo(m+w*y,_+k*y),t.stroke()}}if(o){var C=c._transformCorners(this.getInternalBounds());t.beginPath();for(var b=0;b<8;b++)t[b?"lineTo":"moveTo"](C[b],C[++b]);t.closePath(),t.stroke();for(var b=0;b<8;b++)t.fillRect(C[b]-d,C[++b]-d,i,i)}}},_canComposite:function(){return!1}},s.each(["down","drag","up","move"],function(t){this["removeOn"+s.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(t){for(var e in t)if(t[e]){var i="mouse"+e,n=this._project,r=n._removeSets=n._removeSets||{};r[i]=r[i]||{},r[i][this._id]=this}return this}}),{tween:function(t,e,i){i||(i=e,e=t,t=null,i||(i=e,e=null));var n=i&&i.easing,r=i&&i.start,s=null!=i&&("number"==typeof i?i:i.duration),a=new ti(this,t,e,s,n,r);return s&&this.on("frame",function t(e){a._handleFrame(1e3*e.time),a.running||this.off("frame",t)}),a},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),C=k.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(e){t.base.call(this,e),2050&e&&(this._clipItem=i)},_getClipItem:function(){var t=this._clipItem;if(t===i){t=null;for(var e=this._children,n=0,r=e.length;n<r;n++)if(e[n]._clipMask){t=e[n];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,i){var n=this._getClipItem();return n?n._getCachedBounds(n._matrix.prepended(e),s.set({},i,{stroke:!1})):t.base.call(this,e,i)},_hitTestChildren:function t(e,i,n){var r=this._getClipItem();return(!r||r.contains(e))&&t.base.call(this,e,i,n,r)},_draw:function(t,e){var i=e.clip,n=!i&&this._getClipItem();e=e.extend({clipItem:n,clip:!1}),i?(t.beginPath(),e.dontStart=e.dontFinish=!0):n&&n.draw(t,e.extend({clip:!0}));for(var r=this._children,s=0,a=r.length;s<a;s++){var o=r[s];o!==n&&o.draw(t,e)}}}),S=C.extend({_class:"Layer",initialize:function(){C.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),I=k.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&s.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new _(t.width,t.height,this,"setSize")},setSize:function(){var t=m.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,i=t.width,n=t.height;"rectangle"===e?this._radius.set(m.min(this._radius,t.divide(2).abs())):"circle"===e?(i=n=(i+n)/2,this._radius=i/2):"ellipse"===e&&this._radius._set(i/2,n/2),this._size._set(i,n),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new _(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var i=2*t;this._radius=t,this._size._set(i,i)}else if(t=m.read(arguments),this._radius){if(this._radius.equals(t))return;if(this._radius.set(t),"rectangle"===e){var i=m.max(this._size,t.multiply(2));this._size.set(i)}else"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new z[s.capitalize(this._type)]({center:new p,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),th.settings.applyMatrix&&e.setApplyMatrix(!0),(t===i||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,i,n){var r=this._style,s=r.hasFill(),a=r.hasStroke(),o=e.dontFinish||e.clip,h=!n;if(s||a||o){var l=this._type,u=this._radius,c="circle"===l;if(e.dontStart||t.beginPath(),h&&c)t.arc(0,0,u,0,2*Math.PI,!0);else{var d=c?u:u.width,f=c?u:u.height,p=this._size,g=p.width,m=p.height;if(h&&"rectangle"===l&&0===d&&0===f)t.rect(-g/2,-m/2,g,m);else{var _=g/2,v=m/2,y=.44771525016920644*d,b=.44771525016920644*f,x=[-_,-v+f,-_,-v+b,-_+y,-v,-_+d,-v,_-d,-v,_-y,-v,_,-v+b,_,-v+f,_,v-f,_,v-b,_-y,v,_-d,v,-_+d,v,-_+y,v,-_,v-b,-_,v-f];n&&n.transform(x,x,32),t.moveTo(x[0],x[1]),t.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7]),_!==d&&t.lineTo(x[8],x[9]),t.bezierCurveTo(x[10],x[11],x[12],x[13],x[14],x[15]),v!==f&&t.lineTo(x[16],x[17]),t.bezierCurveTo(x[18],x[19],x[20],x[21],x[22],x[23]),_!==d&&t.lineTo(x[24],x[25]),t.bezierCurveTo(x[26],x[27],x[28],x[29],x[30],x[31])}}t.closePath()}!o&&(s||a)&&(this._setStyles(t,e,i),s&&(t.fill(r.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),a&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var i=new v(this._size).setCenter(0,0),n=this._style,r=e.stroke&&n.hasStroke()&&n.getStrokeWidth();return t&&(i=t._transformBounds(i)),r?i.expand(z._getStrokePadding(r,this._getStrokeMatrix(t,e))):i}},new function(){function t(t,e,i){var n=t._radius;if(!n.isZero())for(var r=t._size.divide(2),s=1;s<=4;s++){var a=new p(s>1&&s<4?-1:1,s>2?-1:1),o=a.multiply(r),h=o.subtract(a.multiply(n));if(new v(i?o.add(a.multiply(i)):o,h).contains(e))return{point:h,quadrant:s}}}function e(t,e,i,n){var r=t.divide(e);return(!n||r.isInQuadrant(n))&&r.subtract(r.normalize()).multiply(e).divide(i).length<=1}return{_contains:function e(i){if("rectangle"!==this._type)return .5>=i.divide(this.size).getLength();var n=t(this,i);return n?1>=i.subtract(n.point).divide(this._radius).getLength():e.base.call(this,i)},_hitTestSelf:function i(n,r,s,a){var o=!1,h=this._style,l=r.stroke&&h.hasStroke(),u=r.fill&&h.hasFill();if(l||u){var c=this._type,d=this._radius,f=l?h.getStrokeWidth()/2:0,p=r._tolerancePadding.add(z._getStrokePadding(f,!h.getStrokeScaling()&&a));if("rectangle"===c){var g=p.multiply(2),m=t(this,n,g);if(m)o=e(n.subtract(m.point),d,p,m.quadrant);else{var _=new v(this._size).setCenter(0,0),y=_.expand(g),b=_.expand(g.negate());o=y._containsPoint(n)&&!b._containsPoint(n)}}else o=e(n,d,p)}return o?new P(l?"stroke":"fill",this):i.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,i,n,r){var a=s.create(I.prototype);return a._type=t,a._size=i,a._radius=n,a._initialize(s.getNamed(r),e),a}return{Circle:function(){var e=arguments,i=p.readNamed(e,"center"),n=s.readNamed(e,"radius");return t("circle",i,new m(2*n),n,e)},Rectangle:function(){var e=arguments,i=v.readNamed(e,"rectangle"),n=m.min(m.readNamed(e,"radius"),i.getSize(!0).divide(2));return t("rectangle",i.getCenter(!0),i.getSize(!0),n,e)},Ellipse:function(){var e=arguments,i=I._readEllipse(e),n=i.radius;return t("ellipse",i.center,n.multiply(2),n,e)},_readEllipse:function(t){var e,i;if(s.hasNamed(t,"radius"))e=p.readNamed(t,"center"),i=m.readNamed(t,"radius");else{var n=v.readNamed(t,"rectangle");e=n.getCenter(!0),i=n.getSize(!0).divide(2)}return{center:e,radius:i}}}}}),E=k.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(t,e){if(!this._initialize(t,e!==i&&p.read(arguments))){var n,s=typeof t,a="string"===s?r.getElementById(t):"object"===s?t:null;if(a&&a!==k.NO_INSERT){if(a.getContext||null!=a.naturalHeight)n=a;else if(a){var o=m.read(arguments);o.isZero()||(n=tr.getCanvas(o))}}n?this.setImage(n):this.setSource(t)}this._size||(this._size=new m,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,i=t._canvas;if(e)this._setImage(e);else if(i){var n=tr.getCanvas(t._size);n.getContext("2d").drawImage(i,0,0),this._setImage(n)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new _(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var i=m.read(arguments);if(i.equals(this._size))e&&this.clear();else if(i.width>0&&i.height>0){var n=!e&&this.getElement();this._setImage(tr.getCanvas(i)),n&&this.getContext(!0).drawImage(n,0,0,i.width,i.height)}else this._canvas&&tr.release(this._canvas),this._size=i.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new p(0,0).transform(t),i=new p(1,0).transform(t).subtract(e),n=new p(0,1).transform(t).subtract(e);return new m(72/i.getLength(),72/n.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function i(t){var i=e.getView(),n=t&&t.type||"load";i&&e.responds(n)&&(th=i._scope,e.emit(n,new Y(t)))}this._setImage(t),this._loaded?setTimeout(i,0):t&&G.add(t,{load:function(n){e._setImage(t),i(n)},error:i})},_setImage:function(t){this._canvas&&tr.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new m(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=tr.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){tr.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var i=new e.Image,n=this._crossOrigin;n&&(i.crossOrigin=n),t&&(i.src=t),this.setImage(i)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing="string"==typeof t?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=v.read(arguments),e=tr.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=v.read(arguments),e=new E(k.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var i=this.getCanvas();return i?i.toDataURL.apply(i,arguments):null},drawImage:function(t){var e=p.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){if(t?t instanceof R?(i=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new v(t):"x"in t&&(e=new v(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var e,i,n=Math.min(e.width,32),r=Math.min(e.height,32),a=E._sampleContext;a?a.clearRect(0,0,33,33):a=E._sampleContext=tr.getContext(new m(32)),a.save();var o=new b().scale(n/e.width,r/e.height).translate(-e.x,-e.y);o.applyToContext(a),i&&i.draw(a,new s({clip:!0,matrices:[o]})),this._matrix.applyToContext(a);var h=this.getElement(),l=this._size;h&&a.drawImage(h,-l.width/2,-l.height/2),a.restore();for(var u=a.getImageData(.5,.5,Math.ceil(n),Math.ceil(r)).data,c=[0,0,0],d=0,f=0,p=u.length;f<p;f+=4){var g=u[f+3];d+=g,g/=255,c[0]+=u[f]*g,c[1]+=u[f+1]*g,c[2]+=u[f+2]*g}for(var f=0;f<3;f++)c[f]/=d;return d?U.read(c):null},getPixel:function(){var t=p.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new U("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=p.read(t),i=U.read(t),n=i._convert("rgb"),r=i._alpha,s=this.getContext(!0),a=s.createImageData(1,1),o=a.data;o[0]=255*n[0],o[1]=255*n[1],o[2]=255*n[2],o[3]=null!=r?255*r:255,s.putImageData(a,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=m.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=v.read(arguments);return t.isEmpty()&&(t=new v(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var e=p.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,e){var i=new v(this._size).setCenter(0,0);return t?t._transformBounds(i):i},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new P("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,i){var n=this.getElement();if(n&&n.width>0&&n.height>0){t.globalAlpha=d.clamp(this._opacity,0,1),this._setStyles(t,e,i);var r=this._smoothing,s="off"===r;H.setPrefixed(t,s?"imageSmoothingEnabled":"imageSmoothingQuality",!s&&r),t.drawImage(n,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),T=k.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,e){this._initialize(t,e!==i&&p.read(arguments,1))||this.setDefinition(t instanceof A?t:new A(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var i=this._definition._item;return i._getCachedBounds(i._matrix.prepended(t),e)},_hitTestSelf:function(t,e,i){var n=e.extend({all:!1}),r=this._definition._item._hitTest(t,n,i);return r&&(r.item=this),r},_draw:function(t,e){this._definition._item.draw(t,e)}}),A=s.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=f.get(),this.project=th.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,function(){return s.serialize([this._class,this._item],t,!1,e)})},_changed:function(t){8&t&&k._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new p),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new T(this,t)},clone:function(){return new A(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),P=s.extend({_class:"HitResult",initialize:function(t,e,i){this.type=t,this.item=e,i&&this.inject(i)},statics:{getOptions:function(t){var e=t&&s.read(t);return new s({type:null,tolerance:th.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),M=s.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,e,n,r,s,a){var o,h,l,u,c=arguments.length;c>0&&(null==t||"object"==typeof t?1===c&&t&&"point"in t?(o=t.point,h=t.handleIn,l=t.handleOut,u=t.selection):(o=t,h=e,l=n,u=r):(o=[t,e],h=n!==i?[n,r]:null,l=s!==i?[s,a]:null)),new O(o,this,"_point"),new O(h,this,"_handleIn"),new O(l,this,"_handleOut"),u&&this.setSelection(u)},_serialize:function(t,e){var i=this._point,n=this._selection,r=n||this.hasHandles()?[i,this._handleIn,this._handleOut]:i;return n&&r.push(n),s.serialize(r,t,!0,e)},_changed:function(t){var e=this._path;if(e){var i,n=e._curves,r=this._index;n&&((!t||t===this._point||t===this._handleIn)&&(i=r>0?n[r-1]:e._closed?n[n.length-1]:null)&&i._changed(),(!t||t===this._point||t===this._handleOut)&&(i=n[r])&&i._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(p.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(p.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(p.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,i=this._path;this._selection=t=t||0,i&&t!==e&&(i._updateSelection(this,e,t),i._changed(257))},_changeSelection:function(t,e){var i=this._selection;this.setSelection(e?i|t:i&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==i?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new N(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,n){var r=t||{},s=r.type,a=r.factor,o=this.getPrevious(),h=this.getNext(),l=(o||this)._point,u=this._point,c=(h||this)._point,d=l.getDistance(u),f=u.getDistance(c);if(s&&"catmull-rom"!==s){if("geometric"===s){if(o&&h){var g=l.subtract(c),m=a===i?.4:a,_=m*d/(d+f);e||this.setHandleIn(g.multiply(_)),n||this.setHandleOut(g.multiply(_-m))}}else throw Error("Smoothing method '"+s+"' not supported.")}else{var v=a===i?.5:a,y=Math.pow(d,v),b=y*y,x=Math.pow(f,v),w=x*x;if(!e&&o){var k=2*w+3*x*y+b,C=3*x*(x+y);this.setHandleIn(0!==C?new p((w*l._x+k*u._x-b*c._x)/C-u._x,(w*l._y+k*u._y-b*c._y)/C-u._y):new p)}if(!n&&h){var k=2*b+3*y*x+w,C=3*y*(y+x);this.setHandleOut(0!==C?new p((b*c._x+k*u._x-w*l._x)/C-u._x,(b*c._y+k*u._y-w*l._y)/C-u._y):new p)}}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,i=t.clone();t.set(e),e.set(i)},reversed:function(){return new M(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new M(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,Array(6),!0),this._changed()},interpolate:function(t,e,i){var n=1-i,r=t._point,s=e._point,a=t._handleIn,o=e._handleIn,h=e._handleOut,l=t._handleOut;this._point._set(n*r._x+i*s._x,n*r._y+i*s._y,!0),this._handleIn._set(n*a._x+i*o._x,n*a._y+i*o._y,!0),this._handleOut._set(n*l._x+i*h._x,n*l._y+i*h._y,!0),this._changed()},_transformCoordinates:function(t,e,i){var n=this._point,r=i&&this._handleIn.isZero()?null:this._handleIn,s=i&&this._handleOut.isZero()?null:this._handleOut,a=n._x,o=n._y,h=2;return e[0]=a,e[1]=o,r&&(e[h++]=r._x+a,e[h++]=r._y+o),s&&(e[h++]=s._x+a,e[h++]=s._y+o),t&&(t._transformCoordinates(e,e,h/2),a=e[0],o=e[1],i?(n._x=a,n._y=o,h=2,r&&(r._x=e[h++]-a,r._y=e[h++]-o),s&&(s._x=e[h++]-a,s._y=e[h++]-o)):(r||(e[h++]=a,e[h++]=o),s||(e[h++]=a,e[h++]=o))),e}}),O=p.extend({initialize:function(t,e,n){var r,s,a;if(t){if((r=t[0])!==i)s=t[1];else{var o=t;(r=o.x)===i&&(o=p.read(arguments),r=o.x),s=o.y,a=o.selected}}else r=s=0;this._x=r,this._y=s,this._owner=e,e[n]=this,a&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=d.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),L=s.extend({_class:"Curve",beans:!0,initialize:function(t,e,i,n,r,s,a,o){var h,l,u,c,d,f,p=arguments.length;3===p?(this._path=t,h=e,l=i):p?1===p?"segment1"in t?(h=new M(t.segment1),l=new M(t.segment2)):"point1"in t?(u=t.point1,d=t.handle1,f=t.handle2,c=t.point2):Array.isArray(t)&&(u=[t[0],t[1]],c=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],f=[t[4]-t[6],t[5]-t[7]]):2===p?(h=new M(t),l=new M(e)):4===p?(u=t,d=e,f=i,c=n):8===p&&(u=[t,e],c=[a,o],d=[i-t,n-e],f=[r-a,s-o]):(h=new M,l=new M),this._segment1=h||new M(u,null,d),this._segment2=l||new M(c,f,null)},_serialize:function(t,e){return s.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=i},clone:function(){return new L(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return L.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,i=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(i)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(p.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(p.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(p.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(p.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return L.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],i=0;i<8;i+=2)e.push(new p(t[i],t[i+1]));return e}},{getLength:function(){return null==this._length&&(this._length=L.getLength(this.getValues(),0,1)),this._length},getArea:function(){return L.getArea(this.getValues())},getLine:function(){return new x(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new L(L.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return L.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var i=null;if(t>=1e-8&&t<=.99999999){var n=L.subdivide(this.getValues(),t),r=n[0],s=n[1],a=e||this.hasHandles(),o=this._segment1,h=this._segment2,l=this._path;a&&(o._handleOut._set(r[2]-r[0],r[3]-r[1]),h._handleIn._set(s[4]-s[6],s[5]-s[7]));var u=r[6],c=r[7],d=new M(new p(u,c),a&&new p(r[4]-u,r[5]-c),a&&new p(s[2]-u,s[3]-c));l?(l.insert(o._index+1,d),i=this.getNext()):(this._segment2=d,this._changed(),i=new L(d,h))}return i},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===i?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===i?.5:e?t:this.getTimeAt(t))},reversed:function(){return new L(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,i,n){var r=t._point,s=t._handleOut,a=e._handleIn,o=e._point,h=r.x,l=r.y,u=o.x,c=o.y,d=n?[h,l,h,l,u,c,u,c]:[h,l,h+s._x,l+s._y,u+a._x,c+a._y,u,c];return i&&i._transformCoordinates(d,d,4),d},subdivide:function(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],o=t[4],h=t[5],l=t[6],u=t[7];e===i&&(e=.5);var c=1-e,d=c*n+e*s,f=c*r+e*a,p=c*s+e*o,g=c*a+e*h,m=c*o+e*l,_=c*h+e*u,v=c*d+e*p,y=c*f+e*g,b=c*p+e*m,x=c*g+e*_,w=c*v+e*b,k=c*y+e*x;return[[n,r,d,f,v,y,w,k],[w,k,b,x,m,_,l,u]]},getMonoCurves:function(t,e){var i=[],n=e?0:1,r=t[n+0],s=t[n+2],a=t[n+4],o=t[n+6];if(r>=s==s>=a&&s>=a==a>=o||L.isStraight(t))i.push(t);else{var h=[],l=d.solveQuadratic(3*(s-a)-r+o,2*(r+a)-4*s,s-r,h,1e-8,.99999999);if(l){h.sort();var u=h[0],c=L.subdivide(t,u);i.push(c[0]),l>1&&(u=(h[1]-u)/(1-u),c=L.subdivide(c[1],u),i.push(c[0])),i.push(c[1])}else i.push(t)}return i},solveCubic:function(t,e,i,n,r,s){var a=t[e],o=t[e+2],h=t[e+4],l=t[e+6],u=0;if(!(a<i&&l<i&&o<i&&h<i||a>i&&l>i&&o>i&&h>i)){var c=3*(o-a),f=3*(h-o)-c;u=d.solveCubic(l-a-c-f,f,c,a-i,n,r,s)}return u},getTimeOf:function(t,e){var i=new p(t[0],t[1]),n=new p(t[6],t[7]);if(null===(e.isClose(i,1e-12)?0:e.isClose(n,1e-12)?1:null))for(var r=[e.x,e.y],s=[],a=0;a<2;a++)for(var o=L.solveCubic(t,a,r[a],s,0,1),h=0;h<o;h++){var l=s[h];if(e.isClose(L.getPoint(t,l),1e-7))return l}return e.isClose(i,1e-7)?0:e.isClose(n,1e-7)?1:null},getNearestTime:function(t,e){if(L.isStraight(t)){var i=t[0],n=t[1],r=t[6],s=t[7],a=r-i,o=s-n,h=a*a+o*o;if(0===h)return 0;var l=((e.x-i)*a+(e.y-n)*o)/h;return l<1e-12?0:l>.999999999999?1:L.getTimeOf(t,new p(i+l*a,n+l*o))}var u=1/0,c=0;function d(i){if(i>=0&&i<=1){var n=e.getDistance(L.getPoint(t,i),!0);if(n<u)return u=n,c=i,!0}}for(var f=0;f<=100;f++)d(f/100);for(var g=.005;g>1e-8;)d(c-g)||d(c+g)||(g/=2);return c},getPart:function(t,e,i){var n=e>i;if(n){var r=e;e=i,i=r}return e>0&&(t=L.subdivide(t,e)[1]),i<1&&(t=L.subdivide(t,(i-e)/(1-e))[0]),n?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],h=t[6],l=t[7],u=3*r-2*i-h,c=3*s-2*n-l,d=3*a-2*h-i,f=3*o-2*l-n;return Math.max(u*u,d*d)+Math.max(c*c,f*f)<=16*e*e},getArea:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7];return 3*((h-i)*(n+s)-(o-e)*(r+a)+r*(e-s)-n*(i-a)+h*(s+e/3)-o*(a+i/3))/20},getBounds:function(t){for(var e=t.slice(0,2),i=e.slice(),n=[0,0],r=0;r<2;r++)L._addBounds(t[r],t[r+2],t[r+4],t[r+6],r,0,e,i,n);return new v(e[0],e[1],i[0]-e[0],i[1]-e[1])},_addBounds:function(t,e,i,n,r,s,a,o,h){function l(t,e){var i=t-e,n=t+e;i<a[r]&&(a[r]=i),n>o[r]&&(o[r]=n)}s/=2;var u=a[r]+s,c=o[r]-s;if(t<u||e<u||i<u||n<u||t>c||e>c||i>c||n>c){if(e<t!=e<n&&i<t!=i<n)l(t,0),l(n,0);else{var f=d.solveQuadratic(3*(e-i)-t+n,2*(t+i)-4*e,e-t,h);l(n,0);for(var p=0;p<f;p++){var g=h[p],m=1-g;1e-8<=g&&g<=.99999999&&l(m*m*m*t+3*m*m*g*e+3*m*g*g*i+g*g*g*n,s)}}}}}},s.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=z[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}},{}),s.each({isStraight:function(t,e,i,n){if(e.isZero()&&i.isZero())return!0;var r=n.subtract(t);if(r.isZero());else if(r.isCollinear(e)&&r.isCollinear(i)){var s=new x(t,n);if(1e-7>s.getDistance(t.add(e))&&1e-7>s.getDistance(n.add(i))){var a=r.dot(r),o=r.dot(e)/a,h=r.dot(i)/a;return o>=0&&o<=1&&h<=0&&h>=-1}}return!1},isLinear:function(t,e,i,n){var r=n.subtract(t).divide(3);return e.equals(r)&&i.negate().equals(r)}},function(t,e){this[e]=function(e){var i=this._segment1,n=this._segment2;return t(i._point,i._handleOut,n._handleIn,n._point,e)},this.statics[e]=function(e,i){var n=e[0],r=e[1],s=e[6],a=e[7];return t(new p(n,r),new p(e[2]-n,e[3]-r),new p(e[4]-s,e[5]-a),new p(s,a),i)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&1e-8>Math.abs(this.getTangentAtTime(.5).y)},isVertical:function(){return this.isStraight()&&1e-8>Math.abs(this.getTangentAtTime(.5).x)}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new N(this,t):null},getTimeAt:function(t,e){return L.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=p.read(arguments);return t.isZero()?[]:L.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(p.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return L.getTimeOf(this.getValues(),p.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=p.read(arguments),e=this.getValues(),i=L.getNearestTime(e,t),n=L.getPoint(e,i);return new N(this,i,n,null,t.getDistance(n))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return s.each(t,function(t){this[t+"At"]=function(e,i){var n=this.getValues();return L[t](n,i?e:L.getTimeAt(n,e))},this[t+"AtTime"]=function(e){return L[t](this.getValues(),e)}},{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7],l=9*(n-s)+3*(o-e),u=6*(e+s)-12*n,c=3*(n-e),d=9*(r-a)+3*(h-i),f=6*(i+a)-12*r,p=3*(r-i);return function(t){var e=(l*t+u)*t+c,i=(d*t+f)*t+p;return Math.sqrt(e*e+i*i)}}function e(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function n(t,e,i,n){if(null==e||e<0||e>1)return null;var r=t[0],s=t[1],a=t[2],o=t[3],h=t[4],l=t[5],u=t[6],c=t[7],f=d.isZero;f(a-r)&&f(o-s)&&(a=r,o=s),f(h-u)&&f(l-c)&&(h=u,l=c);var g,m,_=3*(a-r),v=3*(h-a)-_,y=u-r-_-v,b=3*(o-s),x=3*(l-o)-b,w=c-s-b-x;if(0===i)g=0===e?r:1===e?u:((y*e+v)*e+_)*e+r,m=0===e?s:1===e?c:((w*e+x)*e+b)*e+s;else{if(e<1e-8?(g=_,m=b):e>.99999999?(g=3*(u-h),m=3*(c-l)):(g=(3*y*e+2*v)*e+_,m=(3*w*e+2*x)*e+b),n){0===g&&0===m&&(e<1e-8||e>.99999999)&&(g=h-a,m=l-o);var k=Math.sqrt(g*g+m*m);k&&(g/=k,m/=k)}if(3===i){var h=6*y*e+2*v,l=6*w*e+2*x,C=Math.pow(g*g+m*m,1.5);g=0!==C?(g*l-m*h)/C:0,m=0}}return 2===i?new p(m,-g):new p(g,m)}return{statics:{classify:function(t){var e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],h=t[6],l=t[7],u=r*(n-l)+s*(h-e)+e*l-n*h,c=3*(a*(s-n)+o*(e-r)+r*n-s*e),f=c-u,p=f-u+(e*(l-o)+n*(a-h)+h*o-l*a),g=Math.sqrt(p*p+f*f+c*c),m=0!==g?1/g:0,_=d.isZero,v="serpentine";function y(t,e,n){var r=e!==i,s=r&&e>0&&e<1,a=r&&n>0&&n<1;return!r||(s||a)&&("loop"!==t||s&&a)||(t="arch",s=a=!1),{type:t,roots:s||a?s&&a?e<n?[e,n]:[n,e]:[s?e:n]:null}}if(p*=m,f*=m,c*=m,_(p))return _(f)?y(_(c)?"line":"quadratic"):y(v,c/(3*f));var b=3*f*f-4*p*c;if(_(b))return y("cusp",f/(2*p));var x=b>0?Math.sqrt(b/3):Math.sqrt(-b),w=2*p;return y(b>0?v:"loop",(f+x)/w,(f-x)/w)},getLength:function(n,r,s,a){if(r===i&&(r=0),s===i&&(s=1),L.isStraight(n)){var o=n;s<1&&(o=L.subdivide(o,s)[0],r/=s),r>0&&(o=L.subdivide(o,r)[1]);var h=o[6]-o[0],l=o[7]-o[1];return Math.sqrt(h*h+l*l)}return d.integrate(a||t(n),r,s,e(r,s))},getTimeAt:function(n,r,s){if(s===i&&(s=r<0?1:0),0===r)return s;var a=Math.abs,o=r>0,h=o?s:0,l=o?1:s,u=t(n),c=L.getLength(n,h,l,u),f=a(r)-c;if(1e-12>a(f))return o?l:h;if(f>1e-12)return null;var p=r/c,g=0;return d.findRoot(function(t){return g+=d.integrate(u,s,t,e(s,t)),s=t,g-r},u,s+p,h,l,32,1e-12)},getPoint:function(t,e){return n(t,e,0,!1)},getTangent:function(t,e){return n(t,e,1,!0)},getWeightedTangent:function(t,e){return n(t,e,1,!1)},getNormal:function(t,e){return n(t,e,2,!0)},getWeightedNormal:function(t,e){return n(t,e,2,!1)},getCurvature:function(t,e){return n(t,e,3,!1).x},getPeaks:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7],l=-e+3*n-3*s+o,u=3*e-6*n+3*s,c=-3*e+3*n,f=-i+3*r-3*a+h,p=3*i-6*r+3*a,g=-3*i+3*r,m=[];return d.solveCubic(9*(l*l+f*f),9*(l*u+p*f),2*(u*u+p*p)+3*(c*l+g*f),c*u+p*g,m,1e-8,.99999999),m.sort()}}}},new function(){function t(t,e,i,n,r,s,a){var o=!a&&i.getPrevious()===r,h=!a&&i!==r&&i.getNext()===r;if(null!==n&&n>=(o?1e-8:0)&&n<=(h?.99999999:1)&&null!==s&&s>=(h?1e-8:0)&&s<=(o?.99999999:1)){var l=new N(i,n,null,a),u=new N(r,s,null,a);l._intersection=u,u._intersection=l,(!e||e(l))&&N.insert(t,l,!0)}}function e(t,e,n,r){return t[0][1]<n?i(t,!0,n):e[0][1]>r?i(e,!1,r):t[0][0]}function i(t,e,i){for(var n=t[0][0],r=t[0][1],s=1,a=t.length;s<a;s++){var o=t[s][0],h=t[s][1];if(e?h>=i:h<=i)return h===i?o:n+(i-r)*(o-n)/(h-r);n=o,r=h}return null}function n(t,e,i,n,r){var s=d.isZero;if(s(n)&&s(r)){var a=L.getTimeOf(t,new p(e,i));return null===a?[]:[a]}for(var o=Math.atan2(-r,n),h=Math.sin(o),l=Math.cos(o),u=[],c=[],f=0;f<8;f+=2){var g=t[f]-e,m=t[f+1]-i;u.push(g*l-m*h,g*h+m*l)}return L.solveCubic(u,1,0,c,0,1),c}function r(i,r,s,o,h,l){var u=Math.min,c=Math.max;if(c(i[0],i[2],i[4],i[6])+1e-12>u(r[0],r[2],r[4],r[6])&&u(i[0],i[2],i[4],i[6])-1e-12<c(r[0],r[2],r[4],r[6])&&c(i[1],i[3],i[5],i[7])+1e-12>u(r[1],r[3],r[5],r[7])&&u(i[1],i[3],i[5],i[7])-1e-12<c(r[1],r[3],r[5],r[7])){var d=a(i,r);if(d)for(var f=0;f<2;f++){var g=d[f];t(h,l,s,g[0],o,g[1],!0)}else{var m=L.isStraight(i),_=L.isStraight(r),v=m&&_,y=m&&!_,b=h.length;if((v?function(e,i,n,r,s,a){var o=x.intersect(e[0],e[1],e[6],e[7],i[0],i[1],i[6],i[7]);o&&t(s,a,n,L.getTimeOf(e,o),r,L.getTimeOf(i,o))}:m||_?function(e,i,r,s,a,o,h){for(var l=i[0],u=i[1],c=n(e,l,u,i[6]-l,i[7]-u),d=0,f=c.length;d<f;d++){var p=c[d],g=L.getPoint(e,p),m=L.getTimeOf(i,g);null!==m&&t(a,o,h?s:r,h?m:p,h?r:s,h?p:m)}}:function i(n,r,s,a,o,h,l,u,c,d,f,p,g){if(++c>=4096||++u>=40)return c;var m,_,v=r[0],y=r[1],b=r[6],w=r[7],k=x.getSignedDistance,C=k(v,y,b,w,r[2],r[3]),S=k(v,y,b,w,r[4],r[5]),I=C*S>0?3/4:4/9,E=I*Math.min(0,C,S),T=I*Math.max(0,C,S),A=k(v,y,b,w,n[0],n[1]),P=k(v,y,b,w,n[2],n[3]),M=k(v,y,b,w,n[4],n[5]),O=k(v,y,b,w,n[6],n[7]),N=function(t,e,i,n){var r,s=[0,t],a=[1/3,e],o=[2/3,i],h=[1,n],l=e-(2*t+n)/3,u=i-(t+2*n)/3;if(l*u<0)r=[[s,a,h],[s,o,h]];else{var c=l/u;r=[c>=2?[s,a,h]:c<=.5?[s,o,h]:[s,a,o,h],[s,h]]}return 0>(l||u)?r.reverse():r}(A,P,M,O),R=N[0],z=N[1];if(0===C&&0===S&&0===A&&0===P&&0===M&&0===O||null==(m=e(R,z,E,T))||null==(_=e(R.reverse(),z.reverse(),E,T)))return c;var D=d+(f-d)*m,B=d+(f-d)*_;if(1e-9>Math.max(g-p,B-D)){var j=(D+B)/2,V=(p+g)/2;t(o,h,l?a:s,l?V:j,l?s:a,l?j:V)}else{n=L.getPart(n,m,_);var F=g-p;if(_-m>.8){if(B-D>F){var U=L.subdivide(n,.5),j=(D+B)/2;c=i(r,U[0],a,s,o,h,!l,u,c,p,g,D,j),c=i(r,U[1],a,s,o,h,!l,u,c,p,g,j,B)}else{var U=L.subdivide(r,.5),V=(p+g)/2;c=i(U[0],n,a,s,o,h,!l,u,c,p,V,D,B),c=i(U[1],n,a,s,o,h,!l,u,c,V,g,D,B)}}else c=0===F||F>=1e-9?i(r,n,a,s,o,h,!l,u,c,p,g,D,B):i(n,r,s,a,o,h,l,u,c,D,B,p,g)}return c})(y?r:i,y?i:r,y?o:s,y?s:o,h,l,y,0,0,0,1,0,1),!v||h.length===b)for(var f=0;f<4;f++){var w=f>>1,k=1&f,C=6*w,S=6*k,I=new p(i[C],i[C+1]),E=new p(r[S],r[S+1]);I.isClose(E,1e-12)&&t(h,l,s,w,o,k)}}}return h}function s(e,i,n,r){var s=L.classify(e);if("loop"===s.type){var a=s.roots;t(n,r,i,a[0],i,a[1])}return n}function a(t,e){function i(t){var e=t[6]-t[0],i=t[7]-t[1];return e*e+i*i}var n=Math.abs,r=x.getDistance,s=L.isStraight(t),a=L.isStraight(e),o=s&&a,h=i(t)<i(e),l=h?e:t,u=h?t:e,c=l[0],d=l[1],f=l[6]-c,g=l[7]-d;if(1e-7>r(c,d,f,g,u[0],u[1],!0)&&1e-7>r(c,d,f,g,u[6],u[7],!0))!o&&1e-7>r(c,d,f,g,l[2],l[3],!0)&&1e-7>r(c,d,f,g,l[4],l[5],!0)&&1e-7>r(c,d,f,g,u[2],u[3],!0)&&1e-7>r(c,d,f,g,u[4],u[5],!0)&&(s=a=o=!0);else if(o)return null;if(s^a)return null;for(var m=[t,e],_=[],v=0;v<4&&_.length<2;v++){var y=1&v,b=1^y,w=v>>1,k=L.getTimeOf(m[y],new p(m[b][w?6:0],m[b][w?7:1]));if(null!=k){var C=y?[w,k]:[k,w];(!_.length||n(C[0]-_[0][0])>1e-8&&n(C[1]-_[0][1])>1e-8)&&_.push(C)}if(v>2&&!_.length)break}if(2!==_.length)_=null;else if(!o){var S=L.getPart(t,_[0][0],_[1][0]),I=L.getPart(e,_[0][1],_[1][1]);(n(I[2]-S[2])>1e-7||n(I[3]-S[3])>1e-7||n(I[4]-S[4])>1e-7||n(I[5]-S[5])>1e-7)&&(_=null)}return _}return{getIntersections:function(t){var e=this.getValues(),i=t&&t!==this&&t.getValues();return i?r(e,i,this,t,[]):s(e,this,[])},statics:{getOverlaps:a,getIntersections:function(t,e,i,n,a,o){var h=!e;h&&(e=t);for(var u=t.length,c=e.length,d=Array(u),f=h?d:Array(c),p=[],g=0;g<u;g++)d[g]=t[g].getValues(n);if(!h)for(var g=0;g<c;g++)f[g]=e[g].getValues(a);for(var m=l.findCurveBoundsCollisions(d,f,1e-7),_=0;_<u;_++){var v=t[_],y=d[_];h&&s(y,v,p,i);var b=m[_];if(b)for(var x=0;x<b.length;x++){if(o&&p.length)return p;var w=b[x];if(!h||w>_){var k=e[w];r(y,f[w],v,k,p,i)}}}return p},getCurveLineIntersections:n,getTimesWithTangent:function(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],h=t[6],l=t[7],u=e.normalize(),c=u.x,f=u.y,p=3*h-9*a+9*r-3*i,g=3*l-9*o+9*s-3*n,m=6*a-12*r+6*i,_=6*o-12*s+6*n,v=3*r-3*i,y=3*s-3*n,b=2*p*f-2*g*c,x=[];if(Math.abs(b)<d.CURVETIME_EPSILON){var b=p*_-g*m;if(0!=b){var w=-(p*y-g*v)/b;w>=0&&w<=1&&x.push(w)}}else{var k=(m*m-4*p*v)*f*f+(-2*m*_+4*g*v+4*p*y)*c*f+(_*_-4*g*y)*c*c,C=m*f-_*c;if(k>=0&&0!=b){var S=Math.sqrt(k),I=-(C+S)/b,E=(-C+S)/b;I>=0&&I<=1&&x.push(I),E>=0&&E<=1&&x.push(E)}}return x}}}}),N=s.extend({_class:"CurveLocation",initialize:function(t,e,i,n,r){if(e>=.99999999){var s=t.getNext();s&&(e=0,t=s)}this._setCurve(t),this._time=e,this._point=i||t.getPointAtTime(e),this._overlap=n,this._distance=r,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),i=this.getTime();0===i?t=e._segment1:1===i?t=e._segment2:null!=i&&(t=e.getPartLength(0,i)<e.getPartLength(i,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function i(t){var i=t&&t.getCurve();if(i&&null!=(e._time=i.getTimeOf(e._point)))return e._setCurve(i),i}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||i(this._segment)||i(this._segment1)||i(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),i=this.getIndex();if(e&&null!=i)for(var n=e.getCurves(),r=0;r<i;r++)t+=n[r].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),i=this.getTime();this._curveOffset=t=null!=i&&e&&e.getPartLength(0,i)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,i=t&&t.splitAtTime(this.getTime());return i&&this._setSegment(e.getLastSegment()),i},equals:function(t,e){var i=this===t;if(!i&&t instanceof N){var n=this.getCurve(),r=t.getCurve(),s=n._path;if(s===r._path){var a=Math.abs,o=a(this.getOffset()-t.getOffset()),h=!e&&this._intersection,l=!e&&t._intersection;i=(o<1e-7||s&&1e-7>a(s.getLength()-o))&&(!h&&!l||h&&l&&h.equals(l,!0))}}return i},toString:function(){var t=[],e=this.getPoint(),i=c.instance;e&&t.push("point: "+e);var n=this.getIndex();null!=n&&t.push("index: "+n);var r=this.getTime();return null!=r&&t.push("time: "+i.number(r)),null!=this._distance&&t.push("distance: "+i.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),i=t.getCurve();return!(e.isStraight()&&i.isStraight()&&e.getLine().intersect(i.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),i=t.getTime(),n=e>=1e-8&&e<=.99999999,r=i>=1e-8&&i<=.99999999;if(n&&r)return!this.isTouching();var s=this.getCurve(),a=s&&e<1e-8?s.getPrevious():s,o=t.getCurve(),h=o&&i<1e-8?o.getPrevious():o;if(e>.99999999&&(s=s.getNext()),i>.99999999&&(o=o.getNext()),!a||!s||!h||!o)return!1;var l=[];function u(t,e){var i=t.getValues(),n=L.classify(i).roots||L.getPeaks(i),r=n.length,s=L.getLength(i,e&&r?n[r-1]:0,!e&&r?n[0]:1);l.push(r?s:s/32)}function c(t,e,i){return e<i?t>e&&t<i:t>e||t<i}n||(u(a,!0),u(s,!1)),r||(u(h,!0),u(o,!1));var d=this.getPoint(),f=Math.min.apply(Math,l),p=n?s.getTangentAtTime(e):s.getPointAt(f).subtract(d),g=n?p.negate():a.getPointAt(-f).subtract(d),m=r?o.getTangentAtTime(i):o.getPointAt(f).subtract(d),_=r?m.negate():h.getPointAt(-f).subtract(d),v=g.getAngle(),y=p.getAngle(),b=_.getAngle(),x=m.getAngle();return!!(n?c(v,b,x)^c(y,b,x)&&c(v,x,b)^c(y,x,b):c(b,v,y)^c(x,v,y)&&c(b,y,v)^c(x,y,v))},hasOverlap:function(){return!!this._overlap}},s.each(L._evaluateMethods,function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),i=this.getTime();return null!=i&&t&&t[e](i,!0)}},{preserve:!0}),new function(){function t(t,e,i){var n=t.length,r=0,s=n-1;function a(i,r){for(var s=i+r;s>=-1&&s<=n;s+=r){var a=t[(s%n+n)%n];if(!e.getPoint().isClose(a.getPoint(),1e-7))break;if(e.equals(a))return a}return null}for(;r<=s;){var o,h=r+s>>>1,l=t[h];if(i&&(o=e.equals(l)?l:a(h,-1)||a(h,1)))return e._overlap&&(o._overlap=o._intersection._overlap=!0),o;var u=e.getPath(),c=l.getPath();(u!==c?u._id-c._id:e.getIndex()+e.getTime()-(l.getIndex()+l.getTime()))<0?s=h-1:r=h+1}return t.splice(r,0,e),e}return{statics:{insert:t,expand:function(e){for(var i=e.slice(),n=e.length-1;n>=0;n--)t(i,e[n]._intersection,!1);return i}}}}),R=k.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){if(s.isPlainObject(t)?(i=t.segments,e=t.pathData):Array.isArray(t)?i=t:"string"==typeof t&&(e=t),i){var e,i,n,r=i[0];n=r&&Array.isArray(r[0])}else e&&(n=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(n?D:z)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,i,n,r=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),s=!1,a=new p,o=new p;function h(t,i){var n=+e[t];return s&&(n+=a[i]),n}function l(t){return new p(h(t,"x"),h(t+1,"y"))}this.clear();for(var u=0,c=r&&r.length;u<c;u++){var d=r[u],f=d[0],g=f.toLowerCase(),_=(e=d.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(s=f===g,"z"!==i||/[mz]/.test(g)||this.moveTo(a),g){case"m":case"l":for(var v="m"===g,y=0;y<_;y+=2)this[v?"moveTo":"lineTo"](a=l(y)),v&&(o=a,v=!1);n=a;break;case"h":case"v":var b="h"===g?"x":"y";a=a.clone();for(var y=0;y<_;y++)a[b]=h(y,b),this.lineTo(a);n=a;break;case"c":for(var y=0;y<_;y+=6)this.cubicCurveTo(l(y),n=l(y+2),a=l(y+4));break;case"s":for(var y=0;y<_;y+=4)this.cubicCurveTo(/[cs]/.test(i)?a.multiply(2).subtract(n):a,n=l(y),a=l(y+2)),i=g;break;case"q":for(var y=0;y<_;y+=4)this.quadraticCurveTo(n=l(y),a=l(y+2));break;case"t":for(var y=0;y<_;y+=2)this.quadraticCurveTo(n=/[qt]/.test(i)?a.multiply(2).subtract(n):a,a=l(y)),i=g;break;case"a":for(var y=0;y<_;y+=7)this.arcTo(a=l(y+5),new m(+e[y],+e[y+1]),+e[y+2],+e[y+4],+e[y+3]);break;case"z":this.closePath(1e-12),a=o}i=g}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,i,n){var r=this===t||!t,s=this._matrix._orNullIfIdentity(),a=r?s:(i||t._matrix)._orNullIfIdentity();return r||this.getBounds(s).intersects(t.getBounds(a),1e-12)?L.getIntersections(this.getCurves(),!r&&t.getCurves(),e,s,a,n):[]},getCrossings:function(t){return this.getIntersections(t,function(t){return t.isCrossing()})},getNearestLocation:function(){for(var t=p.read(arguments),e=this.getCurves(),i=1/0,n=null,r=0,s=e.length;r<s;r++){var a=e[r].getNearestLocation(t);a._distance<i&&(i=a._distance,n=a)}return n},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,i){var n=!this._children,r=n?"_segments":"_children",s=t[r],a=e[r],o=this[r];if(!s||!a||s.length!==a.length)throw Error("Invalid operands in interpolate() call: "+t+", "+e);var h=o.length,l=a.length;if(h<l)for(var u=n?M:z,c=h;c<l;c++)this.add(new u);else h>l&&this[n?"removeSegments":"removeChildren"](l,h);for(var c=0;c<l;c++)o[c].interpolate(s[c],a[c],i);n&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var i=this._children||[this],n=t._children?t._children.slice():[t],r=i.length,s=n.length,a=[],o=0;e=!0;for(var h=l.findItemBoundsCollisions(i,n,d.GEOMETRIC_EPSILON),u=r-1;u>=0&&e;u--){var c=i[u];e=!1;var f=h[u];if(f)for(var p=f.length-1;p>=0&&!e;p--)c.compare(n[f[p]])&&(!a[f[p]]&&(a[f[p]]=!0,o++),e=!0)}e=e&&o===s}return e}}),z=R.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var e=arguments,n=Array.isArray(t)?"object"==typeof t[0]?t:e:t&&t.size===i&&(t.x!==i||t.point!==i)?e:null;n&&n.length>0?this.setSegments(n):(this._curves=i,this._segmentSelection=0,n||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!n&&t)},_equals:function(t){return this._closed===t._closed&&s.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),8&e){if(this._length=this._area=i,32&e)this._version++;else if(this._curves)for(var n=0,r=this._curves.length;n<r;n++)this._curves[n]._changed()}else 64&e&&(this._bounds=i)},getStyle:function(){var t=this._parent;return(t instanceof D?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),n=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=i,n){var r=t[n-1];"boolean"==typeof r&&(this.setClosed(r),n--),this._add(M.readList(t,0,{},n))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var i=this._countCurves();t=this._curves=Array(i);for(var n=0;n<i;n++)t[n]=new L(this,e[n],e[n+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new L(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var i,n,r,s,a,o,h,l,u=this._segments,d=u.length,f=new c(e),p=Array(6),g=!0,m=[];function _(e,u){if(e._transformCoordinates(t,p),i=p[0],n=p[1],g)m.push("M"+f.pair(i,n)),g=!1;else if(a=p[2],o=p[3],a===i&&o===n&&h===r&&l===s){if(!u){var c=i-r,d=n-s;m.push(0===c?"v"+f.number(d):0===d?"h"+f.number(c):"l"+f.pair(c,d))}}else m.push("c"+f.pair(h-r,l-s)+" "+f.pair(a-r,o-s)+" "+f.pair(i-r,n-s));r=i,s=n,h=p[4],l=p[5]}if(!d)return"";for(var v=0;v<d;v++)_(u[v]);return this._closed&&d>0&&(_(u[0],!0),m.push("z")),m.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,i=Array(6),n=0,r=e.length;n<r;n++)e[n]._transformCoordinates(t,i,!0);return!0},_add:function(t,e){for(var i=this._segments,n=this._curves,r=t.length,a=null==e,e=a?i.length:e,o=0;o<r;o++){var h=t[o];h._path&&(h=t[o]=h.clone()),h._path=this,h._index=e+o,h._selection&&this._updateSelection(h,0,h._selection)}if(a)s.push(i,t);else{i.splice.apply(i,[e,0].concat(t));for(var o=e+r,l=i.length;o<l;o++)i[o]._index=o}if(n){var u=this._countCurves(),c=e>0&&e+r-1===u?e-1:e,d=c,f=Math.min(c+r,u);t._curves&&(n.splice.apply(n,[c,0].concat(t._curves)),d+=t._curves.length);for(var o=d;o<f;o++)n.splice(o,0,new L(this,null,null));this._adjustCurves(c,f)}return this._changed(41),t},_adjustCurves:function(t,e){for(var i,n=this._segments,r=this._curves,s=t;s<e;s++)(i=r[s])._path=this,i._segment1=n[s],i._segment2=n[s+1]||n[0],i._changed();(i=r[this._closed&&!t?n.length-1:t-1])&&(i._segment2=n[t]||n[0],i._changed()),(i=r[e])&&(i._segment1=n[e],i._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(M.readList(e)):this._add([M.read(e)])[0]},insert:function(t,e){var i=arguments;return i.length>2&&"number"!=typeof e?this._add(M.readList(i,1),t):this._add([M.read(i,1)],t)[0]},addSegment:function(){return this._add([M.read(arguments)])[0]},insertSegment:function(t){return this._add([M.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(M.readList(t))},insertSegments:function(t,e){return this._add(M.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,i){t=t||0,e=s.pick(e,this._segments.length);var n=this._segments,r=this._curves,a=n.length,o=n.splice(t,e-t),h=o.length;if(!h)return o;for(var l=0;l<h;l++){var u=o[l];u._selection&&this._updateSelection(u,u._selection,0),u._index=u._path=null}for(var l=t,c=n.length;l<c;l++)n[l]._index=l;if(r){for(var d=t>0&&e===a+(this._closed?1:0)?t-1:t,r=r.splice(d,h),l=r.length-1;l>=0;l--)r[l]._path=null;i&&(o._curves=r.slice(1)),this._adjustCurves(d,d)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,i=t.length;e<i;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,i=t.length;e<i;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,i=0,n=t.length;i<n;i++)e+=t[i].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,i=this._closed;t=0;for(var n=0,r=e.length;n<r;n++){var s=n+1===r;t+=L.getArea(L.getValues(e[n],e[s?0:n+1],null,s&&!i))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,i=e.length,n=t?7:0;this._segmentSelection=n*i;for(var r=0;r<i;r++)e[r]._selection=n},_updateSelection:function(t,e,i){t._selection=i,(this._segmentSelection+=i-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,i=this.getLocationAt(t);return i&&(e=i.getCurve().divideAt(i.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),i=e&&e.index,n=e&&e.time;n>.99999999&&(i++,n=0);var r=this.getCurves();if(i>=0&&i<r.length){n>=1e-8&&r[i++].divideAtTime(n);var s,a=this.removeSegments(i,this._segments.length,!0);return this._closed?(this.setClosed(!1),s=this):((s=new z(k.NO_INSERT)).insertAbove(this),s.copyAttributes(this)),s._add(a,0),this.addSegment(a[0]),s}return null},split:function(t,e){var n,r=e===i?t:(n=this.getCurves()[t])&&n.getLocationAtTime(e);return null!=r?this.splitAt(r):null},join:function(t,e){var i=e||0;if(t&&t!==this){var n=t._segments,r=this.getLastSegment(),s=t.getLastSegment();if(!s)return this;r&&r._point.isClose(s._point,i)&&t.reverse();var a=t.getFirstSegment();if(r&&r._point.isClose(a._point,i))r.setHandleOut(a._handleOut),this._add(n.slice(1));else{var o=this.getFirstSegment();o&&o._point.isClose(a._point,i)&&t.reverse(),s=t.getLastSegment(),o&&o._point.isClose(s._point,i)?(o.setHandleIn(s._handleIn),this._add(n.slice(0,n.length-1),0)):this._add(n.slice())}t._closed&&this._add([n[0]]),t.remove()}var h=this.getFirstSegment(),l=this.getLastSegment();return h!==l&&h._point.isClose(l._point,i)&&(h.setHandleIn(l._handleIn),l.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),i=t&&t.simplify,n=i?1e-7:0,r=e.length-1;r>=0;r--){var s=e[r];!s.hasHandles()&&(!s.hasLength(n)||i&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var i=this._segments[t],n=i._handleIn;i._handleIn=i._handleOut,i._handleOut=n,i._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new B(this,t||.25,256,!0).parts,i=e.length,n=[],r=0;r<i;r++)n.push(new M(e[r].curve.slice(0,2)));!this._closed&&i>0&&n.push(new M(e[i-1].curve.slice(6))),this.setSegments(n)},simplify:function(t){var e=new j(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,n=t||{},r=n.type||"asymmetric",s=this._segments,a=s.length,o=this._closed;function h(t,i){var n=t&&t.index;if(null!=n){var r=t.path;if(r&&r!==e)throw Error(t._class+" "+n+" of "+r+" is not part of "+e);i&&t instanceof L&&n++}else n="number"==typeof t?t:i;return Math.min(n<0&&o?n%a:n<0?n+a:n,a-1)}var l=o&&n.from===i&&n.to===i,u=h(n.from,0),c=h(n.to,a-1);if(u>c){if(o)u-=a;else{var d=u;u=c,c=d}}if(/^(?:asymmetric|continuous)$/.test(r)){var f="asymmetric"===r,p=Math.min,g=c-u+1,m=g-1,_=l?p(g,4):1,v=_,y=_,b=[];if(o||(v=p(1,u),y=p(1,a-c-1)),(m+=v+y)<=1)return;for(var x=0,w=u-v;x<=m;x++,w++)b[x]=s[(w<0?w+a:w)%a]._point;for(var k=b[0]._x+2*b[1]._x,C=b[0]._y+2*b[1]._y,S=2,I=m-1,E=[k],T=[C],A=[2],P=[],M=[],x=1;x<m;x++){var O=x<I,N=O?1:f?1:2,R=O?4:f?2:7,z=O?4:f?3:8,D=O?2:f?0:1,B=N/S;S=A[x]=R-B,k=E[x]=z*b[x]._x+D*b[x+1]._x-B*k,C=T[x]=z*b[x]._y+D*b[x+1]._y-B*C}P[I]=E[I]/A[I],M[I]=T[I]/A[I];for(var x=m-2;x>=0;x--)P[x]=(E[x]-P[x+1])/A[x],M[x]=(T[x]-M[x+1])/A[x];P[m]=(3*b[m]._x-P[I])/2,M[m]=(3*b[m]._y-M[I])/2;for(var x=v,j=m-y,w=u;x<=j;x++,w++){var V=s[w<0?w+a:w],F=V._point,U=P[x]-F._x,q=M[x]-F._y;(l||x<j)&&V.setHandleOut(U,q),(l||x>v)&&V.setHandleIn(-U,-q)}}else for(var x=u;x<=c;x++)s[x<0?x+a:x].smooth(n,!l&&x===u,!l&&x===c)},toShape:function(t){if(!this._closed)return null;var e,n,r,s,a,o,h,l=this._segments;function u(t,e){var i=l[t],n=i.getNext(),r=l[e],s=r.getNext();return i._handleOut.isZero()&&n._handleIn.isZero()&&r._handleOut.isZero()&&s._handleIn.isZero()&&n._point.subtract(i._point).isCollinear(s._point.subtract(r._point))}function c(t){var e=l[t],i=e.getNext(),n=e._handleOut,r=i._handleIn;if(n.isOrthogonal(r)){var s=e._point,a=i._point,o=new x(s,n,!0).intersect(new x(a,r,!0),!0);return o&&d.isZero(n.getLength()/o.subtract(s).getLength()-.5522847498307936)&&d.isZero(r.getLength()/o.subtract(a).getLength()-.5522847498307936)}return!1}function f(t,e){return l[t]._point.getDistance(l[e]._point)}if(!this.hasHandles()&&4===l.length&&u(0,2)&&u(1,3)&&(n=(e=l[1]).getPrevious(),r=e.getNext(),n._handleOut.isZero()&&e._handleIn.isZero()&&e._handleOut.isZero()&&r._handleIn.isZero()&&e._point.subtract(n._point).isOrthogonal(r._point.subtract(e._point)))?(s=I.Rectangle,a=new m(f(0,3),f(0,1)),h=l[1]._point.add(l[2]._point).divide(2)):8===l.length&&c(0)&&c(2)&&c(4)&&c(6)&&u(1,5)&&u(3,7)?(s=I.Rectangle,o=(a=new m(f(1,6),f(0,3))).subtract(new m(f(0,7),f(1,2))).divide(2),h=l[3]._point.add(l[4]._point).divide(2)):4===l.length&&c(0)&&c(1)&&c(2)&&c(3)&&(d.isZero(f(0,2)-f(1,3))?(s=I.Circle,o=f(0,2)/2):(s=I.Ellipse,o=new m(f(2,0)/2,f(3,1)/2)),h=l[1]._point),s){var p=this.getPosition(!0),g=new s({center:p,size:a,radius:o,insert:!1});return g.copyAttributes(this,!0),g._matrix.prepend(this._matrix),g.rotate(h.subtract(p).getAngle()+90),(t===i||t)&&g.insertAbove(this),g}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof D)return t.base.call(this,e);var i=this.getCurves(),n=e.getCurves(),r=i.length,s=n.length;if(!r||!s)return r==s;for(var a,o,h=i[0].getValues(),l=[],u=0,c=0,d=0;d<s;d++){var f=n[d].getValues();l.push(f);var p=L.getOverlaps(h,f);if(p){a=!d&&p[0][0]>0?s-1:d,o=p[0][1];break}}for(var g,m=Math.abs,f=l[a];h&&f;){var p=L.getOverlaps(h,f);if(p&&1e-8>m(p[0][0]-c)){1===(c=p[1][0])&&(h=++u<r?i[u].getValues():null,c=0);var _=p[0][1];if(1e-8>m(_-o)){if(g||(g=[a,_]),1===(o=p[1][1])&&(++a>=s&&(a=0),f=l[a]||n[a].getValues(),o=0),!h)return g[0]===a&&g[1]===o;continue}}break}return!1},_hitTestSelf:function(t,e,i,n){var r,s,a,o,h,l,u=this,c=this.getStyle(),d=this._segments,f=d.length,p=this._closed,g=e._tolerancePadding,m=g,_=e.stroke&&c.hasStroke(),v=e.fill&&c.hasFill(),y=e.curves,b=_?c.getStrokeWidth()/2:v&&e.tolerance>0||y?0:null;function x(e,i){return t.subtract(e).divide(i).length<=1}function w(t,i,n){if(!e.selected||i.isSelected()){var r=t._point;if(i!==r&&(i=i.add(r)),x(i,m))return new P(n,u,{segment:t,point:i})}}function k(t,i){return(i||e.segments)&&w(t,t._point,"segment")||!i&&e.handles&&(w(t,t._handleIn,"handle-in")||w(t,t._handleOut,"handle-out"))}function C(t){o.add(t)}function S(e){var i,h=p||e._index>0&&e._index<f-1;return(h?r:s)==="round"?x(e._point,m):(o=new z({internal:!0,closed:!0}),h?e.isSmooth()||z._addBevelJoin(e,r,b,a,null,n,C,!0):"square"===s&&z._addSquareCap(e,s,b,null,n,C,!0),o.isEmpty())?void 0:o.contains(t)||(i=o.getNearestLocation(t))&&x(i.getPoint(),g)}if(null!==b&&(b>0?(r=c.getStrokeJoin(),s=c.getStrokeCap(),a=c.getMiterLimit(),m=m.add(z._getStrokePadding(b,n))):r=s="round"),!e.ends||e.segments||p){if(e.segments||e.handles){for(var I=0;I<f;I++)if(l=k(d[I]))return l}}else if(l=k(d[0],!0)||k(d[f-1],!0))return l;if(null!==b){if(h=this.getNearestLocation(t)){var E=h.getTime();0===E||1===E&&f>1?S(h.getSegment())||(h=null):x(h.getPoint(),m)||(h=null)}if(!h&&"miter"===r&&f>1)for(var I=0;I<f;I++){var T=d[I];if(t.getDistance(T._point)<=a*b&&S(T)){h=T.getLocation();break}}}return!h&&v&&this._contains(t)||h&&!_&&!y?new P("fill",this):h?new P(_?"stroke":"curve",this,{location:h,point:h.getPoint()}):null}},s.each(L._evaluateMethods,function(t){this[t+"At"]=function(e){var i=this.getLocationAt(e);return i&&i[t]()}},{beans:!1,getLocationOf:function(){for(var t=p.read(arguments),e=this.getCurves(),i=0,n=e.length;i<n;i++){var r=e[i].getLocationOf(t);if(r)return r}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),i=0,n=0,r=e.length;n<r;n++){var s=i,a=e[n];if((i+=a.getLength())>t)return a.getLocationAt(t-s)}if(e.length>0&&t<=this.getLength())return new N(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=p.read(arguments);if(t.isZero())return[];for(var e=[],i=0,n=this.getCurves(),r=0,s=n.length;r<s;r++){for(var a=n[r],o=a.getTimesWithTangent(t),h=0,l=o.length;h<l;h++){var u=i+a.getOffsetAtTime(o[h]);0>e.indexOf(u)&&e.push(u)}i+=a.length}return e}}),new function(){function t(t,e,i){var n,r,s,a,o,h,l,u,c=e._segments,d=c.length,f=Array(6),p=!0;function g(e){if(i)e._transformCoordinates(i,f),n=f[0],r=f[1];else{var c=e._point;n=c._x,r=c._y}if(p)t.moveTo(n,r),p=!1;else{if(i)o=f[2],h=f[3];else{var d=e._handleIn;o=n+d._x,h=r+d._y}o===n&&h===r&&l===s&&u===a?t.lineTo(n,r):t.bezierCurveTo(l,u,o,h,n,r)}if(s=n,a=r,i)l=f[4],u=f[5];else{var d=e._handleOut;l=s+d._x,u=a+d._y}}for(var m=0;m<d;m++)g(c[m]);e._closed&&d>0&&g(c[0])}return{_draw:function(e,i,n,r){var s=i.dontStart,a=i.dontFinish||i.clip,o=this.getStyle(),h=o.hasFill(),l=o.hasStroke(),u=o.getDashArray(),c=!th.support.nativeDash&&l&&u&&u.length;function d(t){return u[(t%c+c)%c]}if(s||e.beginPath(),(h||l&&!c||a)&&(t(e,this,r),this._closed&&e.closePath()),!a&&(h||l)&&(this._setStyles(e,i,n),h&&(e.fill(o.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),l)){if(c){s||e.beginPath();for(var f,p=new B(this,.25,32,!1,r),g=p.length,m=-o.getDashOffset(),_=0;m>0;)m-=d(_--)+d(_--);for(;m<g;)f=m+d(_++),(m>0||f>0)&&p.drawPart(e,Math.max(m,0),Math.max(f,0)),m=f+d(_++)}e.stroke()}},_drawSelected:function(e,i){e.beginPath(),t(e,this,i),e.stroke(),function(t,e,i,n){if(!(n<=0))for(var r,s,a=n/2,o=n-2,h=a-1,l=Array(6),u=0,c=e.length;u<c;u++){var d=e[u],f=d._selection;if(d._transformCoordinates(i,l),r=l[0],s=l[1],2&f&&g(2),4&f&&g(4),t.fillRect(r-a,s-a,n,n),o>0&&!(1&f)){var p=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(r-h,s-h,o,o),t.fillStyle=p}}function g(e){var i=l[e],n=l[e+1];(r!=i||s!=n)&&(t.beginPath(),t.moveTo(r,s),t.lineTo(i,n),t.stroke(),t.beginPath(),t.arc(i,n,a,0,2*Math.PI,!0),t.fill())}}(e,this._segments,i,th.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new M(p.read(arguments))])},moveBy:function(){throw Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new M(p.read(arguments))])},cubicCurveTo:function(){var e=arguments,i=p.read(e),n=p.read(e),r=p.read(e),s=t(this);s.setHandleOut(i.subtract(s._point)),this._add([new M(r,n.subtract(r))])},quadraticCurveTo:function(){var e=arguments,i=p.read(e),n=p.read(e),r=t(this)._point;this.cubicCurveTo(i.add(r.subtract(i).multiply(1/3)),i.add(n.subtract(i).multiply(1/3)),n)},curveTo:function(){var e=arguments,i=p.read(e),n=p.read(e),r=s.pick(s.read(e),.5),a=1-r,o=t(this)._point,h=i.subtract(o.multiply(a*a)).subtract(n.multiply(r*r)).divide(2*r*a);if(h.isNaN())throw Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(h,n)},arcTo:function(){var e,i,n,r,a,o=arguments,h=Math.abs,l=Math.sqrt,u=t(this),c=u._point,f=p.read(o),g=s.peek(o),_=s.pick(g,!0);if("boolean"==typeof _)var v=c.add(f).divide(2),e=v.add(v.subtract(c).rotate(_?-90:90));else if(2>=s.remain(o))e=f,f=p.read(o);else if(!c.equals(f)){var y=m.read(o),w=d.isZero;if(w(y.width)||w(y.height))return this.lineTo(f);var k=s.read(o),_=!!s.read(o),C=!!s.read(o),v=c.add(f).divide(2),S=c.subtract(v).rotate(-k),I=S.x,E=S.y,T=h(y.width),A=h(y.height),P=T*T,O=A*A,L=I*I,N=E*E,R=l(L/P+N/O);if(R>1&&(T*=R,A*=R,P=T*T,O=A*A),1e-12>h(R=(P*O-P*N-O*L)/(P*N+O*L))&&(R=0),R<0)throw Error("Cannot create an arc with the given arguments");i=new p(T*E/A,-A*I/T).multiply((C===_?-1:1)*l(R)).rotate(k).add(v),n=(r=(a=new b().translate(i).rotate(k).scale(T,A))._inverseTransform(c)).getDirectedAngle(a._inverseTransform(f)),!_&&n>0?n-=360:_&&n<0&&(n+=360)}if(e){var z=new x(c.add(e).divide(2),e.subtract(c).rotate(90),!0),D=new x(e.add(f).divide(2),f.subtract(e).rotate(90),!0),B=new x(c,f),j=B.getSide(e);if(!(i=z.intersect(D,!0))){if(!j)return this.lineTo(f);throw Error("Cannot create an arc with the given arguments")}n=(r=c.subtract(i)).getDirectedAngle(f.subtract(i));var V=B.getSide(i,!0);0===V?n=j*h(n):j===V&&(n+=n<0?360:-360)}if(n){for(var F=h(n),U=F>=360?4:Math.ceil((F-1e-5)/90),q=n/U,$=q*Math.PI/360,Z=4/3*Math.sin($)/(1+Math.cos($)),H=[],G=0;G<=U;G++){var S=f,W=null;if(G<U&&(W=r.rotate(90).multiply(Z),a?(S=a._transformPoint(r),W=a._transformPoint(r.add(W)).subtract(S)):S=i.add(r)),G){var K=r.rotate(-90).multiply(Z);a&&(K=a._transformPoint(r.add(K)).subtract(S)),H.push(new M(S,K,W))}else u.setHandleOut(W);r=r.rotate(q)}this._add(H)}},lineBy:function(){var e=p.read(arguments),i=t(this)._point;this.lineTo(i.add(e))},curveBy:function(){var e=arguments,i=p.read(e),n=p.read(e),r=s.read(e),a=t(this)._point;this.curveTo(a.add(i),a.add(n),r)},cubicCurveBy:function(){var e=arguments,i=p.read(e),n=p.read(e),r=p.read(e),s=t(this)._point;this.cubicCurveTo(s.add(i),s.add(n),s.add(r))},quadraticCurveBy:function(){var e=arguments,i=p.read(e),n=p.read(e),r=t(this)._point;this.quadraticCurveTo(r.add(i),r.add(n))},arcBy:function(){var e=arguments,i=t(this)._point,n=i.add(p.read(e)),r=s.pick(s.peek(e),!0);"boolean"==typeof r?this.arcTo(n,r):this.arcTo(n,i.add(p.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){return z[e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds"](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,i,n,r,s){var a=t[0];if(!a)return new v;var o=Array(6),h=a._transformCoordinates(n,Array(6)),l=h.slice(0,2),u=l.slice(),c=[,,];function d(t){t._transformCoordinates(n,o);for(var e=0;e<2;e++)L._addBounds(h[e],h[e+4],o[e+2],o[e],e,s?s[e]:0,l,u,c);var i=h;h=o,o=i}for(var f=1,p=t.length;f<p;f++)d(t[f]);return e&&d(a),new v(l[0],l[1],u[0]-l[0],u[1]-l[1])},getStrokeBounds:function(t,e,i,n,r){var s=i.getStyle(),a=s.hasStroke(),o=s.getStrokeWidth(),h=a&&i._getStrokeMatrix(n,r),l=a&&z._getStrokePadding(o,h),u=z.getBounds(t,e,i,n,r,l);if(!a)return u;var c=o/2,d=s.getStrokeJoin(),f=s.getStrokeCap(),p=s.getMiterLimit(),g=new v(new m(l));function _(t){u=u.include(t)}function y(t){u=u.unite(g.setCenter(t._point.transform(n)))}function b(t,e){"round"===e||t.isSmooth()?y(t):z._addBevelJoin(t,e,c,p,n,h,_)}function x(t,e){"round"===e?y(t):z._addSquareCap(t,e,c,n,h,_)}var w=t.length-(e?0:1);if(w>0){for(var k=1;k<w;k++)b(t[k],d);e?b(t[0],d):(x(t[0],f),x(t[t.length-1],f))}return u},_getStrokePadding:function(t,e){if(!e)return[t,t];var i=new p(t,0).transform(e),n=new p(0,t).transform(e),r=i.getAngleInRadians(),s=i.getLength(),a=n.getLength(),o=Math.sin(r),h=Math.cos(r),l=Math.tan(r),u=Math.atan2(a*l,s),c=Math.atan2(a,l*s);return[Math.abs(s*Math.cos(u)*h+a*Math.sin(u)*o),Math.abs(a*Math.sin(c)*h+s*Math.cos(c)*o)]},_addBevelJoin:function(t,e,i,n,r,s,a,o){var h=t.getCurve(),l=h.getPrevious(),u=h.getPoint1().transform(r),c=l.getNormalAtTime(1).multiply(i).transform(s),d=h.getNormalAtTime(0).multiply(i).transform(s),f=c.getDirectedAngle(d);if((f<0||f>=180)&&(c=c.negate(),d=d.negate()),o&&a(u),a(u.add(c)),"miter"===e){var g=new x(u.add(c),new p(-c.y,c.x),!0).intersect(new x(u.add(d),new p(-d.y,d.x),!0),!0);g&&u.getDistance(g)<=n*i&&a(g)}a(u.add(d))},_addSquareCap:function(t,e,i,n,r,s,a){var o=t._point.transform(n),h=t.getLocation(),l=h.getNormal().multiply(0===h.getTime()?i:-i).transform(r);"square"===e&&(a&&(s(o.subtract(l)),s(o.add(l))),o=o.add(l.rotate(-90))),s(o.add(l)),s(o.subtract(l))},getHandleBounds:function(t,e,i,n,r){var s,a,o=i.getStyle();if(r.stroke&&o.hasStroke()){var h=i._getStrokeMatrix(n,r),l=o.getStrokeWidth()/2,u=l;"miter"===o.getStrokeJoin()&&(u=l*o.getMiterLimit()),"square"===o.getStrokeCap()&&(u=Math.max(u,l*Math.SQRT2)),s=z._getStrokePadding(l,h),a=z._getStrokePadding(u,h)}for(var c=Array(6),d=1/0,f=-1/0,p=1/0,g=f,m=0,_=t.length;m<_;m++){t[m]._transformCoordinates(n,c);for(var y=0;y<6;y+=2){var b=y?s:a,x=b?b[0]:0,w=b?b[1]:0,k=c[y],C=c[y+1],S=k-x,I=k+x,E=C-w,T=C+w;S<d&&(d=S),I>f&&(f=I),E<p&&(p=E),T>g&&(g=T)}}return new v(d,p,f-d,g-p)}}});z.inject({statics:new function(){var t=[new M([-1,0],[0,.5522847498307936],[0,-.5522847498307936]),new M([0,-1],[-.5522847498307936,0],[.5522847498307936,0]),new M([1,0],[0,-.5522847498307936],[0,.5522847498307936]),new M([0,1],[.5522847498307936,0],[-.5522847498307936,0])];function e(t,e,i){var n=s.getNamed(i),r=new z(n&&(!0==n.insert?k.INSERT:!1==n.insert?k.NO_INSERT:null));return r._add(t),r._closed=e,r.set(n,k.INSERT)}function i(i,n,r){for(var s=[,,,,],a=0;a<4;a++){var o=t[a];s[a]=new M(o._point.multiply(n).add(i),o._handleIn.multiply(n),o._handleOut.multiply(n))}return e(s,!0,r)}return{Line:function(){var t=arguments;return e([new M(p.readNamed(t,"from")),new M(p.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments;return i(p.readNamed(t,"center"),new m(s.readNamed(t,"radius")),t)},Rectangle:function(){var t,i=arguments,n=v.readNamed(i,"rectangle"),r=m.readNamed(i,"radius",0,{readNull:!0}),s=n.getBottomLeft(!0),a=n.getTopLeft(!0),o=n.getTopRight(!0),h=n.getBottomRight(!0);if(!r||r.isZero())t=[new M(s),new M(a),new M(o),new M(h)];else{var l=(r=m.min(r,n.getSize(!0).divide(2))).width,u=r.height,c=.5522847498307936*l,d=.5522847498307936*u;t=[new M(s.add(l,0),null,[-c,0]),new M(s.subtract(0,u),[0,d]),new M(a.add(0,u),null,[0,-d]),new M(a.add(l,0),[-c,0],null),new M(o.subtract(l,0),null,[c,0]),new M(o.add(0,u),[0,-d],null),new M(h.subtract(0,u),null,[0,d]),new M(h.subtract(l,0),[c,0])]}return e(t,!0,i)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=I._readEllipse(t);return i(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=p.readNamed(t,"from"),i=p.readNamed(t,"through"),n=p.readNamed(t,"to"),r=s.getNamed(t),a=new z(r&&!1==r.insert&&k.NO_INSERT);return a.moveTo(e),a.arcTo(i,n),a.set(r)},RegularPolygon:function(){for(var t=arguments,i=p.readNamed(t,"center"),n=s.readNamed(t,"sides"),r=s.readNamed(t,"radius"),a=360/n,o=n%3==0,h=new p(0,o?-r:r),l=o?-1:.5,u=Array(n),c=0;c<n;c++)u[c]=new M(i.add(h.rotate((c+l)*a)));return e(u,!0,t)},Star:function(){for(var t=arguments,i=p.readNamed(t,"center"),n=2*s.readNamed(t,"points"),r=s.readNamed(t,"radius1"),a=s.readNamed(t,"radius2"),o=360/n,h=new p(0,-1),l=Array(n),u=0;u<n;u++)l[u]=new M(i.add(h.rotate(o*u).multiply(u%2?a:r)));return e(l,!0,t)}}}});var D=R.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,i){var n=i,r=n[0];r&&"number"==typeof r[0]&&(n=[n]);for(var a=i.length-1;a>=0;a--){var o=n[a];n!==i||o instanceof z||(n=s.slice(n)),Array.isArray(o)?n[a]=new z({segments:o,insert:!1}):o instanceof D&&(n.splice.apply(n,[a,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,n)},reduce:function t(e){for(var i=this._children,n=i.length-1;n>=0;n--){var r=i[n].reduce(e);r.isEmpty()&&r.remove()}if(!i.length){var r=new z(k.NO_INSERT);return r.copyAttributes(this),r.insertAbove(this),this.remove(),r}return t.base.call(this)},isClosed:function(){for(var t=this._children,e=0,i=t.length;e<i;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,i=0,n=e.length;i<n;i++)e[i].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],i=0,n=t.length;i<n;i++)s.push(e,t[i].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,i=0,n=t.length;i<n;i++)e+=t[i].getArea();return e},getLength:function(){for(var t=this._children,e=0,i=0,n=t.length;i<n;i++)e+=t[i].getLength();return e},getPathData:function(t,e){for(var i=this._children,n=[],r=0,s=i.length;r<s;r++){var a=i[r],o=a._matrix;n.push(a.getPathData(t&&!o.isIdentity()?t.appended(o):t,e))}return n.join("")},_hitTestChildren:function t(e,i,n){return t.base.call(this,e,i.class===z||"path"===i.type?i:s.set({},i,{fill:!1}),n)},_draw:function(t,e,i,n){var r=this._children;if(r.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var s=0,a=r.length;s<a;s++)r[s].draw(t,e,n);if(!e.clip){this._setStyles(t,e,i);var o=this._style;o.hasFill()&&(t.fill(o.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,i){for(var n=this._children,r=0,s=n.length;r<s;r++){var a=n[r],o=a._matrix;i[a._id]||a._drawSelected(t,o.isIdentity()?e:e.appended(o))}}},new function(){function t(t,e){var i=t._children;if(e&&!i.length)throw Error("Use a moveTo() command first");return i[i.length-1]}return s.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(e){this[e]=function(){var i=t(this,!0);i[e].apply(i,arguments)}},{moveTo:function(){var e=t(this),i=e&&e.isEmpty()?e:new z(k.NO_INSERT);i!==e&&this.addChild(i),i.moveTo.apply(i,arguments)},moveBy:function(){var e=t(this,!0),i=e&&e.getLastSegment(),n=p.read(arguments);this.moveTo(i?n.add(i._point):n)},closePath:function(e){t(this,!0).closePath(e)}})},s.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(e){for(var i,n=this._children,r=0,s=n.length;r<s;r++)i=n[r][t](e)||i;return i}},{}));R.inject(new function(){var t=Math.min,e=Math.max,n=Math.abs,r={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function a(t){return t._children||[t]}function o(t,e){var i=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var n=a(i),r=0,s=n.length;r<s;r++){var t=n[r];t._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0))}i=i.resolveCrossings().reorient("nonzero"===i.getFillRule(),!0)}return i}function h(t,e,i,n,r){var s=new D(k.NO_INSERT);return s.addChildren(t,!0),s=s.reduce({simplify:e}),r&&!1==r.insert||s.insertAbove(n&&i.isSibling(n)&&i.getIndex()<n.getIndex()?n:i),s.copyAttributes(i,!0),s}function u(t){return t.hasOverlap()||t.isCrossing()}function c(t,e,i,n){if(n&&(!1==n.trace||n.stroke)&&/^(subtract|intersect)$/.test(i))return f(t,e,i);var c=o(t,!0),d=e&&t!==e&&o(e,!0),p=r[i];p[i]=!0,d&&(p.subtract||p.exclude)^(d.isClockwise()^c.isClockwise())&&d.reverse();var g,v=_(N.expand(c.getIntersections(d,u))),x=a(c),w=d&&a(d),k=[],C=[];function S(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];s.push(k,n._segments),s.push(C,n.getCurves()),n._overlapsOnly=!0}}function I(t){for(var e=[],i=0,n=t&&t.length;i<n;i++)e.push(C[t[i]]);return e}if(v.length){S(x),w&&S(w);for(var E=Array(C.length),T=0,A=C.length;T<A;T++)E[T]=C[T].getValues();for(var P=l.findCurveBoundsCollisions(E,E,0,!0),M={},T=0;T<C.length;T++){var O=C[T],L=O._path._id;(M[L]=M[L]||{})[O.getIndex()]={hor:I(P[T].hor),ver:I(P[T].ver)}}for(var T=0,A=v.length;T<A;T++)y(v[T]._segment,c,d,M,p);for(var T=0,A=k.length;T<A;T++){var R=k[T],z=R._intersection;R._winding||y(R,c,d,M,p),z&&z._overlap||(R._path._overlapsOnly=!1)}g=b(k,p)}else g=m(w?x.concat(w):x.slice(),function(t){return!!p[t]});return h(g,!0,t,e,n)}function f(t,e,i){var n=o(t),r=o(e),s=n.getIntersections(r,u),a="subtract"===i,l="divide"===i,c={},d=[];function f(t){if(!c[t._id]&&(l||r.contains(t.getPointAt(t.getLength()/2))^a))return d.unshift(t),c[t._id]=!0}for(var p=s.length-1;p>=0;p--){var g=s[p].split();g&&(f(g)&&g.getFirstSegment().setHandleIn(0,0),n.getLastSegment().setHandleOut(0,0))}return f(n),h(d,!1,t,e)}function p(t,e){for(var i=t;i;){if(i===e)return;i=i._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function g(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function m(t,e,i){var r=t&&t.length;if(r){var a=s.each(t,function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}},{}),o=t.slice().sort(function(t,e){return n(e.getArea())-n(t.getArea())}),h=o[0],u=l.findItemBoundsCollisions(o,null,d.GEOMETRIC_EPSILON);null==i&&(i=h.isClockwise());for(var c=0;c<r;c++){var f=o[c],p=a[f._id],g=0,m=u[c];if(m){for(var _=null,v=m.length-1;v>=0;v--)if(m[v]<c){_=_||f.getInteriorPoint();var y=o[m[v]];if(y.contains(_)){var b=a[y._id];g=b.winding,p.winding+=g,p.container=b.exclude?b.container:y;break}}}if(e(p.winding)===e(g))p.exclude=!0,t[p.index]=null;else{var x=p.container;f.setClockwise(x?!x.isClockwise():i)}}}return t}function _(t,e,i){var n,r,s,a=e&&[],o=!1,h=i||[],l=i&&{};function u(t){return t._path._id+"."+t._segment1._index}for(var c=(i&&i.length)-1;c>=0;c--){var d=i[c];d._path&&(l[u(d)]=!0)}for(var c=t.length-1;c>=0;c--){var f,m=t[c],_=m._time,v=_,y=e&&!e(m),d=m._curve;if(d&&(d!==r?(o=!d.hasHandles()||l&&l[u(d)],n=[],s=null,r=d):s>=1e-8&&(_/=s)),y){n&&n.push(m);continue}if(e&&a.unshift(m),s=v,_<1e-8)f=d._segment1;else if(_>.99999999)f=d._segment2;else{var b=d.divideAtTime(_,!0);o&&h.push(d,b),f=b._segment1;for(var x=n.length-1;x>=0;x--){var w=n[x];w._time=(w._time-_)/(1-_)}}m._setSegment(f);var k=f._intersection,C=m._intersection;if(k){p(k,C);for(var S=k;S;)p(S._intersection,k),S=S._next}else f._intersection=C}return i||g(h),a||t}function v(i,r,s,a,o){var h,l,u=Array.isArray(r)?r:r[s?"hor":"ver"],c=s?1:0,d=1^c,f=[i.x,i.y],p=f[c],g=f[d],m=p-1e-9,_=p+1e-9,y=0,b=0,x=0,w=0,k=!1,C=!1,S=1,I=[];function E(n){var l=n[d+0],u=n[d+2],f=n[d+4],y=n[d+6];if(g<=e(l,u,f,y)&&g>=t(l,u,f,y)){for(var b,C=n[c+0],E=n[c+2],T=n[c+4],A=n[c+6],P=m>e(C,E,T,A)||_<t(C,E,T,A)?[n]:L.getMonoCurves(n,s),M=0,O=P.length;M<O;M++)if(b=function(n){var l=n[d+0],u=n[d+6];if(!(g<t(l,u)||g>e(l,u))){var f=n[c+0],y=n[c+2],b=n[c+4],C=n[c+6];if(l===u){(f<_&&C>m||C<_&&f>m)&&(k=!0);return}var E=g===l?0:g===u?1:m>e(f,y,b,C)||_<t(f,y,b,C)?1:L.solveCubic(n,d,g,I,0,1)>0?I[0]:1,T=0===E?f:1===E?C:L.getPoint(n,E)[s?"y":"x"],A=l>u?1:-1,P=h[d]>h[d+6]?1:-1,M=h[c+6];return g!==l?(T<m?x+=A:T>_?w+=A:k=!0,T>p-1e-6&&T<p+1e-6&&(S/=2)):(A!==P?f<m?x+=A:f>_&&(w+=A):f!=M&&(M<_&&T>_?(w+=A,k=!0):M>m&&T<m&&(x+=A,k=!0)),S/=4),h=n,!o&&T>m&&T<_&&0===L.getTangent(n,E)[s?"x":"y"]&&v(i,r,!s,a,!0)}}(P[M]))return b}}for(var T=0,A=u.length;T<A;T++){var P,M=u[T],O=M._path,N=M.getValues();if((!T||u[T-1]._path!==O)&&(h=null,O._closed||(l=L.getValues(O.getLastCurve().getSegment2(),M.getSegment1(),null,!a))[d]===l[d+6]||(h=l),!h)){h=N;for(var R=O.getLastCurve();R&&R!==M;){var z=R.getValues();if(z[d]!==z[d+6]){h=z;break}R=R.getPrevious()}}if(P=E(N))return P;if(T+1===A||u[T+1]._path!==O){if(l&&(P=E(l)))return P;!k||x||w||(x=w=O.isClockwise(a)^s?1:-1),y+=x,b+=w,x=w=0,k&&(C=!0,k=!1),l=null}}return{winding:e(y=n(y),b=n(b)),windingL:y,windingR:b,quality:S,onPath:C}}function y(t,e,i,r,s){var a,o=[],h=t,l=0;do{var u=t.getCurve();if(u){var c=u.getLength();o.push({segment:t,curve:u,length:c}),l+=c}t=t.getNext()}while(t&&!t._intersection&&t!==h)for(var f=[.5,.25,.75],a={winding:0,quality:-1},p=0;p<f.length&&a.quality<.5;p++)for(var c=l*f[p],g=0,m=o.length;g<m;g++){var _=o[g],y=_.length;if(c<=y){var u=_.curve,b=u._path,x=b._parent,w=x instanceof D?x:b,k=d.clamp(u.getTimeAt(c),.001,.999),C=u.getPointAtTime(k),S=n(u.getTangentAtTime(k).y)<Math.SQRT1_2,I=null;if(s.subtract&&i){var E=(w===e?i:e)._getWinding(C,S,!0);if(w===e&&E.winding||w===i&&!E.winding){if(E.quality<1)continue;I={winding:0,quality:1}}}(I=I||v(C,r[b._id][u.getIndex()],S,!0)).quality>a.quality&&(a=I);break}c-=y}for(var g=o.length-1;g>=0;g--)o[g].segment._winding=a}function b(t,e){var i,n=[];function r(t){var i;return!!(t&&!t._visited&&(!e||e[(i=t._winding||{}).winding]&&!(e.unite&&2===i.winding&&i.windingL&&i.windingR)))}function s(t){if(t){for(var e=0,n=i.length;e<n;e++)if(t===i[e])return!0}return!1}function a(t){for(var e=t._segments,i=0,n=e.length;i<n;i++)e[i]._visited=!0}t.sort(function(t,e){var i=t._intersection,n=e._intersection,r=!!(i&&i._overlap),s=!!(n&&n._overlap),a=t._path,o=e._path;return r^s?r?1:-1:!i^!n?i?1:-1:a!==o?a._id-o._id:t._index-e._index});for(var o=0,h=t.length;o<h;o++){var l,u,c,d=t[o],f=r(d),p=null,g=!1,m=!0,_=[];if(f&&d._path._overlapsOnly){var v=d._path,y=d._intersection._segment._path;v.compare(y)&&(v.getArea()&&n.push(v.clone(!1)),a(v),a(y),f=!1)}for(;f;){var b=!p,x=function(t,e){var n=t._intersection,a=n,o=[];function h(n,a){for(;n&&n!==a;){var h=n._segment,l=h&&h._path;if(l){var u=h.getNext()||l.getFirstSegment(),c=u._intersection;h!==t&&(s(h)||s(u)||u&&r(h)&&(r(u)||c&&r(c._segment)))&&o.push(h),e&&i.push(h)}n=n._next}}if(e&&(i=[t]),n){for(h(n);n&&n._previous;)n=n._previous;h(n,a)}return o}(d,b),w=x.shift(),g=!b&&(s(d)||s(w)),C=!g&&w;if(b&&(p=new z(k.NO_INSERT),l=null),g){(d.isFirst()||d.isLast())&&(m=d._path._closed),d._visited=!0;break}if(C&&l&&(_.push(l),l=null),l||(C&&x.push(d),l={start:p._segments.length,crossings:x,visited:u=[],handleIn:c}),C&&(d=w),!r(d)){p.removeSegments(l.start);for(var S=0,I=u.length;S<I;S++)u[S]._visited=!1;u.length=0;do(d=l&&l.crossings.shift())&&d._path||(d=null,(l=_.pop())&&(u=l.visited,c=l.handleIn));while(l&&!r(d))if(!d)break}var E=d.getNext();p.add(new M(d._point,c,E&&d._handleOut)),d._visited=!0,u.push(d),d=E||d._path.getFirstSegment(),c=E&&E._handleIn}g&&(m&&(p.getFirstSegment().setHandleIn(c),p.setClosed(m)),0!==p.getArea()&&n.push(p))}return n}return{_getWinding:function(t,e,i){return v(t,this.getCurves(),e,i)},unite:function(t,e){return c(this,t,"unite",e)},intersect:function(t,e){return c(this,t,"intersect",e)},subtract:function(t,e){return c(this,t,"subtract",e)},exclude:function(t,e){return c(this,t,"exclude",e)},divide:function(t,e){return e&&(!1==e.trace||e.stroke)?f(this,t,"divide"):h([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function i(t,e){var i=t&&t._intersection;return i&&i._overlap&&i._path===e}var n=!1,r=!1,a=this.getIntersections(null,function(t){return t.hasOverlap()&&(n=!0)||t.isCrossing()&&(r=!0)}),o=n&&r&&[];if(a=N.expand(a),n)for(var h=_(a,function(t){return t.hasOverlap()},o),l=h.length-1;l>=0;l--){var u=h[l],c=u._path,d=u._segment,f=d.getPrevious(),p=d.getNext();i(f,c)&&i(p,c)&&(d.remove(),f._handleOut._set(0,0),p._handleIn._set(0,0),f===d||f.getCurve().hasLength()||(p._handleIn.set(f._handleIn),f.remove()))}r&&(_(a,n&&function(t){var e=t.getCurve(),i=t.getSegment(),n=t._intersection,r=n._curve,s=n._segment;if(e&&r&&e._path&&r._path)return!0;i&&(i._intersection=null),s&&(s._intersection=null)},o),o&&g(o),e=b(s.each(e,function(t){s.push(this,t._segments)},[])));var m,v=e.length;return v>1&&t?(e!==t&&this.setChildren(e),m=this):1!==v||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),m=this),m||((m=new D(k.NO_INSERT)).addChildren(e),(m=m.reduce()).copyAttributes(this),this.replaceWith(m)),m},reorient:function(t,e){var n=this._children;return n&&n.length?this.setChildren(m(this.removeChildren(),function(e){return!!(t?e:1&e)},e)):e!==i&&this.setClockwise(e),this},getInteriorPoint:function(){var i=this.getBounds().getCenter(!0);if(!this.contains(i)){for(var n=this.getCurves(),r=i.y,s=[],a=[],o=0,h=n.length;o<h;o++){var l=n[o].getValues(),u=l[1],c=l[3],d=l[5],f=l[7];if(r>=t(u,c,d,f)&&r<=e(u,c,d,f))for(var p=L.getMonoCurves(l),g=0,m=p.length;g<m;g++){var _=p[g],v=_[1],y=_[7];if(v!==y&&(r>=v&&r<=y||r>=y&&r<=v)){var b=r===v?_[0]:r===y?_[6]:1===L.solveCubic(_,1,r,a,0,1)?L.getPoint(_,a[0]).x:(_[0]+_[6])/2;s.push(b)}}}s.length>1&&(s.sort(function(t,e){return t-e}),i.x=(s[0]+s[1])/2)}return i}}});var B=s.extend({_class:"PathFlattener",initialize:function(t,e,i,n,r){var s,a=[],o=[],h=0,l=1/(i||32),u=t._segments,c=u[0];function d(t,i){var s=L.getValues(t,i,r);a.push(s),function t(i,r,s,a){if(!(a-s>l)||n&&L.isStraight(i)||L.isFlatEnough(i,e||.25)){var u=i[6]-i[0],c=i[7]-i[1],d=Math.sqrt(u*u+c*c);d>0&&(h+=d,o.push({offset:h,curve:i,index:r,time:a}))}else{var f=L.subdivide(i,.5),p=(s+a)/2;t(f[0],r,s,p),t(f[1],r,p,a)}}(s,t._index,0,1)}for(var f=1,p=u.length;f<p;f++)d(c,s=u[f]),c=s;t._closed&&d(s||c,u[0]),this.curves=a,this.parts=o,this.length=h,this.index=0},_get:function(t){for(var e,i=this.parts,n=i.length,r=this.index;e=r,r&&!(i[--r].offset<t););for(;e<n;e++){var s=i[e];if(s.offset>=t){this.index=e;var a=i[e-1],o=a&&a.index===s.index?a.time:0,h=a?a.offset:0;return{index:s.index,time:o+(s.time-o)*(t-h)/(s.offset-h)}}}return{index:i[n-1].index,time:1}},drawPart:function(t,e,i){for(var n=this._get(e),r=this._get(i),s=n.index,a=r.index;s<=a;s++){var o=L.getPart(this.curves[s],s===n.index?n.time:0,s===r.index?r.time:1);s===n.index&&t.moveTo(o[0],o[1]),t.bezierCurveTo.apply(t,o.slice(2))}}},s.each(L._evaluateMethods,function(t){this[t+"At"]=function(e){var i=this._get(e);return L[t](this.curves[i.index],i.time)}},{})),j=s.extend({initialize:function(t){for(var e,i=this.points=[],n=t._segments,r=t._closed,s=0,a=n.length;s<a;s++){var o=n[s].point;e&&e.equals(o)||i.push(e=o.clone())}r&&(i.unshift(i[i.length-1]),i.push(i[1])),this.closed=r},fit:function(t){var e=this.points,i=e.length,n=null;return i>0&&(n=[new M(e[0])],i>1&&(this.fitCubic(n,t,0,i-1,e[1].subtract(e[0]),e[i-2].subtract(e[i-1])),this.closed&&(n.shift(),n.pop()))),n},fitCubic:function(t,e,i,n,r,s){var a=this.points;if(n-i==1){var o=a[i],h=a[n],l=o.getDistance(h)/3;this.addCurve(t,[o,o.add(r.normalize(l)),h.add(s.normalize(l)),h]);return}for(var u,c=this.chordLengthParameterize(i,n),d=Math.max(e,e*e),f=!0,p=0;p<=4;p++){var g=this.generateBezier(i,n,c,r,s),m=this.findMaxError(i,n,g,c);if(m.error<e&&f){this.addCurve(t,g);return}if(u=m.index,m.error>=d)break;f=this.reparameterize(i,n,c,g),d=m.error}var _=a[u-1].subtract(a[u+1]);this.fitCubic(t,e,i,u,r,_),this.fitCubic(t,e,u,n,_.negate(),s)},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new M(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,i,n,r){for(var s=Math.abs,a=this.points,o=a[t],h=a[e],l=[[0,0],[0,0]],u=[0,0],c=0,d=e-t+1;c<d;c++){var f=i[c],p=1-f,g=3*f*p,m=p*p*p,_=g*p,v=g*f,y=f*f*f,b=n.normalize(_),x=r.normalize(v),w=a[t+c].subtract(o.multiply(m+_)).subtract(h.multiply(v+y));l[0][0]+=b.dot(b),l[0][1]+=b.dot(x),l[1][0]=l[0][1],l[1][1]+=x.dot(x),u[0]+=b.dot(w),u[1]+=x.dot(w)}var k,C,S=l[0][0]*l[1][1]-l[1][0]*l[0][1];if(s(S)>1e-12){var I=l[0][0]*u[1]-l[1][0]*u[0];k=(u[0]*l[1][1]-u[1]*l[0][1])/S,C=I/S}else{var E=l[0][0]+l[0][1],T=l[1][0]+l[1][1];k=C=s(E)>1e-12?u[0]/E:s(T)>1e-12?u[1]/T:0}var A,P,M=h.getDistance(o),O=1e-12*M;if(k<O||C<O)k=C=M/3;else{var L=h.subtract(o);A=n.normalize(k),P=r.normalize(C),A.dot(L)-P.dot(L)>M*M&&(k=C=M/3,A=P=null)}return[o,o.add(A||n.normalize(k)),h.add(P||r.normalize(C)),h]},reparameterize:function(t,e,i,n){for(var r=t;r<=e;r++)i[r-t]=this.findRoot(n,this.points[r],i[r-t]);for(var r=1,s=i.length;r<s;r++)if(i[r]<=i[r-1])return!1;return!0},findRoot:function(t,e,i){for(var n=[],r=[],s=0;s<=2;s++)n[s]=t[s+1].subtract(t[s]).multiply(3);for(var s=0;s<=1;s++)r[s]=n[s+1].subtract(n[s]).multiply(2);var a=this.evaluate(3,t,i),o=this.evaluate(2,n,i),h=this.evaluate(1,r,i),l=a.subtract(e),u=o.dot(o)+l.dot(h);return d.isMachineZero(u)?i:i-l.dot(o)/u},evaluate:function(t,e,i){for(var n=e.slice(),r=1;r<=t;r++)for(var s=0;s<=t-r;s++)n[s]=n[s].multiply(1-i).add(n[s+1].multiply(i));return n[0]},chordLengthParameterize:function(t,e){for(var i=[0],n=t+1;n<=e;n++)i[n-t]=i[n-t-1]+this.points[n].getDistance(this.points[n-1]);for(var n=1,r=e-t;n<=r;n++)i[n]/=i[r];return i},findMaxError:function(t,e,i,n){for(var r=Math.floor((e-t+1)/2),s=0,a=t+1;a<e;a++){var o=this.evaluate(3,i,n[a-t]).subtract(this.points[a]),h=o.x*o.x+o.y*o.y;h>=s&&(s=h,r=a)}return{error:s,index:r}}}),V=k.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var e=t&&s.isPlainObject(t)&&t.x===i&&t.y===i;this._initialize(e&&t,!e&&p.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),F=V.extend({_class:"PointText",initialize:function(){V.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new g(t.x,t.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,i){if(this._content){this._setStyles(t,e,i);var n=this._lines,r=this._style,s=r.hasFill(),a=r.hasStroke(),o=r.getLeading(),h=t.shadowColor;t.font=r.getFontStyle(),t.textAlign=r.getJustification();for(var l=0,u=n.length;l<u;l++){t.shadowColor=h;var c=n[l];s&&(t.fillText(c,0,0),t.shadowColor="rgba(0,0,0,0)"),a&&t.strokeText(c,0,0),t.translate(0,o)}}},_getBounds:function(t,e){var i=this._style,n=this._lines,r=n.length,s=i.getJustification(),a=i.getLeading(),o=this.getView().getTextWidth(i.getFontStyle(),n),h=0;"left"!==s&&(h-=o/("center"===s?2:1));var l=new v(h,r?-.75*a:0,o,r*a);return t?t._transformBounds(l,l):l}}),U=s.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},r={transparent:[0,0,0,0]},a=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(t,e,i){var n=Math.max(t,e,i),r=n-Math.min(t,e,i);return[0===r?0:(n==t?(e-i)/r+(e<i?6:0):n==e?(i-t)/r+2:(t-e)/r+4)*60,0===n?0:r/n,n]},"hsb-rgb":function(t,e,i){var n=Math.floor(t=(t/60%6+6)%6),r=t-n,n=a[n],s=[i,i*(1-e),i*(1-e*r),i*(1-e*(1-r))];return[s[n[0]],s[n[1]],s[n[2]]]},"rgb-hsl":function(t,e,i){var n=Math.max(t,e,i),r=Math.min(t,e,i),s=n-r,a=0===s,o=(n+r)/2;return[a?0:(n==t?(e-i)/s+(e<i?6:0):n==e?(i-t)/s+2:(t-e)/s+4)*60,a?0:o<.5?s/(n+r):s/(2-n-r),o]},"hsl-rgb":function(t,e,i){if(t=(t/360%1+1)%1,0===e)return[i,i,i];for(var n=[t+1/3,t,t-1/3],r=i<.5?i*(1+e):i+e-i*e,s=2*i-r,a=[],o=0;o<3;o++){var h=n[o];h<0&&(h+=1),h>1&&(h-=1),a[o]=6*h<1?s+(r-s)*6*h:2*h<1?r:3*h<2?s+(r-s)*(2/3-h)*6:s}return a},"rgb-gray":function(t,e,i){return[.2989*t+.587*e+.114*i]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return s.each(e,function(t,n){i[n]=[],s.each(t,function(t,r){var a=s.capitalize(t),o=/^(hue|saturation)$/.test(t),h=i[n][r]="gradient"===n?"gradient"===t?function(t){var e=this._components[0];return t=q.read(Array.isArray(t)?t:arguments,0,{readNull:!0}),e!==t&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return p.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+a]=function(){return this._type===n||o&&/^hs[bl]$/.test(this._type)?this._components[r]:this._convert(n)[r]},this["set"+a]=function(t){this._type===n||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(n),this._properties=e[n],this._type=n),this._components[r]=h.call(this,t),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function a(o){var h,l,u,c,d=arguments,f=this.__read,p=0;Array.isArray(o)&&(o=(d=o)[0]);var g=null!=o&&typeof o;if("string"===g&&o in e&&(h=o,Array.isArray(o=d[1])?(l=o,u=d[2]):(f&&(p=1),d=s.slice(d,1),g=typeof o)),!l){if(c="number"===g?d:"object"===g&&null!=o.length?o:null){h||(h=c.length>=3?"rgb":"gray");var m=e[h].length;u=c[m],f&&(p+=c===arguments?m+(null!=u?1:0):1),c.length>m&&(c=s.slice(c,0,m))}else if("string"===g){var _=function(e){var i,s=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),a="rgb";if(s){var o=s[4]?4:3;i=Array(o);for(var h=0;h<o;h++){var l=s[h+1];i[h]=parseInt(1==l.length?l+l:l,16)/255}}else if(s=e.match(/^(rgb|hsl)a?\((.*)\)$/)){a=s[1],i=s[2].trim().split(/[,\s]+/g);for(var u="hsl"===a,h=0,c=Math.min(i.length,4);h<c;h++){var d=i[h],l=parseFloat(d);u?0===h?l*=({turn:360,rad:180/Math.PI,grad:.9})[d.match(/([a-z]*)$/)[1]]||1:h<3&&(l/=100):h<3&&(l/=/%$/.test(d)?100:255),i[h]=l}}else{var f=r[e];if(!f){if(n){t||((t=tr.getContext(1,1,{willReadFrequently:!0})).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var p=t.getImageData(0,0,1,1).data;f=r[e]=[p[0]/255,p[1]/255,p[2]/255]}else f=[0,0,0]}i=f.slice()}return[a,i]}(o);h=_[0],4===(l=_[1]).length&&(u=l[3],l.length--)}else if("object"===g){if(o.constructor===a){if(h=o._type,l=o._components.slice(),u=o._alpha,"gradient"===h)for(var v=1,y=l.length;v<y;v++){var b=l[v];b&&(l[v]=b.clone())}}else if(o.constructor===q)h="gradient",c=d;else{var x=e[h="hue"in o?"lightness"in o?"hsl":"hsb":"gradient"in o||"stops"in o||"radial"in o?"gradient":"gray"in o?"gray":"rgb"],w=i[h];this._components=l=[];for(var v=0,y=x.length;v<y;v++){var k=o[x[v]];null==k&&!v&&"gradient"===h&&"stops"in o&&(k={stops:o.stops,radial:o.radial}),null!=(k=w[v].call(this,k))&&(l[v]=k)}u=o.alpha}}f&&h&&(p=1)}if(this._type=h||"rgb",!l){this._components=l=[];for(var w=i[this._type],v=0,y=w.length;v<y;v++){var k=w[v].call(this,c&&c[v]);null!=k&&(l[v]=k)}}return this._components=l,this._properties=e[this._type],this._alpha=u,f&&(this.__read=p),this},set:"#initialize",_serialize:function(t,e){var i=this.getComponents();return s.serialize(/^(gray|rgb)$/.test(this._type)?i:[this._type].concat(i),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=o[this._type+"-"+t])?e.apply(this,this._components):o["rgb-"+t].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new U(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=s.isPlainValue(t,!0)?U.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&s.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],i="gradient"===this._type,n=c.instance,r=0,s=t.length;r<s;r++){var a=this._components[r];null!=a&&e.push(t[r]+": "+(i?a:n.number(a)))}return null!=this._alpha&&e.push("alpha: "+n.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),i=t||null==this._alpha?1:this._alpha;function n(t){return Math.round((t<0?0:t>1?1:t)*255)}return e=[n(e[0]),n(e[1]),n(e[2])],i<1&&e.push(i<0?0:i),t?"#"+(16777216+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var i,n=this._components,r=n[0],s=r._stops,a=n[1],o=n[2],h=n[3],l=e&&e.inverted();if(l&&(a=l._transformPoint(a),o=l._transformPoint(o),h&&(h=l._transformPoint(h))),r._radial){var u=o.getDistance(a);if(h){var c=h.subtract(a);c.getLength()>u&&(h=a.add(c.normalize(u-.1)))}var d=h||a;i=t.createRadialGradient(d.x,d.y,0,a.x,a.y,u)}else i=t.createLinearGradient(a.x,a.y,o.x,o.y);for(var f=0,p=s.length;f<p;f++){var g=s[f],m=g._offset;i.addColorStop(null==m?f/(p-1):m,g._color.toCanvasStyle())}return this._canvasStyle=i},transform:function(t){if("gradient"===this._type){for(var e=this._components,i=1,n=e.length;i<n;i++){var r=e[i];t._transformPoint(r,r,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new U(t(),t(),t())},_setOwner:function(t,e,i){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=i||null)),t}}})},new function(){return s.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},function(t,e){this[e]=function(e){e=U.read(arguments);for(var i=this._type,n=this._components,r=e._convert(i),s=0,a=n.length;s<a;s++)r[s]=t(n[s],r[s]);return new U(i,r,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}},{})}),q=s.extend({_class:"Gradient",initialize:function(t,e){this._id=f.get(),t&&s.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,function(){return s.serialize([this._stops,this._radial],t,!0,e)})},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;-1==e||(this._owners.splice(e,1),this._owners.length||(this._owners=i))},clone:function(){for(var t=[],e=0,i=this._stops.length;e<i;e++)t[e]=this._stops[e].clone();return new q(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var n=0,r=e.length;n<r;n++)e[n]._owner=i;e=this._stops=$.readList(t,0,{clone:!0});for(var n=0,r=e.length;n<r;n++)e[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,i=t._stops,n=e.length;if(n===i.length){for(var r=0;r<n;r++)if(!e[r].equals(i[r]))return!1;return!0}}return!1}}),$=s.extend({_class:"GradientStop",initialize:function(t,e){var n=t,r=e;"object"==typeof t&&e===i&&(Array.isArray(t)&&"number"!=typeof t[0]?(n=t[0],r=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(n=t.color,r=t.offset||t.rampPoint||0)),this.setColor(n),this.setOffset(r)},clone:function(){return new $(this._color.clone(),this._offset)},_serialize:function(t,e){var i=this._color,n=this._offset;return s.serialize(null==n?[i]:[i,n],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){U._setOwner(this._color,null),this._color=U._setOwner(U.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),Z=s.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new p,selectedColor:null},e=s.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=s.set({},e,{fillColor:new U}),r={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},a={beans:!0},o={_class:"Style",beans:!0,initialize:function(i,r,s){this._values={},this._owner=r,this._project=r&&r._project||s||th.project,this._defaults=!r||r instanceof C?e:r instanceof V?n:t,i&&this.set(i)}};return s.each(e,function(t,e){var n=/Color$/.test(e),h="shadowOffset"===e,l=s.capitalize(e),u=r[e],c="set"+l,d="get"+l;o[c]=function(t){var i=this._owner,r=i&&i._children,s=r&&r.length>0&&!(i instanceof D);if(s)for(var a=0,o=r.length;a<o;a++)r[a]._style[c](t);if(("selectedColor"===e||!s)&&e in this._defaults){var h=this._values[e];h!==t&&(n&&(h&&(U._setOwner(h,null),h._canvasStyle=null),t&&t.constructor===U&&(t=U._setOwner(t,i,s&&c))),this._values[e]=t,i&&i._changed(u||129))}},o[d]=function(t){var r,a=this._owner,o=a&&a._children,l=o&&o.length>0&&!(a instanceof D);if(l&&!t)for(var u=0,f=o.length;u<f;u++){var g=o[u]._style[d]();if(u){if(!s.equals(r,g))return i}else r=g}else if(e in this._defaults){var r=this._values[e];if(r===i)(r=this._defaults[e])&&r.clone&&(r=r.clone());else{var m=n?U:h?p:null;m&&!(r&&r.constructor===m)&&(this._values[e]=r=m.read([r],0,{readNull:!0,clone:!0}))}}return r&&n&&(r=U._setOwner(r,a,l&&c)),r},a[d]=function(t){return this._style[d](t)},a[c]=function(t){this._style[c](t)}}),s.each({Font:"FontFamily",WindingRule:"FillRule"},function(t,e){var i="get"+e,n="set"+e;o[i]=a[i]="#get"+t,o[n]=a[n]="#set"+t}),k.inject(a),o},{set:function(t){var e=t instanceof Z,i=e?t._values:t;if(i){for(var n in i)if(n in this._defaults){var r=i[n];this[n]=r&&e&&r.clone?r.clone():r}}},equals:function(t){function e(t,e,n){var r=t._values,a=e._values,o=e._defaults;for(var h in r){var l=r[h],u=a[h];if(!(n&&h in a)&&!s.equals(l,u===i?o[h]:u))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),i=this.getFontSize();return/pt|em|%|px/.test(i)&&(i=this.getView().getPixelSize(i)),null!=e?e:1.2*i}}),H=new function(){function t(t,e,i,n){for(var r=["","webkit","moz","Moz","ms","o"],s=e[0].toUpperCase()+e.substring(1),a=0;a<6;a++){var o=r[a],h=o?o+s:e;if(h in t){if(!i)return t[h];t[h]=n;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,i=e&&e.defaultView;return i&&i.getComputedStyle(t,"")},getBounds:function(t,e){var i,n=t.ownerDocument,r=n.body,s=n.documentElement;try{i=t.getBoundingClientRect()}catch(t){i={left:0,top:0,width:0,height:0}}var a=i.left-(s.clientLeft||r.clientLeft||0),o=i.top-(s.clientTop||r.clientTop||0);if(!e){var h=n.defaultView;a+=h.pageXOffset||s.scrollLeft||r.scrollLeft,o+=h.pageYOffset||s.scrollTop||r.scrollTop}return new v(a,o,i.width,i.height)},getViewportBounds:function(t){var e=t.ownerDocument,i=e.defaultView,n=e.documentElement;return new v(0,0,i.innerWidth||n.clientWidth,i.innerHeight||n.clientHeight)},getOffset:function(t,e){return H.getBounds(t,e).getPoint()},getSize:function(t){return H.getBounds(t,!0).getSize()},isInvisible:function(t){return H.getSize(t).equals(new m(0,0))},isInView:function(t){return!H.isInvisible(t)&&H.getViewportBounds(t).intersects(H.getBounds(t,!0))},isInserted:function(t){return r.body.contains(t)},getPrefixed:function(e,i){return e&&t(e,i)},setPrefixed:function(e,i,n){if("object"==typeof i)for(var r in i)t(e,r,!0,i[r]);else t(e,i,!0,n)}}},G={add:function(t,e){if(t)for(var i in e)for(var n=e[i],s=i.split(/[\s,]+/g),a=0,o=s.length;a<o;a++){var h=s[a],l=t===r&&("touchstart"===h||"touchmove"===h)&&{passive:!1};t.addEventListener(h,n,l)}},remove:function(t,e){if(t)for(var i in e)for(var n=e[i],r=i.split(/[\s,]+/g),s=0,a=r.length;s<a;s++)t.removeEventListener(r[s],n,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new p(e.pageX||e.clientX+r.documentElement.scrollLeft,e.pageY||e.clientY+r.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return G.getPoint(t).subtract(H.getOffset(e||G.getTarget(t)))}};G.requestAnimationFrame=new function(){var t,e=H.getPrefixed(n,"requestAnimationFrame"),i=!1,r=[];function s(){var t=r;r=[];for(var n=0,a=t.length;n<a;n++)t[n]();(i=e&&r.length)&&e(s)}return function(n){r.push(n),e?i||(e(s),i=!0):t||(t=setInterval(s,1e3/60))}};var W=s.extend(a,{_class:"View",initialize:function t(e,i){function s(t){return i[t]||parseInt(i.getAttribute(t),10)}function a(){var t=H.getSize(i);return t.isNaN()||t.isZero()?new m(s("width"),s("height")):t}if(n&&i){this._id=i.getAttribute("id"),null==this._id&&i.setAttribute("id",this._id="paper-view-"+t._id++),G.add(i,this._viewEvents);var h,l="none";if(H.setPrefixed(i.style,{userDrag:l,userSelect:l,touchCallout:l,contentZooming:l,tapHighlightColor:"rgba(0,0,0,0)"}),o.hasAttribute(i,"resize")){var u=this;G.add(n,this._windowEvents={resize:function(){u.setViewSize(a())}})}if(h=a(),o.hasAttribute(i,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var c=this._stats.domElement,d=c.style,f=H.getOffset(i);d.position="absolute",d.left=f.x+"px",d.top=f.y+"px",r.body.appendChild(c)}}else h=new m(i),i=null;this._project=e,this._scope=e._scope,this._element=i,this._pixelRatio||(this._pixelRatio=n&&n.devicePixelRatio||1),this._setElementSize(h.width,h.height),this._viewSize=h,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new b)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!th.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;W._focused===this&&(W._focused=null),W._views.splice(W._views.indexOf(this),1),delete W._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),G.remove(this._element,this._viewEvents),G.remove(n,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:s.each(k._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;G.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;(!H.getPrefixed(r,"hidden")||"true"===o.getAttribute(e,"keepalive"))&&H.isInView(e)&&t._handleFrame()}t._autoUpdate&&t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){th=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new s({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var i=this._frameItems;e?(i[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete i[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var i=this._frameItems[e];i.item.emit("frame",new s(t,{time:i.time+=t.delta,count:i.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=i},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new _(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=m.read(arguments),e=t.subtract(this._viewSize);!e.isZero()&&(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var i=this._element;i&&(i.width!==t&&(i.width=t),i.height!==e&&(i.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new v(new p,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return H.isInView(this._element)},isInserted:function(){return H.isInserted(this._element)},getPixelSize:function(t){var e,i=this._element;if(i){var n=i.parentNode,s=r.createElement("div");s.style.fontSize=t,n.appendChild(s),e=parseFloat(H.getStyles(s).fontSize),n.removeChild(s)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},s.each(["rotate","scale","shear","skew"],function(t){var e="rotate"===t;this[t]=function(){var i=arguments,n=(e?s:p).read(i),r=p.read(i,0,{readNull:!0});return this.transform(new b()[t](n,r||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new b;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=p.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new b().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new g(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(p.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(p.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(p.read(arguments))},getEventPoint:function(t){return this.viewToProject(G.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return r&&"string"==typeof e&&(e=r.getElementById(e)),new(n?K:W)(t,e)}}},new function(){if(n){var t,e,i,s,a,o=!1,h=!1,l=n.navigator;l.pointerEnabled||l.msPointerEnabled?(i="pointerdown MSPointerDown",s="pointermove MSPointerMove",a="pointerup pointercancel MSPointerUp MSPointerCancel"):(i="touchstart",s="touchmove",a="touchend touchcancel","ontouchstart"in n&&l.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(i+=" mousedown",s+=" mousemove",a+=" mouseup"));var u={},c={mouseout:function(t){var e=W._focused,i=G.getRelatedTarget(t);if(e&&(!i||"HTML"===i.nodeName)){var n=G.getOffset(t,e._element),r=n.x,s=Math.abs,a=s(r),o=a-33554432;n.x=s(o)<a?o*(r<0?-1:1):r,E(e,t,e.viewToProject(n))}},scroll:I};u[i]=function(t){var e=W._focused=S(t);o||(o=!0,e._handleMouseEvent("mousedown",t))},c[s]=function(i){var n=W._focused;if(!h){var r=S(i);r?n!==r&&(n&&E(n,i),t||(t=n),n=W._focused=e=r):e&&e===n&&(t&&!t.isInserted()&&(t=null),n=W._focused=t,t=null,I())}n&&E(n,i)},c[i]=function(){h=!0},c[a]=function(t){var e=W._focused;e&&o&&e._handleMouseEvent("mouseup",t),h=o=!1},G.add(r,c),G.add(n,{load:I});var d,f,p,g,m,_,v,y,b=!1,x=!1,w={doubleclick:"click",mousedrag:"mousemove"},k=!1,C={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:u,_handleMouseEvent:function(t,e,i){var n=this._itemEvents,r=n.native[t],s="mousemove"===t,a=this._scope.tool,h=this;function l(t){return n.virtual[t]||h.responds(t)||a&&a.responds(t)}s&&o&&l("mousedrag")&&(t="mousedrag"),i||(i=this.getEventPoint(e));var u=this.getBounds().contains(i),c=r&&u&&h._project.hitTest(i,{tolerance:0,fill:!0,stroke:!0}),w=c&&c.item||null,C=!1,S={};if(S[t.substr(5)]=!0,r&&w!==g&&(g&&T(g,null,"mouseleave",e,i),w&&T(w,null,"mouseenter",e,i),g=w),k^u&&(T(this,null,u?"mouseenter":"mouseleave",e,i),C=!0),(u||S.drag)&&!i.equals(f)&&(A(this,w,s?t:"mousemove",e,i,f),C=!0),k=u,S.down&&u||S.up&&d){if(A(this,w,t,e,i,d),S.down){if(y=w===_&&Date.now()-v<300,p=_=w,!x&&w){for(var I=w;I&&!I.responds("mousedrag");)I=I._parent;I&&(m=w)}d=i}else S.up&&(x||w!==p||(v=Date.now(),A(this,w,y?"doubleclick":"click",e,i,d),y=!1),p=m=null);k=!1,C=!0}f=i,C&&a&&(b=a._handleMouseEvent(t,e,i,S)||b),!1!==e.cancelable&&(b&&!S.move||S.down&&l("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,i,n){var r,s=this._scope,a=s.tool;function o(a){a.responds(t)&&(th=s,a.emit(t,r=r||new Q(t,e,i,n)))}this.isVisible()&&(o(this),a&&a.responds(t)&&o(a))},_countItemEvent:function(t,e){var i=this._itemEvents,n=i.native,r=i.virtual;for(var s in C)n[s]=(n[s]||0)+(C[s][t]||0)*e;r[t]=(r[t]||0)+e},statics:{updateFocus:I,_resetState:function(){o=h=b=k=!1,t=e=d=f=p=g=m=_=v=y=null}}}}function S(t){var e=G.getTarget(t);return e.getAttribute&&W._viewsById[e.getAttribute("id")]}function I(){var t=W._focused;if(!t||!t.isVisible()){for(var i=0,n=W._views.length;i<n;i++)if((t=W._views[i]).isVisible()){W._focused=e=t;break}}}function E(t,e,i){t._handleMouseEvent("mousemove",e,i)}function T(t,e,i,n,r,s,a){for(var o,h=!1;t&&t!==a&&!function t(i,a){if(i.responds(a)){if(o||(o=new J(a,n,r,e||i,s?r.subtract(s):null)),i.emit(a,o)&&(b=!0,o.prevented&&(x=!0),o.stopped))return h=!0}else{var l=w[a];if(l)return t(i,l)}}(t,i);)t=t._parent;return h}function A(t,e,i,n,r,s){return t._project.removeOn(i),x=b=!1,m&&T(m,null,i,n,r,s)||e&&e!==m&&!e.isDescendant(m)&&T(e,null,"mousedrag"===i?"mousemove":i,n,r,s,m)||T(t,m||e||t,i,n,r,s)}}),K=W.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof n.HTMLCanvasElement)){var i=m.read(arguments,1);if(i.isZero())throw Error("Cannot create CanvasView with the provided argument: "+s.slice(arguments,1));e=tr.getCanvas(i)}var r=this._context=e.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(o.getAttribute(e,"hidpi"))){var a=n.devicePixelRatio||1,h=H.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=a/h}W.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,i){var n=this._pixelRatio;if(t.base.call(this,e*n,i*n),1!==n){var r=this._element,s=this._context;if(!o.hasAttribute(r,"resize")){var a=r.style;a.width=e+"px",a.height=i+"px"}s.restore(),s.save(),s.scale(n,n)}},getContext:function(){return this._context},getPixelSize:function t(e){var i,n=th.agent;if(n&&n.firefox)i=t.base.call(this,e);else{var r=this._context,s=r.font;r.font=e+" serif",i=parseFloat(r.font),r.font=s}return i},getTextWidth:function(t,e){var i=this._context,n=i.font,r=0;i.font=t;for(var s=0,a=e.length;s<a;s++)r=Math.max(r,i.measureText(e[s]).width);return i.font=n,r},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,i=this._viewSize;return e.clearRect(0,0,i.width+1,i.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Y=s.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return X.modifiers}}),Q=Y.extend({_class:"KeyEvent",initialize:function(t,e,i,n){this.type=t,this.event=e,this.key=i,this.character=n},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),X=new function(){var t,e,a={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},o={tab:"	",space:" ",enter:"\r"},h={},l={},u=new s({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=th&&th.agent;return t&&t.mac?this.meta:this.control}}});function c(t){var e=t.key||t.keyIdentifier;return a[e=/^U\+/.test(e)?String.fromCharCode(parseInt(e.substr(2),16)):/^Arrow[A-Z]/.test(e)?e.substr(5):"Unidentified"===e||e===i?String.fromCharCode(t.keyCode):e]||(e.length>1?s.hyphenate(e):e.toLowerCase())}function d(e,i,n,r){var a,o=W._focused;if(h[i]=e,e?l[i]=n:delete l[i],i.length>1&&(a=s.camelize(i))in u){u[a]=e;var c=th&&th.agent;if("meta"===a&&c&&c.mac){if(e)t={};else{for(var f in t)f in l&&d(!1,f,t[f],r);t=null}}}else e&&t&&(t[i]=n);o&&o._handleKeyEvent(e?"keydown":"keyup",r,i,n)}return G.add(r,{keydown:function(t){var i=c(t),n=th&&th.agent;i.length>1||n&&n.chrome&&(t.altKey||n.mac&&t.metaKey||!n.mac&&t.ctrlKey)?d(!0,i,o[i]||(i.length>1?"":i),t):e=i},keypress:function(t){if(e){var i=c(t),n=t.charCode,r=n>=32?String.fromCharCode(n):i.length>1?"":i;i!==e&&(i=r.toLowerCase()),d(!0,i,r,t),e=null}},keyup:function(t){var e=c(t);e in l&&d(!1,e,l[e],t)}}),G.add(n,{blur:function(t){for(var e in l)d(!1,e,l[e],t)}}),{modifiers:u,isDown:function(t){return!!h[t]}}},J=Y.extend({_class:"MouseEvent",initialize:function(t,e,i,n,r){this.type=t,this.event=e,this.point=i,this.target=n,this.delta=r},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),tt=Y.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,i){this.tool=t,this.type=e,this.event=i},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,i=e._parent;/^(Group|CompoundPath)$/.test(i._class);)e=i,i=i._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),te=h.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){h.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,i,n){th=this._scope,n.drag&&!this.responds(t)&&(t="mousemove");var r=n.move||n.drag,s=this.responds(t),a=this.minDistance,o=this.maxDistance,h=!1,l=this;function u(t,e){var s=i,a=r?l._point:l._downPoint||s;if(r){if(l._moveCount>=0&&s.equals(a))return!1;if(a&&(null!=t||null!=e)){var o=s.subtract(a),h=o.getLength();if(h<(t||0))return!1;e&&(s=a.add(o.normalize(Math.min(h,e))))}l._moveCount++}return l._point=s,l._lastPoint=a||s,n.down&&(l._moveCount=-1,l._downPoint=s,l._downCount++),!0}function c(){s&&(h=l.emit(t,new tt(l,t,e))||h)}if(n.down)u(),c();else if(n.up)u(null,o),c();else if(s)for(;u(a,o);)c();return h}}),ti=s.extend(a,{_class:"Tween",statics:{easings:new s({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,i,n,r,s,a){this.object=e;var o=typeof s,h="function"===o;this.type=h?o:"string"===o?s:"linear",this.easing=h?s:t.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null;var l=i||n;this._keys=l?Object.keys(l):[],this._parsedKeys=this._parseKeys(this._keys),this._from=l&&this._getState(i),this._to=l&&this._getState(n),!1!==a&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),i=this._keys,n=function(i){return"function"==typeof i?i(e,t):i},r=0,a=i&&i.length;r<a;r++){var o=i[r],h=n(this._from[o]),l=n(this._to[o]),u=h&&l&&h.__add&&l.__add?l.__subtract(h).__multiply(e).__add(h):(l-h)*e+h;this._setProperty(this._parsedKeys[o],u)}this.responds("update")&&this.emit("update",new s({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,i=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(i)},_getState:function(t){for(var e=this._keys,i={},n=0,r=e.length;n<r;n++){var s,a=e[n],o=this._parsedKeys[a],h=this._getProperty(o);if(t){var l=this._resolveValue(h,t[a]);this._setProperty(o,l),s=(s=this._getProperty(o))&&s.clone?s.clone():s,this._setProperty(o,h)}else s=h&&h.clone?h.clone():h;i[a]=s}return i},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var i=e[0];return i&&i.match&&i.match(/^[+\-\*\/]=/)?this._calculate(t,i[0],e[1]):e}if("string"==typeof e){var n=e.match(/^[+\-*/]=(.*)/);if(n){var r=JSON.parse(n[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],r)}}}return e},_calculate:function(t,e,i){return th.PaperScript.calculateBinary(t,e,i)},_parseKeys:function(t){for(var e={},i=0,n=t.length;i<n;i++){var r=t[i],s=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[r]=s.split("/")}return e},_getProperty:function(t,e){for(var i=this.object,n=0,r=t.length-(e||0);n<r&&i;n++)i=i[t[n]];return i},_setProperty:function(t,e){var i=this._getProperty(t,1);i&&(i[t[t.length-1]]=e)}}),tn={request:function(t){var i=new e.XMLHttpRequest;return i.open((t.method||"get").toUpperCase(),t.url,s.pick(t.async,!0)),t.mimeType&&i.overrideMimeType(t.mimeType),i.onload=function(){var e=i.status;0===e||200===e?t.onLoad&&t.onLoad.call(i,i.responseText):i.onerror()},i.onerror=function(){var e=i.status,n='Could not load "'+t.url+'" (Status: '+e+")";if(t.onError)t.onError(n,e);else throw Error(n)},i.send(null)}},tr=s.exports.CanvasProvider={canvases:[],getCanvas:function(t,e,i){if(!n)return null;var s,a=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?s=this.canvases.pop():(s=r.createElement("canvas"),a=!1);var o=s.getContext("2d",i||{});if(!o)throw Error("Canvas "+s+" is unable to provide a 2D context.");return s.width===t&&s.height===e?a&&o.clearRect(0,0,t+1,e+1):(s.width=t,s.height=e),o.save(),s},getContext:function(t,e,i){var n=this.getCanvas(t,e,i);return n?n.getContext("2d",i||{}):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},ts=new function(){var t,e,i,n,r,a,o,h,l,u,c,d=Math.min,f=Math.max,p=Math.abs;function g(t,e,i){return .2989*t+.587*e+.114*i}function m(t,e,i,n){var r=n-g(t,e,i),n=g(l=t+r,u=e+r,c=i+r),s=d(l,u,c),a=f(l,u,c);if(s<0){var o=n-s;l=n+(l-n)*n/o,u=n+(u-n)*n/o,c=n+(c-n)*n/o}if(a>255){var h=255-n,p=a-n;l=n+(l-n)*h/p,u=n+(u-n)*h/p,c=n+(c-n)*h/p}}function _(t,e,i){return f(t,e,i)-d(t,e,i)}function v(t,e,i,n){var r,s=[t,e,i],a=f(t,e,i),o=d(t,e,i);r=0===d(o=o===t?0:o===e?1:2,a=a===t?0:a===e?1:2)?1===f(o,a)?2:1:0,s[a]>s[o]?(s[r]=(s[r]-s[o])*n/(s[a]-s[o]),s[a]=n):s[r]=s[a]=0,s[o]=0,l=s[0],u=s[1],c=s[2]}var y={multiply:function(){l=r*t/255,u=a*e/255,c=o*i/255},screen:function(){l=r+t-r*t/255,u=a+e-a*e/255,c=o+i-o*i/255},overlay:function(){l=r<128?2*r*t/255:255-2*(255-r)*(255-t)/255,u=a<128?2*a*e/255:255-2*(255-a)*(255-e)/255,c=o<128?2*o*i/255:255-2*(255-o)*(255-i)/255},"soft-light":function(){var n=t*r/255;l=n+r*(255-(255-r)*(255-t)/255-n)/255,u=(n=e*a/255)+a*(255-(255-a)*(255-e)/255-n)/255,c=(n=i*o/255)+o*(255-(255-o)*(255-i)/255-n)/255},"hard-light":function(){l=t<128?2*t*r/255:255-2*(255-t)*(255-r)/255,u=e<128?2*e*a/255:255-2*(255-e)*(255-a)/255,c=i<128?2*i*o/255:255-2*(255-i)*(255-o)/255},"color-dodge":function(){l=0===r?0:255===t?255:d(255,255*r/(255-t)),u=0===a?0:255===e?255:d(255,255*a/(255-e)),c=0===o?0:255===i?255:d(255,255*o/(255-i))},"color-burn":function(){l=255===r?255:0===t?0:f(0,255-(255-r)*255/t),u=255===a?255:0===e?0:f(0,255-(255-a)*255/e),c=255===o?255:0===i?0:f(0,255-(255-o)*255/i)},darken:function(){l=r<t?r:t,u=a<e?a:e,c=o<i?o:i},lighten:function(){l=r>t?r:t,u=a>e?a:e,c=o>i?o:i},difference:function(){(l=r-t)<0&&(l=-l),(u=a-e)<0&&(u=-u),(c=o-i)<0&&(c=-c)},exclusion:function(){l=r+t*(255-r-r)/255,u=a+e*(255-a-a)/255,c=o+i*(255-o-o)/255},hue:function(){v(t,e,i,_(r,a,o)),m(l,u,c,g(r,a,o))},saturation:function(){v(r,a,o,_(t,e,i)),m(l,u,c,g(r,a,o))},luminosity:function(){m(r,a,o,g(t,e,i))},color:function(){m(t,e,i,g(r,a,o))},add:function(){l=d(r+t,255),u=d(a+e,255),c=d(o+i,255)},subtract:function(){l=f(r-t,0),u=f(a-e,0),c=f(o-i,0)},average:function(){l=(r+t)/2,u=(a+e)/2,c=(o+i)/2},negation:function(){l=255-p(255-t-r),u=255-p(255-e-a),c=255-p(255-i-o)}},b=this.nativeModes=s.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(t){this[t]=!0},{}),x=tr.getContext(1,1,{willReadFrequently:!0});x&&(s.each(y,function(t,e){var i="darken"===e,n=!1;x.save();try{x.fillStyle=i?"#300":"#a00",x.fillRect(0,0,1,1),x.globalCompositeOperation=e,x.globalCompositeOperation===e&&(x.fillStyle=i?"#a00":"#300",x.fillRect(0,0,1,1),n=x.getImageData(0,0,1,1).data[0]!==i?170:51)}catch(t){}x.restore(),b[e]=n}),tr.release(x)),this.process=function(s,d,f,p,g){var m=d.canvas,_="normal"===s;if(_||b[s])f.save(),f.setTransform(1,0,0,1,0,0),f.globalAlpha=p,_||(f.globalCompositeOperation=s),f.drawImage(m,g.x,g.y),f.restore();else{var v=y[s];if(!v)return;for(var x=f.getImageData(g.x,g.y,m.width,m.height),w=x.data,k=d.getImageData(0,0,m.width,m.height).data,C=0,S=w.length;C<S;C+=4){t=k[C],r=w[C],e=k[C+1],a=w[C+1],i=k[C+2],o=w[C+2],n=k[C+3],h=w[C+3],v();var I=n*p/255,E=1-I;w[C]=I*l+E*r,w[C+1]=I*u+E*a,w[C+2]=I*c+E*o,w[C+3]=n*p+E*h}f.putImageData(x,g.x,g.y)}}},ta=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",i="http://www.w3.org/1999/xlink",n={href:i,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function s(t,e,i){for(var r in e){var s=e[r],a=n[r];"number"==typeof s&&i&&(s=i.number(s)),a?t.setAttributeNS(a,r,s):t.setAttribute(r,s)}return t}return{svg:t,xmlns:e,xlink:i,create:function(e,i,n){return s(r.createElementNS(t,e),i,n)},get:function(t,e){var i=n[e],r=i?t.getAttributeNS(i,e):t.getAttribute(e);return"null"===r?null:r},set:s}},to=s.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof R||t instanceof I||t instanceof V)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,e){var i=s.capitalize(e),n=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:n,fromSVG:n&&s.each(n,function(t,e){this[t]=e},{}),exportFilter:t[3],get:"get"+i,set:"set"+i}},{});new function(){function t(t,e,i){var n,a=new s,o=t.getTranslation();if(e&&(t.isInvertible()?(n=(t=t._shiftless())._inverseTransform(o),o=null):n=new p,a[i?"cx":"x"]=n.x,a[i?"cy":"y"]=n.y),!t.isIdentity()){var h=t.decompose();if(h){var l=[],u=h.rotation,c=h.scaling,f=h.skewing;o&&!o.isZero()&&l.push("translate("+r.point(o)+")"),u&&l.push("rotate("+r.number(u)+")"),d.isZero(c.x-1)&&d.isZero(c.y-1)||l.push("scale("+r.point(c)+")"),f.x&&l.push("skewX("+r.number(f.x)+")"),f.y&&l.push("skewY("+r.number(f.y)+")"),a.transform=l.join(" ")}else a.transform="matrix("+t.getValues().join(",")+")"}return a}function i(e,i){for(var n=t(e._matrix),s=e._children,a=ta.create("g",n,r),o=0,h=s.length;o<h;o++){var u=s[o],c=g(u,i);if(c){if(u.isClipMask()){var d=ta.create("clipPath");d.appendChild(c),l(u,d,"clip"),ta.set(a,{"clip-path":"url(#"+d.id+")"})}else a.appendChild(c)}}return a}function n(e){var i=e._type,n=e._radius,s=t(e._matrix,!0,"rectangle"!==i);if("rectangle"===i){i="rect";var a=e._size,o=a.width,h=a.height;s.x-=o/2,s.y-=h/2,s.width=o,s.height=h,n.isZero()&&(n=null)}return n&&("circle"===i?s.r=n:(s.rx=n.width,s.ry=n.height)),ta.create(i,s,r)}var r,a,o={Group:i,Layer:i,Raster:function(e,i){var n=t(e._matrix,!0),s=e.getSize(),a=e.getImage();return n.x-=s.width/2,n.y-=s.height/2,n.width=s.width,n.height=s.height,n.href=!1==i.embedImages&&a&&a.src||e.toDataURL(),ta.create("image",n,r)},Path:function(e,i){var s=i.matchShapes;if(s){var a=e.toShape(!1);if(a)return n(a,i)}var o,h=e._segments,l=h.length,u=t(e._matrix);if(s&&l>=2&&!e.hasHandles()){if(l>2){o=e._closed?"polygon":"polyline";for(var c=[],d=0;d<l;d++)c.push(r.point(h[d]._point));u.points=c.join(" ")}else{o="line";var f=h[0]._point,p=h[1]._point;u.set({x1:f.x,y1:f.y,x2:p.x,y2:p.y})}}else o="path",u.d=e.getPathData(null,i.precision);return ta.create(o,u,r)},Shape:n,CompoundPath:function(e,i){var n=t(e._matrix),s=e.getPathData(null,i.precision);return s&&(n.d=s),ta.create("path",n,r)},SymbolItem:function(e,i){var n=t(e._matrix,!0),s=e._definition,a=h(s,"symbol"),o=s._item,u=o.getStrokeBounds();return a||((a=ta.create("symbol",{viewBox:r.rectangle(u)})).appendChild(g(o,i)),l(s,a,"symbol")),n.href="#"+a.id,n.x+=u.x,n.y+=u.y,n.width=u.width,n.height=u.height,n.overflow="visible",ta.create("use",n,r)},PointText:function(e){var i=ta.create("text",t(e._matrix,!0),r);return i.textContent=e._content,i}};function h(t,e){return a||(a={ids:{},svgs:{}}),t&&a.svgs[e+"-"+(t._id||t.__id||(t.__id=f.get("svg")))]}function l(t,e,i){a||h();var n=a.ids[i]=(a.ids[i]||0)+1;e.id=i+"-"+n,a.svgs[i+"-"+(t._id||t.__id)]=e}function u(t,i){var n=t,r=null;if(a){for(var s in n="svg"===t.nodeName.toLowerCase()&&t,a.svgs)r||(n||(n=ta.create("svg")).appendChild(t),r=n.insertBefore(ta.create("defs"),n.firstChild)),r.appendChild(a.svgs[s]);a=null}return i.asString?new e.XMLSerializer().serializeToString(n):n}function g(t,e,i){var n,a,u,c,d=o[t._class],f=d&&d(t,e);if(f){var p=e.onExport;p&&(f=p(t,f,e)||f);var g=JSON.stringify(t._data);g&&"{}"!==g&&"null"!==g&&f.setAttribute("data-paper-data",g)}return f&&(n=f,a={},u=!i&&t.getParent(),c=[],null!=t._name&&(a.id=t._name),s.each(to,function(e){var i=e.get,n=e.type,o=t[i]();if(e.exportFilter?e.exportFilter(t,o):!u||!s.equals(u[i](),o)){if("color"===n&&null!=o){var d=o.getAlpha();d<1&&(a[e.attribute+"-opacity"]=d)}"style"===n?c.push(e.attribute+": "+o):a[e.attribute]=null==o?"none":"color"===n?o.gradient?function(t){var e=h(t,"color");if(!e){var i,n=t.getGradient(),s=n._radial,a=t.getOrigin(),o=t.getDestination();if(s){i={cx:a.x,cy:a.y,r:a.getDistance(o)};var u=t.getHighlight();u&&(i.fx=u.x,i.fy=u.y)}else i={x1:a.x,y1:a.y,x2:o.x,y2:o.y};i.gradientUnits="userSpaceOnUse",e=ta.create((s?"radial":"linear")+"Gradient",i,r);for(var c=n._stops,d=0,f=c.length;d<f;d++){var p=c[d],g=p._color,m=g.getAlpha(),_=p._offset;i={offset:null==_?d/(f-1):_},g&&(i["stop-color"]=g.toCSS(!0)),m<1&&(i["stop-opacity"]=m),e.appendChild(ta.create("stop",i,r))}l(t,e,"color")}return"url(#"+e.id+")"}(o,t):o.toCSS(!0):"array"===n?o.join(","):"lookup"===n?e.toSVG[o]:o}}),c.length&&(a.style=c.join(";")),1===a.opacity&&delete a.opacity,t._visible||(a.visibility="hidden"),ta.set(n,a,r))}function m(t){return t||(t={}),r=new c(t.precision),t}k.inject({exportSVG:function(t){return u(g(this,t=m(t),!0),t)}}),w.inject({exportSVG:function(e){e=m(e);var i=this._children,n=this.getView(),a=s.pick(e.bounds,"view"),o=e.matrix||"view"===a&&n._matrix,h=o&&b.read([o]),l="view"===a?new v([0,0],n.getViewSize()):"content"===a?k._getBounds(i,h,{stroke:!0}).rect:v.read([a],0,{readNull:!0}),c={version:"1.1",xmlns:ta.svg,"xmlns:xlink":ta.xlink};l&&(c.width=l.width,c.height=l.height,(l.x||0===l.x||l.y||0===l.y)&&(c.viewBox=r.rectangle(l)));var d=ta.create("svg",c,r),f=d;h&&!h.isIdentity()&&(f=d.appendChild(ta.create("g",t(h),r)));for(var p=0,_=i.length;p<_;p++)f.appendChild(g(i[p],e,!0));return u(d,e)}})},new function(){var t,a={};function o(e,i,n,r,s,a){var o=ta.get(e,i)||a,h=null==o?r?null:n?"":0:n?o:parseFloat(o);return/%\s*$/.test(o)?h/100*(s?1:t[/x|^width/.test(i)?"width":"height"]):h}function h(t,e,i,n,r,s,a){return e=o(t,e||"x",!1,n,r,s),i=o(t,i||"y",!1,n,r,a),n&&(null==e||null==i)?null:new p(e,i)}function l(t,e,i,n,r){return e=o(t,e||"width",!1,n,r),i=o(t,i||"height",!1,n,r),n&&(null==e||null==i)?null:new m(e,i)}function u(t,e,i){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?P(t)||t:"lookup"===e?i[t]:t}function c(t,e,i,n){var r=t.childNodes,s="clippath"===e,a="defs"===e,o=new C,h=o._project,l=h._currentStyle,u=[];if(s||a||(o=T(o,t,n),h._currentStyle=o._style.clone()),n)for(var c=t.querySelectorAll("defs"),d=0,f=c.length;d<f;d++)M(c[d],i,!1);for(var d=0,f=r.length;d<f;d++){var p,g=r[d];!(1===g.nodeType&&!/^defs$/i.test(g.nodeName)&&(p=M(g,i,!1)))||p instanceof A||u.push(p)}return o.addChildren(u),s&&(o=T(o.reduce(),t,n)),h._currentStyle=l,(s||a)&&(o.remove(),o=null),o}function d(t,e){for(var i=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),n=[],r=0,s=i.length;r<s;r+=2)n.push(new p(parseFloat(i[r]),parseFloat(i[r+1])));var a=new z(n);return"polygon"===e&&a.closePath(),a}function f(t,e){var i,n=(o(t,"href",!0)||"").substring(1),r="radialgradient"===e;if(n)(i=a[n].getGradient())._radial^r&&((i=i.clone())._radial=r);else{for(var s=t.childNodes,l=[],u=0,c=s.length;u<c;u++){var d=s[u];1===d.nodeType&&l.push(T(new $,d))}i=new q(l,r)}var f,p,g,m="userSpaceOnUse"!==o(t,"gradientUnits",!0);return r?(p=(f=h(t,"cx","cy",!1,m,"50%","50%")).add(o(t,"r",!1,!1,m,"50%"),0),g=h(t,"fx","fy",!0,m)):(f=h(t,"x1","y1",!1,m,"0%","0%"),p=h(t,"x2","y2",!1,m,"100%","0%")),T(new U(i,f,p,g),t)._scaleToBounds=m,null}var g={"#document":function(t,e,i,n){for(var r=t.childNodes,s=0,a=r.length;s<a;s++){var o=r[s];if(1===o.nodeType)return M(o,i,n)}},g:c,svg:c,clippath:c,polygon:d,polyline:d,path:function(t){return R.create(t.getAttribute("d"))},lineargradient:f,radialgradient:f,image:function(t){var e=new E(o(t,"href",!0));return e.on("load",function(){var e=l(t);this.setSize(e);var i=h(t).add(e.divide(2));this._matrix.append(new b().translate(i))}),e},symbol:function(t,e,i,n){return new A(c(t,e,i,n),!0)},defs:c,use:function(t){var e=a[(o(t,"href",!0)||"").substring(1)],i=h(t);return e?e instanceof A?e.place(i):e.clone().translate(i):null},circle:function(t){return new I.Circle(h(t,"cx","cy"),o(t,"r"))},ellipse:function(t){return new I.Ellipse({center:h(t,"cx","cy"),radius:l(t,"rx","ry")})},rect:function(t){return new I.Rectangle(new v(h(t),l(t)),l(t,"rx","ry"))},line:function(t){return new z.Line(h(t,"x1","y1"),h(t,"x2","y2"))},text:function(t){var e=new F(h(t).add(h(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:c};function _(t,e,i,n){if(t.transform){for(var r=(n.getAttribute(i)||"").split(/\)\s*/g),s=new b,a=0,o=r.length;a<o;a++){var h=r[a];if(!h)break;for(var l=h.split(/\(\s*/),u=l[0],c=l[1].split(/[\s,]+/g),d=0,f=c.length;d<f;d++)c[d]=parseFloat(c[d]);switch(u){case"matrix":s.append(new b(c[0],c[1],c[2],c[3],c[4],c[5]));break;case"rotate":s.rotate(c[0],c[1]||0,c[2]||0);break;case"translate":s.translate(c[0],c[1]||0);break;case"scale":s.scale(c);break;case"skewX":s.skew(c[0],0);break;case"skewY":s.skew(0,c[0])}}t.transform(s)}}function y(t,e,i){var n="fill-opacity"===i?"getFillColor":"getStrokeColor",r=t[n]&&t[n]();r&&r.setAlpha(parseFloat(e))}var x=s.set(s.each(to,function(t){this[t.attribute]=function(e,i){if(e[t.set]&&(e[t.set](u(i,t.type,t.fromSVG)),"color"===t.type)){var n=e[t.get]();if(n&&n._scaleToBounds){var r=e.getBounds();n.transform(new b().translate(r.getPoint()).scale(r.getSize()))}}}},{}),{id:function(t,e){a[e]=t,t.setName&&t.setName(e)},"clip-path":function(t,e){var i=P(e);if(i){if((i=i.clone()).setClipMask(!0),!(t instanceof C))return new C(i,t);t.insertChild(0,i)}},gradientTransform:_,transform:_,"fill-opacity":y,"stroke-opacity":y,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var i=e.match(/(.*)%$/);t.setOffset(i?i[1]/100:parseFloat(e))}},viewBox:function(t,e,i,n,r){var s,a,o=new v(u(e,"array")),h=l(n,null,null,!0);if(t instanceof C){var c=h?h.divide(o.getSize()):1,a=new b().scale(c).translate(o.getPoint().negate());s=t}else t instanceof A&&(h&&o.setSize(h),s=t._item);if(s){if("visible"!==S(n,"overflow",r)){var d=new I.Rectangle(o);d.setClipMask(!0),s.addChild(d)}a&&s.transform(a)}}});function S(t,e,n){var r=t.attributes[e],a=r&&r.value;if(!a&&t.style){var o=s.camelize(e);(a=t.style[o])||n.node[o]===n.parent[o]||(a=n.node[o])}return a?"none"===a?null:a:i}function T(t,e,n){var r=e.parentNode,a={node:H.getStyles(e)||{},parent:!n&&!/^defs$/i.test(r.tagName)&&H.getStyles(r)||{}};return s.each(x,function(n,r){var s=S(e,r,a);t=s!==i&&n(t,s,r,e,a)||t}),t}function P(t){var e=t&&t.match(/\((?:["'#]*)([^"')]+)/),i=e&&e[1],r=i&&a[n?i.replace(n.location.href.split("#")[0]+"#",""):i];return r&&r._scaleToBounds&&((r=r.clone())._scaleToBounds=!0),r}function M(e,i,n){var o,h,u,c=e.nodeName.toLowerCase(),d="#document"!==c,f=r.body;n&&d&&(t=th.getView().getSize(),t=l(e,null,null,!0)||t,o=ta.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),h=e.parentNode,u=e.nextSibling,o.appendChild(e),f.appendChild(o));var p=th.settings,m=p.applyMatrix,_=p.insertItems;p.applyMatrix=!1,p.insertItems=!1;var v=g[c],y=v&&v(e,c,i,n)||null;if(p.insertItems=_,p.applyMatrix=m,y){!d||y instanceof C||(y=T(y,e,n));var b=i.onImport,x=d&&e.getAttribute("data-paper-data");b&&(y=b(e,y,i)||y),i.expandShapes&&y instanceof I&&(y.remove(),y=y.toPath()),x&&(y._data=JSON.parse(x))}return o&&(f.removeChild(o),h&&(u?h.insertBefore(e,u):h.appendChild(e))),n&&(a={},y&&s.pick(i.applyMatrix,m)&&y.matrix.apply(!0,!0)),y}function O(t,n,s){if(!t)return null;n="function"==typeof n?{onLoad:n}:n||{};var a=th,o=null;function h(r){try{var h="object"==typeof r?r:new e.DOMParser().parseFromString(r.trim(),"image/svg+xml");if(!h.nodeName)throw h=null,Error("Unsupported SVG source: "+t);th=a,o=M(h,n,!0),n&&!1===n.insert||s._insertItem(i,o);var u=n.onLoad;u&&u(o,r)}catch(t){l(t)}}function l(t,e){var i=n.onError;if(i)i(t,e);else throw Error(t)}if("string"!=typeof t||/^[\s\S]*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var u=new FileReader;return u.onload=function(){h(u.result)},u.onerror=function(){l(u.error)},u.readAsText(t)}h(t)}else{var c=r.getElementById(t);c?h(c):tn.request({url:t,async:!0,onLoad:h,onError:l})}return o}k.inject({importSVG:function(t,e){return O(t,e,this)}}),w.inject({importSVG:function(t,e){return this.activate(),O(t,e,this)}})},s.exports.PaperScript=(function(){var t,i,a=this,h=a.acorn;if(!h)try{h=u("7bbl5")}catch(t){}function l(t,e){return(a.acorn||h).parse(t,e)}!h&&(h=i={},t=function(t){t.version="0.5.0",t.parse=function(t,r){return n=(i=String(t)).length,k(r),tH(),function(t){g=m=s,e.locations&&(_=new tZ),v=b=null,y=[],tY();var i=t||t8(),n=!0;for(t||(i.body=[]);u!==M;){var r=eu();i.body.push(r),n&&ee(r)&&t6(!0),n=!1}return et(i,"Program")}(e.program)};var e,i,n,r,s,a,o,h,l,u,c,d,f,p,g,m,_,v,y,b,x,w=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function k(t){for(var i in e=t||{},w)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=w[i]);r=e.sourceFile||null}var C=t.getLineInfo=function(t,e){for(var i=1,n=0;;){tU.lastIndex=n;var r=tU.exec(t);if(r&&r.index<e)++i,n=r.index+r[0].length;else break}return{line:i,column:e-n}};function S(t,e){var n=C(i,t),r=SyntaxError(e+=" ("+n.line+":"+n.column+")");throw r.pos=t,r.loc=n,r.raisedAt=s,r}t.tokenize=function(t,r){n=(i=String(t)).length,k(r),tH();var g={};function _(t){return m=o,tY(t),g.start=a,g.end=o,g.startLoc=h,g.endLoc=l,g.type=u,g.value=c,g}return _.jumpTo=function(t,n){if(s=t,e.locations){var r;for(f=1,p=tU.lastIndex=0;(r=tU.exec(i))&&r.index<t;)++f,p=r.index+r[0].length}d=n,tK()},_};var I=[],E={type:"num"},T={type:"regexp"},A={type:"string"},P={type:"name"},M={type:"eof"},O={keyword:"break"},L={keyword:"case",beforeExpr:!0},N={keyword:"catch"},R={keyword:"continue"},z={keyword:"debugger"},D={keyword:"default"},B={keyword:"do",isLoop:!0},j={keyword:"else",beforeExpr:!0},V={keyword:"finally"},F={keyword:"for",isLoop:!0},U={keyword:"function"},q={keyword:"if"},$={keyword:"return",beforeExpr:!0},Z={keyword:"switch"},H={keyword:"throw",beforeExpr:!0},G={keyword:"try"},W={keyword:"var"},K={keyword:"while",isLoop:!0},Y={keyword:"with"},Q={keyword:"new",beforeExpr:!0},X={keyword:"this"},J={keyword:"null",atomValue:null},tt={keyword:"true",atomValue:!0},te={keyword:"false",atomValue:!1},ti={keyword:"in",binop:7,beforeExpr:!0},tn={break:O,case:L,catch:N,continue:R,debugger:z,default:D,do:B,else:j,finally:V,for:F,function:U,if:q,return:$,switch:Z,throw:H,try:G,var:W,while:K,with:Y,null:J,true:tt,false:te,new:Q,in:ti,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:X,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},tr={type:"[",beforeExpr:!0},ts={type:"]"},ta={type:"{",beforeExpr:!0},to={type:"}"},th={type:"(",beforeExpr:!0},tl={type:")"},tu={type:",",beforeExpr:!0},tc={type:";",beforeExpr:!0},td={type:":",beforeExpr:!0},tf={type:"."},tp={type:"?",beforeExpr:!0},tg={binop:10,beforeExpr:!0},tm={isAssign:!0,beforeExpr:!0},t_={isAssign:!0,beforeExpr:!0},tv={postfix:!0,prefix:!0,isUpdate:!0},ty={prefix:!0,beforeExpr:!0},tb={binop:1,beforeExpr:!0},tx={binop:2,beforeExpr:!0},tw={binop:3,beforeExpr:!0},tk={binop:4,beforeExpr:!0},tC={binop:5,beforeExpr:!0},tS={binop:6,beforeExpr:!0},tI={binop:7,beforeExpr:!0},tE={binop:8,beforeExpr:!0},tT={binop:9,prefix:!0,beforeExpr:!0},tA={binop:10,beforeExpr:!0};for(var tP in t.tokTypes={bracketL:tr,bracketR:ts,braceL:ta,braceR:to,parenL:th,parenR:tl,comma:tu,semi:tc,colon:td,dot:tf,question:tp,slash:tg,eq:tm,name:P,eof:M,num:E,regexp:T,string:A},tn)t.tokTypes["_"+tP]=tn[tP];function tM(t){t=t.split(" ");var e="",i=[];t:for(var n=0;n<t.length;++n){for(var r=0;r<i.length;++r)if(i[r][0].length==t[n].length){i[r].push(t[n]);continue t}i.push([t[n]])}function s(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var i=0;i<t.length;++i)e+="case "+JSON.stringify(t[i])+":";e+="return true}return false;"}if(i.length>3){i.sort(function(t,e){return e.length-t.length}),e+="switch(str.length){";for(var n=0;n<i.length;++n){var a=i[n];e+="case "+a[0].length+":",s(a)}e+="}"}else s(t);return Function("str",e)}var tO=tM("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),tL=tM("class enum extends super const export import"),tN=tM("implements interface let package private protected public static yield"),tR=tM("eval arguments"),tz=tM("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),tD=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,tB="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",tj=RegExp("["+tB+"]"),tV=RegExp("["+tB+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),tF=/[\n\r\u2028\u2029]/,tU=/\r\n|[\n\r\u2028\u2029]/g,tq=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&tj.test(String.fromCharCode(t)))},t$=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&tV.test(String.fromCharCode(t))))};function tZ(){this.line=f,this.column=s-p}function tH(){f=1,s=p=0,d=!0,tK()}function tG(t,i){o=s,e.locations&&(l=new tZ),u=t,tK(),c=i,d=t.beforeExpr}function tW(){for(var t=s,r=e.onComment&&e.locations&&new tZ,a=i.charCodeAt(s+=2);s<n&&10!==a&&13!==a&&8232!==a&&8233!==a;)++s,a=i.charCodeAt(s);e.onComment&&e.onComment(!1,i.slice(t+2,s),t,s,r,e.locations&&new tZ)}function tK(){for(;s<n;){var t=i.charCodeAt(s);if(32===t)++s;else if(13===t){++s;var r=i.charCodeAt(s);10===r&&++s,e.locations&&(++f,p=s)}else if(10===t||8232===t||8233===t)++s,e.locations&&(++f,p=s);else if(t>8&&t<14)++s;else if(47===t){var r=i.charCodeAt(s+1);if(42===r)!function(){var t,n=e.onComment&&e.locations&&new tZ,r=s,a=i.indexOf("*/",s+=2);if(-1===a&&S(s-2,"Unterminated comment"),s=a+2,e.locations)for(tU.lastIndex=r;(t=tU.exec(i))&&t.index<s;)++f,p=t.index+t[0].length;e.onComment&&e.onComment(!0,i.slice(r+2,a),r,s,n,e.locations&&new tZ)}();else if(47===r)tW();else break}else if(160===t)++s;else if(t>=5760&&tD.test(String.fromCharCode(t)))++s;else break}}function tY(t){if(t?s=a+1:a=s,e.locations&&(h=new tZ),t)return tX();if(s>=n)return tG(M);var r=i.charCodeAt(s);if(tq(r)||92===r)return t5();var o=function(t){switch(t){case 46:return(u=i.charCodeAt(s+1))>=48&&u<=57?t0(!0):(++s,tG(tf));case 40:return++s,tG(th);case 41:return++s,tG(tl);case 59:return++s,tG(tc);case 44:return++s,tG(tu);case 91:return++s,tG(tr);case 93:return++s,tG(ts);case 123:return++s,tG(ta);case 125:return++s,tG(to);case 58:return++s,tG(td);case 63:return++s,tG(tp);case 48:var r,o,h,l,u,c,g,_=i.charCodeAt(s+1);if(120===_||88===_)return s+=2,null==(l=tJ(16))&&S(a+2,"Expected hexadecimal number"),tq(i.charCodeAt(s))&&S(s,"Identifier directly after number"),tG(E,l);case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return t0(!1);case 34:case 39:return function(t){s++;for(var r="";;){s>=n&&S(a,"Unterminated string constant");var o=i.charCodeAt(s);if(o===t)return++s,tG(A,r);if(92===o){o=i.charCodeAt(++s);var h=/^[0-7]+/.exec(i.slice(s,s+3));for(h&&(h=h[0]);h&&parseInt(h,8)>255;)h=h.slice(0,-1);if("0"===h&&(h=null),++s,h)b&&S(s-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(h,8)),s+=h.length-1;else switch(o){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(t1(2));break;case 117:r+=String.fromCharCode(t1(4));break;case 85:r+=String.fromCharCode(t1(8));break;case 116:r+="	";break;case 98:r+="\b";break;case 118:r+="\v";break;case 102:r+="\f";break;case 48:r+="\x00";break;case 13:10===i.charCodeAt(s)&&++s;case 10:e.locations&&(p=s,++f);break;default:r+=String.fromCharCode(o)}}else(13===o||10===o||8232===o||8233===o)&&S(a,"Unterminated string constant"),r+=String.fromCharCode(o),++s}}(t);case 47:return c=i.charCodeAt(s+1),d?(++s,tX()):61===c?tQ(t_,2):tQ(tg,1);case 37:case 42:return 61===i.charCodeAt(s+1)?tQ(t_,2):tQ(tA,1);case 124:case 38:return(g=i.charCodeAt(s+1))===t?tQ(124===t?tb:tx,2):61===g?tQ(t_,2):tQ(124===t?tw:tC,1);case 94:return 61===i.charCodeAt(s+1)?tQ(t_,2):tQ(tk,1);case 43:case 45:return(r=i.charCodeAt(s+1))===t?45==r&&62==i.charCodeAt(s+2)&&tF.test(i.slice(m,s))?(s+=3,tW(),tK(),tY()):tQ(tv,2):61===r?tQ(t_,2):tQ(tT,1);case 60:case 62:return o=i.charCodeAt(s+1),h=1,o===t?(h=62===t&&62===i.charCodeAt(s+2)?3:2,61===i.charCodeAt(s+h))?tQ(t_,h+1):tQ(tE,h):33==o&&60==t&&45==i.charCodeAt(s+2)&&45==i.charCodeAt(s+3)?(s+=4,tW(),tK(),tY()):(61===o&&(h=61===i.charCodeAt(s+2)?3:2),tQ(tI,h));case 61:case 33:return 61===i.charCodeAt(s+1)?tQ(tS,61===i.charCodeAt(s+2)?3:2):tQ(61===t?tm:ty,1);case 126:return tQ(ty,1)}return!1}(r);if(!1===o){var l=String.fromCharCode(r);if("\\"===l||tj.test(l))return t5();S(s,"Unexpected character '"+l+"'")}return o}function tQ(t,e){var n=i.slice(s,s+e);s+=e,tG(t,n)}function tX(){for(var t,e,r="",a=s;;){s>=n&&S(a,"Unterminated regular expression");var o=i.charAt(s);if(tF.test(o)&&S(a,"Unterminated regular expression"),t)t=!1;else{if("["===o)e=!0;else if("]"===o&&e)e=!1;else if("/"===o&&!e)break;t="\\"===o}++s}var r=i.slice(a,s);++s;var h=t2();h&&!/^[gmsiy]*$/.test(h)&&S(a,"Invalid regexp flag");try{var l=new RegExp(r,h)}catch(t){t instanceof SyntaxError&&S(a,t.message),S(t)}return tG(T,l)}function tJ(t,e){for(var n=s,r=0,a=0,o=null==e?1/0:e;a<o;++a){var h,l=i.charCodeAt(s);if((h=l>=97?l-97+10:l>=65?l-65+10:l>=48&&l<=57?l-48:1/0)>=t)break;++s,r=r*t+h}return s===n||null!=e&&s-n!==e?null:r}function t0(t){var e=s,n=!1,r=48===i.charCodeAt(s);t||null!==tJ(10)||S(e,"Invalid number"),46===i.charCodeAt(s)&&(++s,tJ(10),n=!0);var a=i.charCodeAt(s);(69===a||101===a)&&((43===(a=i.charCodeAt(++s))||45===a)&&++s,null===tJ(10)&&S(e,"Invalid number"),n=!0),tq(i.charCodeAt(s))&&S(s,"Identifier directly after number");var o,h=i.slice(e,s);return n?o=parseFloat(h):r&&1!==h.length?/[89]/.test(h)||b?S(e,"Invalid number"):o=parseInt(h,8):o=parseInt(h,10),tG(E,o)}function t1(t){var e=tJ(16,t);return null===e&&S(a,"Bad character escape sequence"),e}function t2(){x=!1;for(var t,e=!0,n=s;;){var r=i.charCodeAt(s);if(t$(r))x&&(t+=i.charAt(s)),++s;else if(92===r){x||(t=i.slice(n,s)),x=!0,117!=i.charCodeAt(++s)&&S(s,"Expecting Unicode escape sequence \\uXXXX"),++s;var a=t1(4),o=String.fromCharCode(a);o||S(s-1,"Invalid Unicode escape"),(e?tq(a):t$(a))||S(s-4,"Invalid Unicode escape"),t+=o}else break;e=!1}return x?t:i.slice(n,s)}function t5(){var t=t2(),e=P;return!x&&tz(t)&&(e=tn[t]),tG(e,t)}function t3(){g=a,m=o,_=l,tY()}function t6(t){if(b=t,s=a,e.locations)for(;s<p;)p=i.lastIndexOf("\n",p-2)+1,--f;tK(),tY()}function t4(){this.type=null,this.start=a,this.end=null}function t9(){this.start=h,this.end=null,null!==r&&(this.source=r)}function t8(){var t=new t4;return e.locations&&(t.loc=new t9),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[a,0]),t}function t7(t){var i=new t4;return i.start=t.start,e.locations&&(i.loc=new t9,i.loc.start=t.loc.start),e.ranges&&(i.range=[t.range[0],0]),i}function et(t,i){return t.type=i,t.end=m,e.locations&&(t.loc.end=_),e.ranges&&(t.range[1]=m),t}function ee(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function ei(t){if(u===t)return t3(),!0}function en(){return!e.strictSemicolons&&(u===M||u===to||tF.test(i.slice(m,a)))}function er(){ei(tc)||en()||ea()}function es(t){u===t?t3():ea()}function ea(){S(a,"Unexpected token")}function eo(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&S(t.start,"Assigning to rvalue"),b&&"Identifier"===t.type&&tR(t.name)&&S(t.start,"Assigning to "+t.name+" in strict mode")}var eh={kind:"loop"},el={kind:"switch"};function eu(){(u===tg||u===t_&&"/="==c)&&tY(!0);var t,n,r=u,s=t8();switch(r){case O:case R:t3();var o=r===O;ei(tc)||en()?s.label=null:u!==P?ea():(s.label=eC(),er());for(var h=0;h<y.length;++h){var l=y[h];if((null==s.label||l.name===s.label.name)&&(null!=l.kind&&(o||"loop"===l.kind)||s.label&&o))break}return h===y.length&&S(s.start,"Unsyntactic "+r.keyword),et(s,o?"BreakStatement":"ContinueStatement");case z:return t3(),er(),et(s,"DebuggerStatement");case B:return t3(),y.push(eh),s.body=eu(),y.pop(),es(K),s.test=ec(),er(),et(s,"DoWhileStatement");case F:if(t3(),y.push(eh),es(th),u===tc)return ef(s,null);if(u===W){var d=t8();if(t3(),eg(d,!0),et(d,"VariableDeclaration"),1===d.declarations.length&&ei(ti))return ep(s,d);return ef(s,d)}var d=em(!1,!0);if(ei(ti))return eo(d),ep(s,d);return ef(s,d);case U:return t3(),ew(s,!0);case q:return t3(),s.test=ec(),s.consequent=eu(),s.alternate=ei(j)?eu():null,et(s,"IfStatement");case $:return v||e.allowReturnOutsideFunction||S(a,"'return' outside of function"),t3(),ei(tc)||en()?s.argument=null:(s.argument=em(),er()),et(s,"ReturnStatement");case Z:for(t3(),s.discriminant=ec(),s.cases=[],es(ta),y.push(el);u!=to;)if(u===L||u===D){var f=u===L;t&&et(t,"SwitchCase"),s.cases.push(t=t8()),t.consequent=[],t3(),f?t.test=em():(n&&S(g,"Multiple default clauses"),n=!0,t.test=null),es(td)}else t||ea(),t.consequent.push(eu());return t&&et(t,"SwitchCase"),t3(),y.pop(),et(s,"SwitchStatement");case H:return t3(),tF.test(i.slice(m,a))&&S(m,"Illegal newline after throw"),s.argument=em(),er(),et(s,"ThrowStatement");case G:if(t3(),s.block=ed(),s.handler=null,u===N){var p=t8();t3(),es(th),p.param=eC(),b&&tR(p.param.name)&&S(p.param.start,"Binding "+p.param.name+" in strict mode"),es(tl),p.guard=null,p.body=ed(),s.handler=et(p,"CatchClause")}return s.guardedHandlers=I,s.finalizer=ei(V)?ed():null,s.handler||s.finalizer||S(s.start,"Missing catch or finally clause"),et(s,"TryStatement");case W:return t3(),eg(s),er(),et(s,"VariableDeclaration");case K:return t3(),s.test=ec(),y.push(eh),s.body=eu(),y.pop(),et(s,"WhileStatement");case Y:return b&&S(a,"'with' in strict mode"),t3(),s.object=ec(),s.body=eu(),et(s,"WithStatement");case ta:return ed();case tc:return t3(),et(s,"EmptyStatement");default:var _=c,x=em();if(!(r===P&&"Identifier"===x.type&&ei(td)))return s.expression=x,er(),et(s,"ExpressionStatement");for(var h=0;h<y.length;++h)y[h].name===_&&S(x.start,"Label '"+_+"' is already declared");var w=u.isLoop?"loop":u===Z?"switch":null;return y.push({name:_,kind:w}),s.body=eu(),y.pop(),s.label=x,et(s,"LabeledStatement")}}function ec(){es(th);var t=em();return es(tl),t}function ed(t){var e,i=t8(),n=!0,r=!1;for(i.body=[],es(ta);!ei(to);){var s=eu();i.body.push(s),n&&t&&ee(s)&&(e=r,t6(r=!0)),n=!1}return r&&!e&&t6(!1),et(i,"BlockStatement")}function ef(t,e){return t.init=e,es(tc),t.test=u===tc?null:em(),es(tc),t.update=u===tl?null:em(),es(tl),t.body=eu(),y.pop(),et(t,"ForStatement")}function ep(t,e){return t.left=e,t.right=em(),es(tl),t.body=eu(),y.pop(),et(t,"ForInStatement")}function eg(t,e){for(t.declarations=[],t.kind="var";;){var i=t8();if(i.id=eC(),b&&tR(i.id.name)&&S(i.id.start,"Binding "+i.id.name+" in strict mode"),i.init=ei(tm)?em(!0,e):null,t.declarations.push(et(i,"VariableDeclarator")),!ei(tu))break}return t}function em(t,e){var i=e_(e);if(!t&&u===tu){var n=t7(i);for(n.expressions=[i];ei(tu);)n.expressions.push(e_(e));return et(n,"SequenceExpression")}return i}function e_(t){var e=function(t){var e=function t(e,i,n){var r=u.binop;if(null!=r&&(!n||u!==ti)&&r>i){var s=t7(e);s.left=e,s.operator=c;var a=u;return t3(),s.right=t(ev(),r,n),t(et(s,a===tb||a===tx?"LogicalExpression":"BinaryExpression"),i,n)}return e}(ev(),-1,t);if(ei(tp)){var i=t7(e);return i.test=e,i.consequent=em(!0),es(td),i.alternate=em(!0,t),et(i,"ConditionalExpression")}return e}(t);if(u.isAssign){var i=t7(e);return i.operator=c,i.left=e,t3(),i.right=e_(t),eo(e),et(i,"AssignmentExpression")}return e}function ev(){if(u.prefix){var t=t8(),e=u.isUpdate;return t.operator=c,t.prefix=!0,d=!0,t3(),t.argument=ev(),e?eo(t.argument):b&&"delete"===t.operator&&"Identifier"===t.argument.type&&S(t.start,"Deleting local variable in strict mode"),et(t,e?"UpdateExpression":"UnaryExpression")}for(var i=ey(eb());u.postfix&&!en();){var t=t7(i);t.operator=c,t.prefix=!1,t.argument=i,eo(i),t3(),i=et(t,"UpdateExpression")}return i}function ey(t,e){if(ei(tf)){var i=t7(t);return i.object=t,i.property=eC(!0),i.computed=!1,ey(et(i,"MemberExpression"),e)}if(ei(tr)){var i=t7(t);return i.object=t,i.property=em(),i.computed=!0,es(ts),ey(et(i,"MemberExpression"),e)}if(!(!e&&ei(th)))return t;var i=t7(t);return i.callee=t,i.arguments=ek(tl,!1),ey(et(i,"CallExpression"),e)}function eb(){switch(u){case X:var t,n=t8();return t3(),et(n,"ThisExpression");case P:return eC();case E:case A:case T:var n=t8();return n.value=c,n.raw=i.slice(a,o),t3(),et(n,"Literal");case J:case tt:case te:var n=t8();return n.value=u.atomValue,n.raw=u.keyword,t3(),et(n,"Literal");case th:var r=h,s=a;t3();var d=em();return d.start=s,d.end=o,e.locations&&(d.loc.start=r,d.loc.end=l),e.ranges&&(d.range=[s,o]),es(tl),d;case tr:var n=t8();return t3(),n.elements=ek(ts,!0,!0),et(n,"ArrayExpression");case ta:return function(){var t=t8(),i=!0,n=!1;for(t.properties=[],t3();!ei(to);){if(i)i=!1;else if(es(tu),e.allowTrailingCommas&&ei(to))break;var r,s={key:ex()},a=!1;if(ei(td)?(s.value=em(!0),r=s.kind="init"):e.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(a=n=!0,r=s.kind=s.key.name,s.key=ex(),u!==th&&ea(),s.value=ew(t8(),!1)):ea(),"Identifier"===s.key.type&&(b||n))for(var o=0;o<t.properties.length;++o){var h=t.properties[o];if(h.key.name===s.key.name){var l=r==h.kind||a&&"init"===h.kind||"init"===r&&("get"===h.kind||"set"===h.kind);l&&!b&&"init"===r&&"init"===h.kind&&(l=!1),l&&S(s.key.start,"Redefinition of property")}}t.properties.push(s)}return et(t,"ObjectExpression")}();case U:var n=t8();return t3(),ew(n,!1);case Q:return t=t8(),t3(),t.callee=ey(eb(),!0),ei(th)?t.arguments=ek(tl,!1):t.arguments=I,et(t,"NewExpression");default:ea()}}function ex(){return u===E||u===A?eb():eC(!0)}function ew(t,e){u===P?t.id=eC():e?ea():t.id=null,t.params=[];var i=!0;for(es(th);!ei(tl);)i?i=!1:es(tu),t.params.push(eC());var n=v,r=y;if(v=!0,y=[],t.body=ed(!0),v=n,y=r,b||t.body.body.length&&ee(t.body.body[0]))for(var s=t.id?-1:0;s<t.params.length;++s){var a=s<0?t.id:t.params[s];if((tN(a.name)||tR(a.name))&&S(a.start,"Defining '"+a.name+"' in strict mode"),s>=0)for(var o=0;o<s;++o)a.name===t.params[o].name&&S(a.start,"Argument name clash in strict mode")}return et(t,e?"FunctionDeclaration":"FunctionExpression")}function ek(t,i,n){for(var r=[],s=!0;!ei(t);){if(s)s=!1;else if(es(tu),i&&e.allowTrailingCommas&&ei(t))break;n&&u===tu?r.push(null):r.push(em(!0))}return r}function eC(t){var n=t8();return t&&"everywhere"==e.forbidReserved&&(t=!1),u===P?(!t&&(e.forbidReserved&&(3===e.ecmaVersion?tO:tL)(c)||b&&tN(c))&&-1==i.slice(a,o).indexOf("\\")&&S(a,"The keyword '"+c+"' is reserved"),n.name=c):t&&u.keyword?n.name=u.keyword:ea(),d=!1,t3(),et(n,"Identifier")}},t(i),h.version||(h=null));var c={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},d={"-":"__negate","+":"__self"},f=s.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(t){this["__"+t]="#"+t},{__self:function(){return this}});function g(t,e,i){var n=c[e];if(t&&t[n]){var r=t[n](i);return"!="===e?!r:r}switch(e){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;case"%":return t%i;case"==":return t==i;case"!=":return t!=i}}function _(t,e){var i=d[t];if(e&&e[i])return e[i]();switch(t){case"+":return+e;case"-":return-e}}function v(t,i){if(!t)return"";var s=[];function a(t){for(var e=0,i=s.length;e<i;e++){var n=s[e];if(n[0]>=t)break;t+=n[1]}return t}function o(e){return t.substring(a(e.range[0]),a(e.range[1]))}function h(e,i){for(var n=a(e.range[0]),r=a(e.range[1]),o=0,h=s.length-1;h>=0;h--)if(n>s[h][0]){o=h+1;break}s.splice(o,0,[n,i.length-r+n]),t=t.substring(0,n)+i+t.substring(r)}var u,f=(i=i||{}).url||"",p=i.sourceMaps,g=i.paperFeatures||{},m=i.source||t,_=i.offset||0,v=th.agent,y=v.versionNumber,b=!1,x=/\r\n|\n|\r/mg;if(p&&(v.chrome&&y>=30||v.webkit&&y>=537.76||v.firefox&&y>=23||v.node)){if(v.node)_-=2;else if(n&&f&&!n.location.href.indexOf(f)){var w=r.getElementsByTagName("html")[0].innerHTML;_=w.substr(0,w.indexOf(t)+1).match(x).length+1}var k=["AA"+function(t){var e="";for(t=(Math.abs(t)<<1)+(t<0?1:0);t||!e;){var i=31&t;(t>>=5)&&(i|=32),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[i]}return e}((b=_>0&&!(v.chrome&&y>=36||v.safari&&y>=600||v.firefox&&y>=40||v.node))?0:_)+"A"];k.length=(t.match(x)||[]).length+1+(b?_:0),u={version:3,file:f,names:[],mappings:k.join(";AACA"),sourceRoot:"",sources:[f],sourcesContent:[m]}}return(!1!==g.operatorOverloading||!1!==g.moduleExports)&&function e(i,n,r){if(i){for(var s in i)if("range"!==s&&"loc"!==s){var l=i[s];if(Array.isArray(l))for(var u=0,f=l.length;u<f;u++)e(l[u],i,r);else l&&"object"==typeof l&&e(l,i,r)}!1!==r.operatorOverloading&&function(e,i){switch(e.type){case"UnaryExpression":if(e.operator in d&&"Literal"!==e.argument.type){var n=o(e.argument);h(e,'$__("'+e.operator+'", '+n+")")}break;case"BinaryExpression":if(e.operator in c&&"Literal"!==e.left.type){var r,s,l=o(e.left),u=o(e.right),f=(r=e.left,s=e.right,t.substring(a(r.range[1]),a(s.range[0]))),p=e.operator;h(e,"__$__("+l+","+f.replace(RegExp("\\"+p),'"'+p+'"')+", "+u+")")}break;case"UpdateExpression":case"AssignmentExpression":var g=i&&i.type;if(!("ForStatement"===g||"BinaryExpression"===g&&/^[=!<>]/.test(i.operator)||"MemberExpression"===g&&i.computed)){if("UpdateExpression"===e.type){var n=o(e.argument),m="__$__("+n+', "'+e.operator[0]+'", 1)',_=n+" = "+m;e.prefix?_="("+_+")":("AssignmentExpression"===g||"VariableDeclarator"===g||"BinaryExpression"===g)&&(o(i.left||i.id)===n&&(_=m),_=n+"; "+_),h(e,_)}else if(/^.=$/.test(e.operator)&&"Literal"!==e.left.type){var l=o(e.left),u=o(e.right),m=l+" = __$__("+l+', "'+e.operator[0]+'", '+u+")";h(e,/^\(.*\)$/.test(o(e))?"("+m+")":m)}}}}(i,n),!1!==r.moduleExports&&function(t){switch(t.type){case"ExportDefaultDeclaration":h({range:[t.start,t.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var e=t.declaration,i=t.specifiers;if(e){var n=e.declarations;n&&(n.forEach(function(t){h(t,"module.exports."+o(t))}),h({range:[t.start,e.start+e.kind.length]},""))}else if(i){var r=i.map(function(t){var e=o(t);return"module.exports."+e+" = "+e+"; "}).join("");r&&h(t,r)}}}(i)}}(l(t,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,g),u&&(b&&(t=Array(_+1).join("\n")+t),/^(inline|both)$/.test(p)&&(t+="\n//# sourceMappingURL=data:application/json;base64,"+e.btoa(unescape(encodeURIComponent(JSON.stringify(u))))),t+="\n//# sourceURL="+(f||"paperscript")),{url:f,source:m,code:t,map:u}}function y(t,e,i){th=e;var n,a=e.getView(),o=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)&&!/\bnew\s+Tool\b/.test(t)?new te:null,h=o?o._events:[],l=["onFrame","onResize"].concat(h),u=[],c=[];function d(e,i){for(var n in e)(i||!/^_/.test(n))&&RegExp("([\\b\\s\\W]|^)"+n.replace(/\$/g,"\\$")+"\\b").test(t)&&(u.push(n),c.push(e[n]))}t=("object"==typeof t?t:v(t,i)).code,d({__$__:g,$__:_,paper:e,tool:o},!0),d(e),t="var module = { exports: {} }; "+t;var f=s.each(l,function(e){RegExp("\\s+"+e+"\\b").test(t)&&(u.push(e),this.push("module.exports."+e+" = "+e+";"))},[]).join("\n");f&&(t+="\n"+f),t+="\nreturn module.exports;";var m=th.agent;if(r&&(m.chrome||m.firefox&&m.versionNumber<40)){var y=r.createElement("script"),b=r.head||r.getElementsByTagName("head")[0];m.firefox&&(t="\n"+t),y.appendChild(r.createTextNode("document.__paperscript__ = function("+u+") {"+t+"\n}")),b.appendChild(y),n=r.__paperscript__,delete r.__paperscript__,b.removeChild(y)}else n=Function(u,t);var f=n&&n.apply(e,c),x=f||{};return s.each(h,function(t){var e=x[t];e&&(o[t]=e)}),a&&(x.onResize&&a.setOnResize(x.onResize),a.emit("resize",{size:a.size,delta:new p}),x.onFrame&&a.setOnFrame(x.onFrame),a.requestUpdate()),f}function b(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==o.getAttribute(t,"ignore")){var e=o.getAttribute(t,"canvas"),i=r.getElementById(e),n=t.src||t.getAttribute("data-src"),s=o.hasAttribute(t,"async"),a="data-paper-scope";if(!i)throw Error('Unable to find canvas with id "'+e+'"');var h=o.get(i.getAttribute(a))||new o().setup(i);return i.setAttribute(a,h._id),n?tn.request({url:n,async:s,mimeType:"text/plain",onLoad:function(t){y(t,h,n)}}):y(t.innerHTML,h,t.baseURI),t.setAttribute("data-paper-ignore","true"),h}}function x(){s.each(r&&r.getElementsByTagName("script"),b)}return p.inject(f),m.inject(f),U.inject(f),n&&("complete"===r.readyState?setTimeout(x):G.add(n,{load:x})),{compile:v,execute:y,load:function(t){return t?b(t):x()},parse:l,calculateBinary:g,calculateUnary:_}}).call(this);var th=new(o.inject(s.exports,{Base:s,Numerical:d,Key:X,DomEvent:G,DomElement:H,document:r,window:n,Symbol:A,PlacedSymbol:T}));return th.agent.node&&u("gFNhN")(th),"function"==typeof define&&define.amd?define("paper",th):t&&(t.exports=th),th}).call(this,"object"==typeof self?self:null)}),c("gFNhN",function(t,e){}),c("7bbl5",function(t,e){s(t.exports,"isIdentifierStart",function(){return f}),s(t.exports,"isIdentifierChar",function(){return p}),s(t.exports,"TokenType",function(){return g}),s(t.exports,"keywordTypes",function(){return y}),s(t.exports,"tokTypes",function(){return x}),s(t.exports,"lineBreak",function(){return w}),s(t.exports,"lineBreakG",function(){return k}),s(t.exports,"isNewLine",function(){return C}),s(t.exports,"nonASCIIwhitespace",function(){return I}),s(t.exports,"Position",function(){return z}),s(t.exports,"SourceLocation",function(){return D}),s(t.exports,"getLineInfo",function(){return B}),s(t.exports,"defaultOptions",function(){return j}),s(t.exports,"Parser",function(){return U}),s(t.exports,"TokContext",function(){return te}),s(t.exports,"tokContexts",function(){return ti}),s(t.exports,"Node",function(){return tl}),s(t.exports,"Token",function(){return tz}),s(t.exports,"version",function(){return tV}),s(t.exports,"parse",function(){return tF}),s(t.exports,"parseExpressionAt",function(){return tU}),s(t.exports,"tokenizer",function(){return tq});var i=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],n=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,3104,541,1507,4938,6,4191],r="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},o="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",h={5:o,"5module":o+" export import",6:o+" const class extends export import super"},l=/^in(stanceof)?$/,u=RegExp("["+r+"]"),c=RegExp("["+r+"‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࢘-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿]");function d(t,e){for(var i=65536,n=0;n<e.length&&!((i+=e[n])>t);n+=2)if((i+=e[n+1])>=t)return!0;return!1}function f(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&u.test(String.fromCharCode(t)):!1!==e&&d(t,n)))}function p(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):!1!==e&&(d(t,n)||d(t,i)))))}var g=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function m(t,e){return new g(t,{beforeExpr:!0,binop:e})}var _={beforeExpr:!0},v={startsExpr:!0},y={};function b(t,e){return void 0===e&&(e={}),e.keyword=t,y[t]=new g(t,e)}var x={num:new g("num",v),regexp:new g("regexp",v),string:new g("string",v),name:new g("name",v),privateId:new g("privateId",v),eof:new g("eof"),bracketL:new g("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new g("]"),braceL:new g("{",{beforeExpr:!0,startsExpr:!0}),braceR:new g("}"),parenL:new g("(",{beforeExpr:!0,startsExpr:!0}),parenR:new g(")"),comma:new g(",",_),semi:new g(";",_),colon:new g(":",_),dot:new g("."),question:new g("?",_),questionDot:new g("?."),arrow:new g("=>",_),template:new g("template"),invalidTemplate:new g("invalidTemplate"),ellipsis:new g("...",_),backQuote:new g("`",v),dollarBraceL:new g("${",{beforeExpr:!0,startsExpr:!0}),eq:new g("=",{beforeExpr:!0,isAssign:!0}),assign:new g("_=",{beforeExpr:!0,isAssign:!0}),incDec:new g("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new g("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:m("||",1),logicalAND:m("&&",2),bitwiseOR:m("|",3),bitwiseXOR:m("^",4),bitwiseAND:m("&",5),equality:m("==/!=/===/!==",6),relational:m("</>/<=/>=",7),bitShift:m("<</>>/>>>",8),plusMin:new g("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:m("%",10),star:m("*",10),slash:m("/",10),starstar:new g("**",{beforeExpr:!0}),coalesce:m("??",1),_break:b("break"),_case:b("case",_),_catch:b("catch"),_continue:b("continue"),_debugger:b("debugger"),_default:b("default",_),_do:b("do",{isLoop:!0,beforeExpr:!0}),_else:b("else",_),_finally:b("finally"),_for:b("for",{isLoop:!0}),_function:b("function",v),_if:b("if"),_return:b("return",_),_switch:b("switch"),_throw:b("throw",_),_try:b("try"),_var:b("var"),_const:b("const"),_while:b("while",{isLoop:!0}),_with:b("with"),_new:b("new",{beforeExpr:!0,startsExpr:!0}),_this:b("this",v),_super:b("super",v),_class:b("class",v),_extends:b("extends",_),_export:b("export"),_import:b("import",v),_null:b("null",v),_true:b("true",v),_false:b("false",v),_in:b("in",{beforeExpr:!0,binop:7}),_instanceof:b("instanceof",{beforeExpr:!0,binop:7}),_typeof:b("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:b("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:b("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},w=/\r\n?|\n|\u2028|\u2029/,k=RegExp(w.source,"g");function C(t){return 10===t||13===t||8232===t||8233===t}function S(t,e,i){void 0===i&&(i=t.length);for(var n=e;n<i;n++){var r=t.charCodeAt(n);if(C(r))return n<i-1&&13===r&&10===t.charCodeAt(n+1)?n+2:n+1}return -1}var I=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,E=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,T=Object.prototype,A=T.hasOwnProperty,P=T.toString,M=Object.hasOwn||function(t,e){return A.call(t,e)},O=Array.isArray||function(t){return"[object Array]"===P.call(t)};function L(t){return RegExp("^(?:"+t.replace(/ /g,"|")+")$")}function N(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(((t-=65536)>>10)+55296,(1023&t)+56320)}var R=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,z=function(t,e){this.line=t,this.column=e};z.prototype.offset=function(t){return new z(this.line,this.column+t)};var D=function(t,e,i){this.start=e,this.end=i,null!==t.sourceFile&&(this.source=t.sourceFile)};function B(t,e){for(var i=1,n=0;;){var r=S(t,n,e);if(r<0)return new z(i,e-n);++i,n=r}}var j={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},V=!1;function F(t,e){return 2|(t?4:0)|(e?8:0)}var U=function(t,e,i){this.options=t=function(t){var e,i={};for(var n in j)i[n]=t&&M(t,n)?t[n]:j[n];if("latest"===i.ecmaVersion?i.ecmaVersion=1e8:null==i.ecmaVersion?(!V&&"object"==typeof console&&console.warn&&(V=!0,console.warn("Since Acorn 8.0.0, options.ecmaVersion is required.\nDefaulting to 2020, but this will stop working in the future.")),i.ecmaVersion=11):i.ecmaVersion>=2015&&(i.ecmaVersion-=2009),null==i.allowReserved&&(i.allowReserved=i.ecmaVersion<5),t&&null!=t.allowHashBang||(i.allowHashBang=i.ecmaVersion>=14),O(i.onToken)){var r=i.onToken;i.onToken=function(t){return r.push(t)}}return O(i.onComment)&&(i.onComment=(e=i.onComment,function(t,n,r,s,a,o){var h={type:t?"Block":"Line",value:n,start:r,end:s};i.locations&&(h.loc=new D(this,a,o)),i.ranges&&(h.range=[r,s]),e.push(h)})),i}(t),this.sourceFile=t.sourceFile,this.keywords=L(h[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var n="";!0!==t.allowReserved&&(n=a[t.ecmaVersion>=6?6:5===t.ecmaVersion?5:3],"module"===t.sourceType&&(n+=" await")),this.reservedWords=L(n);var r=(n?n+" ":"")+a.strict;this.reservedWordsStrict=L(r),this.reservedWordsStrictBind=L(r+" "+a.strictBind),this.input=String(e),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf("\n",i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(w).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=x.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null,this.privateNameStack=[]},q={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};U.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},q.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},q.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0&&!this.currentVarScope().inClassFieldInit},q.inAsync.get=function(){return(4&this.currentVarScope().flags)>0&&!this.currentVarScope().inClassFieldInit},q.canAwait.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t];if(e.inClassFieldInit||256&e.flags)return!1;if(2&e.flags)return(4&e.flags)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},q.allowSuper.get=function(){var t=this.currentThisScope(),e=t.flags,i=t.inClassFieldInit;return(64&e)>0||i||this.options.allowSuperOutsideMethod},q.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},q.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},q.allowNewDotTarget.get=function(){var t=this.currentThisScope(),e=t.flags,i=t.inClassFieldInit;return(258&e)>0||i},q.inClassStaticBlock.get=function(){return(256&this.currentVarScope().flags)>0},U.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var i=this,n=0;n<t.length;n++)i=t[n](i);return i},U.parse=function(t,e){return new this(e,t).parse()},U.parseExpressionAt=function(t,e,i){var n=new this(i,t,e);return n.nextToken(),n.parseExpression()},U.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(U.prototype,q);var $=U.prototype,Z=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;$.strictDirective=function(t){if(this.options.ecmaVersion<5)return!1;for(;;){E.lastIndex=t,t+=E.exec(this.input)[0].length;var e=Z.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2])){E.lastIndex=t+e[0].length;var i=E.exec(this.input),n=i.index+i[0].length,r=this.input.charAt(n);return";"===r||"}"===r||w.test(i[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||"!"===r&&"="===this.input.charAt(n+1))}t+=e[0].length,E.lastIndex=t,t+=E.exec(this.input)[0].length,";"===this.input[t]&&t++}},$.eat=function(t){return this.type===t&&(this.next(),!0)},$.isContextual=function(t){return this.type===x.name&&this.value===t&&!this.containsEsc},$.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},$.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},$.canInsertSemicolon=function(){return this.type===x.eof||this.type===x.braceR||w.test(this.input.slice(this.lastTokEnd,this.start))},$.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},$.semicolon=function(){this.eat(x.semi)||this.insertSemicolon()||this.unexpected()},$.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},$.expect=function(t){this.eat(t)||this.unexpected()},$.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var H=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};$.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var i=e?t.parenthesizedAssign:t.parenthesizedBind;i>-1&&this.raiseRecoverable(i,e?"Assigning to rvalue":"Parenthesized pattern")}},$.checkExpressionErrors=function(t,e){if(!t)return!1;var i=t.shorthandAssign,n=t.doubleProto;if(!e)return i>=0||n>=0;i>=0&&this.raise(i,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")},$.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},$.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var G=U.prototype;G.parseTopLevel=function(t){var e=Object.create(null);for(t.body||(t.body=[]);this.type!==x.eof;){var i=this.parseStatement(null,!0,e);t.body.push(i)}if(this.inModule)for(var n=0,r=Object.keys(this.undefinedExports);n<r.length;n+=1){var s=r[n];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var W={kind:"loop"},K={kind:"switch"};G.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;E.lastIndex=this.pos;var e=E.exec(this.input),i=this.pos+e[0].length,n=this.input.charCodeAt(i);if(91===n||92===n)return!0;if(t)return!1;if(123===n||n>55295&&n<56320)return!0;if(f(n,!0)){for(var r=i+1;p(n=this.input.charCodeAt(r),!0);)++r;if(92===n||n>55295&&n<56320)return!0;var s=this.input.slice(i,r);if(!l.test(s))return!0}return!1},G.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;E.lastIndex=this.pos;var t,e=E.exec(this.input),i=this.pos+e[0].length;return!w.test(this.input.slice(this.pos,i))&&"function"===this.input.slice(i,i+8)&&(i+8===this.input.length||!(p(t=this.input.charCodeAt(i+8))||t>55295&&t<56320))},G.parseStatement=function(t,e,i){var n,r=this.type,s=this.startNode();switch(this.isLet(t)&&(r=x._var,n="let"),r){case x._break:case x._continue:return this.parseBreakContinueStatement(s,r.keyword);case x._debugger:return this.parseDebuggerStatement(s);case x._do:return this.parseDoStatement(s);case x._for:return this.parseForStatement(s);case x._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!t);case x._class:return t&&this.unexpected(),this.parseClass(s,!0);case x._if:return this.parseIfStatement(s);case x._return:return this.parseReturnStatement(s);case x._switch:return this.parseSwitchStatement(s);case x._throw:return this.parseThrowStatement(s);case x._try:return this.parseTryStatement(s);case x._const:case x._var:return n=n||this.value,t&&"var"!==n&&this.unexpected(),this.parseVarStatement(s,n);case x._while:return this.parseWhileStatement(s);case x._with:return this.parseWithStatement(s);case x.braceL:return this.parseBlock(!0,s);case x.semi:return this.parseEmptyStatement(s);case x._export:case x._import:if(this.options.ecmaVersion>10&&r===x._import){E.lastIndex=this.pos;var a=E.exec(this.input),o=this.pos+a[0].length,h=this.input.charCodeAt(o);if(40===h||46===h)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===x._import?this.parseImport(s):this.parseExport(s,i);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!t);var l=this.value,u=this.parseExpression();if(r===x.name&&"Identifier"===u.type&&this.eat(x.colon))return this.parseLabeledStatement(s,l,u,t);return this.parseExpressionStatement(s,u)}},G.parseBreakContinueStatement=function(t,e){var i="break"===e;this.next(),this.eat(x.semi)||this.insertSemicolon()?t.label=null:this.type!==x.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var r=this.labels[n];if((null==t.label||r.name===t.label.name)&&(null!=r.kind&&(i||"loop"===r.kind)||t.label&&i))break}return n===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,i?"BreakStatement":"ContinueStatement")},G.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},G.parseDoStatement=function(t){return this.next(),this.labels.push(W),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(x._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(x.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},G.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(W),this.enterScope(0),this.expect(x.parenL),this.type===x.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var i=this.isLet();if(this.type===x._var||this.type===x._const||i){var n=this.startNode(),r=i?"let":this.value;return(this.next(),this.parseVar(n,!0,r),this.finishNode(n,"VariableDeclaration"),(this.type===x._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===n.declarations.length)?(this.options.ecmaVersion>=9&&(this.type===x._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,n)):(e>-1&&this.unexpected(e),this.parseFor(t,n))}var s=this.isContextual("let"),a=!1,o=new H,h=this.parseExpression(!(e>-1)||"await",o);return this.type===x._in||(a=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===x._in?e>-1&&this.unexpected(e):t.await=e>-1),s&&a&&this.raise(h.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(h,!1,o),this.checkLValPattern(h),this.parseForIn(t,h)):(this.checkExpressionErrors(o,!0),e>-1&&this.unexpected(e),this.parseFor(t,h))},G.parseFunctionStatement=function(t,e,i){return this.next(),this.parseFunction(t,Q|(i?0:X),!1,e)},G.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(x._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},G.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(x.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},G.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(x.braceL),this.labels.push(K),this.enterScope(0);for(var e,i=!1;this.type!==x.braceR;)if(this.type===x._case||this.type===x._default){var n=this.type===x._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),n?e.test=this.parseExpression():(i&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),i=!0,e.test=null),this.expect(x.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},G.parseThrowStatement=function(t){return this.next(),w.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var Y=[];G.parseCatchClauseParam=function(){var t=this.parseBindingAtom(),e="Identifier"===t.type;return this.enterScope(e?32:0),this.checkLValPattern(t,e?4:2),this.expect(x.parenR),t},G.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===x._catch){var e=this.startNode();this.next(),this.eat(x.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(x._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},G.parseVarStatement=function(t,e,i){return this.next(),this.parseVar(t,!1,e,i),this.semicolon(),this.finishNode(t,"VariableDeclaration")},G.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(W),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},G.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},G.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},G.parseLabeledStatement=function(t,e,i,n){for(var r=0,s=this.labels;r<s.length;r+=1)s[r].name===e&&this.raise(i.start,"Label '"+e+"' is already declared");for(var a=this.type.isLoop?"loop":this.type===x._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var h=this.labels[o];if(h.statementStart===t.start)h.statementStart=this.start,h.kind=a;else break}return this.labels.push({name:e,kind:a,statementStart:this.start}),t.body=this.parseStatement(n?-1===n.indexOf("label")?n+"label":n:"label"),this.labels.pop(),t.label=i,this.finishNode(t,"LabeledStatement")},G.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},G.parseBlock=function(t,e,i){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(x.braceL),t&&this.enterScope(0);this.type!==x.braceR;){var n=this.parseStatement(null);e.body.push(n)}return i&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")},G.parseFor=function(t,e){return t.init=e,this.expect(x.semi),t.test=this.type===x.semi?null:this.parseExpression(),this.expect(x.semi),t.update=this.type===x.parenR?null:this.parseExpression(),this.expect(x.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},G.parseForIn=function(t,e){var i=this.type===x._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!i||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)&&this.raise(e.start,(i?"for-in":"for-of")+" loop variable declaration may not have an initializer"),t.left=e,t.right=i?this.parseExpression():this.parseMaybeAssign(),this.expect(x.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,i?"ForInStatement":"ForOfStatement")},G.parseVar=function(t,e,i,n){for(t.declarations=[],t.kind=i;;){var r=this.startNode();if(this.parseVarId(r,i),this.eat(x.eq)?r.init=this.parseMaybeAssign(e):n||"const"!==i||this.type===x._in||this.options.ecmaVersion>=6&&this.isContextual("of")?n||"Identifier"===r.id.type||e&&(this.type===x._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(x.comma))break}return t},G.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLValPattern(t.id,"var"===e?1:2,!1)};var Q=1,X=2;function J(t,e){var i=t.computed,n=t.key;return!i&&("Identifier"===n.type&&n.name===e||"Literal"===n.type&&n.value===e)}G.parseFunction=function(t,e,i,n,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===x.star&&e&X&&this.unexpected(),t.generator=this.eat(x.star)),this.options.ecmaVersion>=8&&(t.async=!!n),e&Q&&(t.id=4&e&&this.type!==x.name?null:this.parseIdent(),t.id&&!(e&X)&&this.checkLValSimple(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var s=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(F(t.async,t.generator)),e&Q||(t.id=this.type===x.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,i,!1,r),this.yieldPos=s,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,e&Q?"FunctionDeclaration":"FunctionExpression")},G.parseFunctionParams=function(t){this.expect(x.parenL),t.params=this.parseBindingList(x.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},G.parseClass=function(t,e){this.next();var i=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var n=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(x.braceL);this.type!==x.braceR;){var a=this.parseClassElement(null!==t.superClass);a&&(r.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind?(s&&this.raiseRecoverable(a.start,"Duplicate constructor in the same class"),s=!0):a.key&&"PrivateIdentifier"===a.key.type&&function(t,e){var i=e.key.name,n=t[i],r="true";return("MethodDefinition"===e.type&&("get"===e.kind||"set"===e.kind)&&(r=(e.static?"s":"i")+e.kind),"iget"===n&&"iset"===r||"iset"===n&&"iget"===r||"sget"===n&&"sset"===r||"sset"===n&&"sget"===r)?(t[i]="true",!1):!!n||(t[i]=r,!1)}(n,a)&&this.raiseRecoverable(a.key.start,"Identifier '#"+a.key.name+"' has already been declared"))}return this.strict=i,this.next(),t.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},G.parseClassElement=function(t){if(this.eat(x.semi))return null;var e=this.options.ecmaVersion,i=this.startNode(),n="",r=!1,s=!1,a="method",o=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(x.braceL))return this.parseClassStaticBlock(i),i;this.isClassElementNameStart()||this.type===x.star?o=!0:n="static"}if(i.static=o,!n&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===x.star)&&!this.canInsertSemicolon()?s=!0:n="async"),!n&&(e>=9||!s)&&this.eat(x.star)&&(r=!0),!n&&!s&&!r){var h=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?a=h:n=h)}if(n?(i.computed=!1,i.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),i.key.name=n,this.finishNode(i.key,"Identifier")):this.parseClassElementName(i),e<13||this.type===x.parenL||"method"!==a||r||s){var l=!i.static&&J(i,"constructor");l&&"method"!==a&&this.raise(i.key.start,"Constructor can't have get/set modifier"),i.kind=l?"constructor":a,this.parseClassMethod(i,r,s,l&&t)}else this.parseClassField(i);return i},G.isClassElementNameStart=function(){return this.type===x.name||this.type===x.privateId||this.type===x.num||this.type===x.string||this.type===x.bracketL||this.type.keyword},G.parseClassElementName=function(t){this.type===x.privateId?("constructor"===this.value&&this.raise(this.start,"Classes can't have an element named '#constructor'"),t.computed=!1,t.key=this.parsePrivateIdent()):this.parsePropertyName(t)},G.parseClassMethod=function(t,e,i,n){var r=t.key;"constructor"===t.kind?(e&&this.raise(r.start,"Constructor can't be a generator"),i&&this.raise(r.start,"Constructor can't be an async method")):t.static&&J(t,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=t.value=this.parseMethod(e,i,n);return"get"===t.kind&&0!==s.params.length&&this.raiseRecoverable(s.start,"getter should have no params"),"set"===t.kind&&1!==s.params.length&&this.raiseRecoverable(s.start,"setter should have exactly one param"),"set"===t.kind&&"RestElement"===s.params[0].type&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(t,"MethodDefinition")},G.parseClassField=function(t){if(J(t,"constructor")?this.raise(t.key.start,"Classes can't have a field named 'constructor'"):t.static&&J(t,"prototype")&&this.raise(t.key.start,"Classes can't have a static field named 'prototype'"),this.eat(x.eq)){var e=this.currentThisScope(),i=e.inClassFieldInit;e.inClassFieldInit=!0,t.value=this.parseMaybeAssign(),e.inClassFieldInit=i}else t.value=null;return this.semicolon(),this.finishNode(t,"PropertyDefinition")},G.parseClassStaticBlock=function(t){t.body=[];var e=this.labels;for(this.labels=[],this.enterScope(320);this.type!==x.braceR;){var i=this.parseStatement(null);t.body.push(i)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(t,"StaticBlock")},G.parseClassId=function(t,e){this.type===x.name?(t.id=this.parseIdent(),e&&this.checkLValSimple(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},G.parseClassSuper=function(t){t.superClass=this.eat(x._extends)?this.parseExprSubscripts(null,!1):null},G.enterClassBody=function(){var t={declared:Object.create(null),used:[]};return this.privateNameStack.push(t),t.declared},G.exitClassBody=function(){var t=this.privateNameStack.pop(),e=t.declared,i=t.used;if(this.options.checkPrivateFields)for(var n=this.privateNameStack.length,r=0===n?null:this.privateNameStack[n-1],s=0;s<i.length;++s){var a=i[s];M(e,a.name)||(r?r.used.push(a):this.raiseRecoverable(a.start,"Private field '#"+a.name+"' must be declared in an enclosing class"))}},G.parseExportAllDeclaration=function(t,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseModuleExportName(),this.checkExport(e,t.exported,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==x.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration")},G.parseExport=function(t,e){if(this.next(),this.eat(x.star))return this.parseExportAllDeclaration(t,e);if(this.eat(x._default))return this.checkExport(e,"default",this.lastTokStart),t.declaration=this.parseExportDefaultDeclaration(),this.finishNode(t,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())t.declaration=this.parseExportDeclaration(t),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==x.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var i=0,n=t.specifiers;i<n.length;i+=1){var r=n[i];this.checkUnreserved(r.local),this.checkLocalExport(r.local),"Literal"===r.local.type&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},G.parseExportDeclaration=function(t){return this.parseStatement(null)},G.parseExportDefaultDeclaration=function(){if(this.type===x._function||(t=this.isAsyncFunction())){var t,e=this.startNode();return this.next(),t&&this.next(),this.parseFunction(e,4|Q,!1,t)}if(this.type===x._class){var i=this.startNode();return this.parseClass(i,"nullableID")}var n=this.parseMaybeAssign();return this.semicolon(),n},G.checkExport=function(t,e,i){t&&("string"!=typeof e&&(e="Identifier"===e.type?e.name:e.value),M(t,e)&&this.raiseRecoverable(i,"Duplicate export '"+e+"'"),t[e]=!0)},G.checkPatternExport=function(t,e){var i=e.type;if("Identifier"===i)this.checkExport(t,e,e.start);else if("ObjectPattern"===i)for(var n=0,r=e.properties;n<r.length;n+=1){var s=r[n];this.checkPatternExport(t,s)}else if("ArrayPattern"===i)for(var a=0,o=e.elements;a<o.length;a+=1){var h=o[a];h&&this.checkPatternExport(t,h)}else"Property"===i?this.checkPatternExport(t,e.value):"AssignmentPattern"===i?this.checkPatternExport(t,e.left):"RestElement"===i?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===i&&this.checkPatternExport(t,e.expression)},G.checkVariableExport=function(t,e){if(t)for(var i=0;i<e.length;i+=1){var n=e[i];this.checkPatternExport(t,n.id)}},G.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},G.parseExportSpecifier=function(t){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(t,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")},G.parseExportSpecifiers=function(t){var e=[],i=!0;for(this.expect(x.braceL);!this.eat(x.braceR);){if(i)i=!1;else if(this.expect(x.comma),this.afterTrailingComma(x.braceR))break;e.push(this.parseExportSpecifier(t))}return e},G.parseImport=function(t){return this.next(),this.type===x.string?(t.specifiers=Y,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===x.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},G.parseImportSpecifier=function(){var t=this.startNode();return t.imported=this.parseModuleExportName(),this.eatContextual("as")?t.local=this.parseIdent():(this.checkUnreserved(t.imported),t.local=t.imported),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportSpecifier")},G.parseImportDefaultSpecifier=function(){var t=this.startNode();return t.local=this.parseIdent(),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportDefaultSpecifier")},G.parseImportNamespaceSpecifier=function(){var t=this.startNode();return this.next(),this.expectContextual("as"),t.local=this.parseIdent(),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportNamespaceSpecifier")},G.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===x.name&&(t.push(this.parseImportDefaultSpecifier()),!this.eat(x.comma)))return t;if(this.type===x.star)return t.push(this.parseImportNamespaceSpecifier()),t;for(this.expect(x.braceL);!this.eat(x.braceR);){if(e)e=!1;else if(this.expect(x.comma),this.afterTrailingComma(x.braceR))break;t.push(this.parseImportSpecifier())}return t},G.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===x.string){var t=this.parseLiteral(this.value);return R.test(t.value)&&this.raise(t.start,"An export name cannot include a lone surrogate."),t}return this.parseIdent(!0)},G.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},G.isDirectiveCandidate=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var tt=U.prototype;tt.toAssignable=function(t,e,i){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",i&&this.checkPatternErrors(i,!0);for(var n=0,r=t.properties;n<r.length;n+=1){var s=r[n];this.toAssignable(s,e),"RestElement"===s.type&&("ArrayPattern"===s.argument.type||"ObjectPattern"===s.argument.type)&&this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",i&&this.checkPatternErrors(i,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,i);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else i&&this.checkPatternErrors(i,!0);return t},tt.toAssignableList=function(t,e){for(var i=t.length,n=0;n<i;n++){var r=t[n];r&&this.toAssignable(r,e)}if(i){var s=t[i-1];6===this.options.ecmaVersion&&e&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return t},tt.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},tt.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==x.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},tt.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case x.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(x.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case x.braceL:return this.parseObj(!0)}return this.parseIdent()},tt.parseBindingList=function(t,e,i,n){for(var r=[],s=!0;!this.eat(t);)if(s?s=!1:this.expect(x.comma),e&&this.type===x.comma)r.push(null);else if(i&&this.afterTrailingComma(t))break;else if(this.type===x.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===x.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}else r.push(this.parseAssignableListItem(n));return r},tt.parseAssignableListItem=function(t){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e},tt.parseBindingListItem=function(t){return t},tt.parseMaybeDefault=function(t,e,i){if(i=i||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(x.eq))return i;var n=this.startNodeAt(t,e);return n.left=i,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")},tt.checkLValSimple=function(t,e,i){void 0===e&&(e=0);var n=0!==e;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(n?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),i&&(M(i,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),i[t.name]=!0),5!==e&&this.declareName(t.name,e,t.start));break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":n&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ParenthesizedExpression":return n&&this.raiseRecoverable(t.start,"Binding parenthesized expression"),this.checkLValSimple(t.expression,e,i);default:this.raise(t.start,(n?"Binding":"Assigning to")+" rvalue")}},tt.checkLValPattern=function(t,e,i){switch(void 0===e&&(e=0),t.type){case"ObjectPattern":for(var n=0,r=t.properties;n<r.length;n+=1){var s=r[n];this.checkLValInnerPattern(s,e,i)}break;case"ArrayPattern":for(var a=0,o=t.elements;a<o.length;a+=1){var h=o[a];h&&this.checkLValInnerPattern(h,e,i)}break;default:this.checkLValSimple(t,e,i)}},tt.checkLValInnerPattern=function(t,e,i){switch(void 0===e&&(e=0),t.type){case"Property":this.checkLValInnerPattern(t.value,e,i);break;case"AssignmentPattern":this.checkLValPattern(t.left,e,i);break;case"RestElement":this.checkLValPattern(t.argument,e,i);break;default:this.checkLValPattern(t,e,i)}};var te=function(t,e,i,n,r){this.token=t,this.isExpr=!!e,this.preserveSpace=!!i,this.override=n,this.generator=!!r},ti={b_stat:new te("{",!1),b_expr:new te("{",!0),b_tmpl:new te("${",!1),p_stat:new te("(",!1),p_expr:new te("(",!0),q_tmpl:new te("`",!0,!0,function(t){return t.tryReadTemplateToken()}),f_stat:new te("function",!1),f_expr:new te("function",!0),f_expr_gen:new te("function",!0,!1,null,!0),f_gen:new te("function",!1,!1,null,!0)},tn=U.prototype;tn.initialContext=function(){return[ti.b_stat]},tn.curContext=function(){return this.context[this.context.length-1]},tn.braceIsBlock=function(t){var e=this.curContext();return e===ti.f_expr||e===ti.f_stat||(t===x.colon&&(e===ti.b_stat||e===ti.b_expr)?!e.isExpr:t===x._return||t===x.name&&this.exprAllowed?w.test(this.input.slice(this.lastTokEnd,this.start)):t===x._else||t===x.semi||t===x.eof||t===x.parenR||t===x.arrow||(t===x.braceL?e===ti.b_stat:t!==x._var&&t!==x._const&&t!==x.name&&!this.exprAllowed))},tn.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},tn.updateContext=function(t){var e,i=this.type;i.keyword&&t===x.dot?this.exprAllowed=!1:(e=i.updateContext)?e.call(this,t):this.exprAllowed=i.beforeExpr},tn.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)},x.parenR.updateContext=x.braceR.updateContext=function(){if(1===this.context.length){this.exprAllowed=!0;return}var t=this.context.pop();t===ti.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr},x.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?ti.b_stat:ti.b_expr),this.exprAllowed=!0},x.dollarBraceL.updateContext=function(){this.context.push(ti.b_tmpl),this.exprAllowed=!0},x.parenL.updateContext=function(t){var e=t===x._if||t===x._for||t===x._with||t===x._while;this.context.push(e?ti.p_stat:ti.p_expr),this.exprAllowed=!0},x.incDec.updateContext=function(){},x._function.updateContext=x._class.updateContext=function(t){!t.beforeExpr||t===x._else||t===x.semi&&this.curContext()!==ti.p_stat||t===x._return&&w.test(this.input.slice(this.lastTokEnd,this.start))||(t===x.colon||t===x.braceL)&&this.curContext()===ti.b_stat?this.context.push(ti.f_stat):this.context.push(ti.f_expr),this.exprAllowed=!1},x.backQuote.updateContext=function(){this.curContext()===ti.q_tmpl?this.context.pop():this.context.push(ti.q_tmpl),this.exprAllowed=!1},x.star.updateContext=function(t){if(t===x._function){var e=this.context.length-1;this.context[e]===ti.f_expr?this.context[e]=ti.f_expr_gen:this.context[e]=ti.f_gen}this.exprAllowed=!0},x.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==x.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var tr=U.prototype;tr.checkPropClash=function(t,e,i){if((!(this.options.ecmaVersion>=9)||"SpreadElement"!==t.type)&&(!(this.options.ecmaVersion>=6)||!t.computed&&!t.method&&!t.shorthand)){var n,r=t.key;switch(r.type){case"Identifier":n=r.name;break;case"Literal":n=String(r.value);break;default:return}var s=t.kind;if(this.options.ecmaVersion>=6){"__proto__"===n&&"init"===s&&(e.proto&&(i?i.doubleProto<0&&(i.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),e.proto=!0);return}var a=e[n="$"+n];a?("init"===s?this.strict&&a.init||a.get||a.set:a.init||a[s])&&this.raiseRecoverable(r.start,"Redefinition of property"):a=e[n]={init:!1,get:!1,set:!1},a[s]=!0}},tr.parseExpression=function(t,e){var i=this.start,n=this.startLoc,r=this.parseMaybeAssign(t,e);if(this.type===x.comma){var s=this.startNodeAt(i,n);for(s.expressions=[r];this.eat(x.comma);)s.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(s,"SequenceExpression")}return r},tr.parseMaybeAssign=function(t,e,i){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var n=!1,r=-1,s=-1,a=-1;e?(r=e.parenthesizedAssign,s=e.trailingComma,a=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new H,n=!0);var o=this.start,h=this.startLoc;(this.type===x.parenL||this.type===x.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait="await"===t);var l=this.parseMaybeConditional(t,e);if(i&&(l=i.call(this,l,o,h)),this.type.isAssign){var u=this.startNodeAt(o,h);return u.operator=this.value,this.type===x.eq&&(l=this.toAssignable(l,!1,e)),n||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=l.start&&(e.shorthandAssign=-1),this.type===x.eq?this.checkLValPattern(l):this.checkLValSimple(l),u.left=l,this.next(),u.right=this.parseMaybeAssign(t),a>-1&&(e.doubleProto=a),this.finishNode(u,"AssignmentExpression")}return n&&this.checkExpressionErrors(e,!0),r>-1&&(e.parenthesizedAssign=r),s>-1&&(e.trailingComma=s),l},tr.parseMaybeConditional=function(t,e){var i=this.start,n=this.startLoc,r=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return r;if(this.eat(x.question)){var s=this.startNodeAt(i,n);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(x.colon),s.alternate=this.parseMaybeAssign(t),this.finishNode(s,"ConditionalExpression")}return r},tr.parseExprOps=function(t,e){var i=this.start,n=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,t);return this.checkExpressionErrors(e)?r:r.start===i&&"ArrowFunctionExpression"===r.type?r:this.parseExprOp(r,i,n,-1,t)},tr.parseExprOp=function(t,e,i,n,r){var s=this.type.binop;if(null!=s&&(!r||this.type!==x._in)&&s>n){var a=this.type===x.logicalOR||this.type===x.logicalAND,o=this.type===x.coalesce;o&&(s=x.logicalAND.binop);var h=this.value;this.next();var l=this.start,u=this.startLoc,c=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),l,u,s,r),d=this.buildBinary(e,i,t,c,h,a||o);return(a&&this.type===x.coalesce||o&&(this.type===x.logicalOR||this.type===x.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,e,i,n,r)}return t},tr.buildBinary=function(t,e,i,n,r,s){"PrivateIdentifier"===n.type&&this.raise(n.start,"Private identifier can only be left side of binary expression");var a=this.startNodeAt(t,e);return a.left=i,a.operator=r,a.right=n,this.finishNode(a,s?"LogicalExpression":"BinaryExpression")},tr.parseMaybeUnary=function(t,e,i,n){var r,s=this.start,a=this.startLoc;if(this.isContextual("await")&&this.canAwait)r=this.parseAwait(n),e=!0;else if(this.type.prefix){var o=this.startNode(),h=this.type===x.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,h,n),this.checkExpressionErrors(t,!0),h?this.checkLValSimple(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):"delete"===o.operator&&function t(e){return"MemberExpression"===e.type&&"PrivateIdentifier"===e.property.type||"ChainExpression"===e.type&&t(e.expression)}(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):e=!0,r=this.finishNode(o,h?"UpdateExpression":"UnaryExpression")}else if(e||this.type!==x.privateId){if(r=this.parseExprSubscripts(t,n),this.checkExpressionErrors(t))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var l=this.startNodeAt(s,a);l.operator=this.value,l.prefix=!1,l.argument=r,this.checkLValSimple(r),this.next(),r=this.finishNode(l,"UpdateExpression")}}else(n||0===this.privateNameStack.length)&&this.options.checkPrivateFields&&this.unexpected(),r=this.parsePrivateIdent(),this.type!==x._in&&this.unexpected();return!i&&this.eat(x.starstar)?e?void this.unexpected(this.lastTokStart):this.buildBinary(s,a,r,this.parseMaybeUnary(null,!1,!1,n),"**",!1):r},tr.parseExprSubscripts=function(t,e){var i=this.start,n=this.startLoc,r=this.parseExprAtom(t,e);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var s=this.parseSubscripts(r,i,n,!1,e);return t&&"MemberExpression"===s.type&&(t.parenthesizedAssign>=s.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=s.start&&(t.parenthesizedBind=-1),t.trailingComma>=s.start&&(t.trailingComma=-1)),s},tr.parseSubscripts=function(t,e,i,n,r){for(var s=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start==5&&this.potentialArrowAt===t.start,a=!1;;){var o=this.parseSubscript(t,e,i,n,s,a,r);if(o.optional&&(a=!0),o===t||"ArrowFunctionExpression"===o.type){if(a){var h=this.startNodeAt(e,i);h.expression=o,o=this.finishNode(h,"ChainExpression")}return o}t=o}},tr.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(x.arrow)},tr.parseSubscriptAsyncArrow=function(t,e,i,n){return this.parseArrowExpression(this.startNodeAt(t,e),i,!0,n)},tr.parseSubscript=function(t,e,i,n,r,s,a){var o=this.options.ecmaVersion>=11,h=o&&this.eat(x.questionDot);n&&h&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var l=this.eat(x.bracketL);if(l||h&&this.type!==x.parenL&&this.type!==x.backQuote||this.eat(x.dot)){var u=this.startNodeAt(e,i);u.object=t,l?(u.property=this.parseExpression(),this.expect(x.bracketR)):this.type===x.privateId&&"Super"!==t.type?u.property=this.parsePrivateIdent():u.property=this.parseIdent("never"!==this.options.allowReserved),u.computed=!!l,o&&(u.optional=h),t=this.finishNode(u,"MemberExpression")}else if(!n&&this.eat(x.parenL)){var c=new H,d=this.yieldPos,f=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var g=this.parseExprList(x.parenR,this.options.ecmaVersion>=8,!1,c);if(r&&!h&&this.shouldParseAsyncArrow())return this.checkPatternErrors(c,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=f,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(e,i,g,a);this.checkExpressionErrors(c,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=f||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var m=this.startNodeAt(e,i);m.callee=t,m.arguments=g,o&&(m.optional=h),t=this.finishNode(m,"CallExpression")}else if(this.type===x.backQuote){(h||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var _=this.startNodeAt(e,i);_.tag=t,_.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(_,"TaggedTemplateExpression")}return t},tr.parseExprAtom=function(t,e,i){this.type===x.slash&&this.readRegexp();var n,r=this.potentialArrowAt===this.start;switch(this.type){case x._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),n=this.startNode(),this.next(),this.type!==x.parenL||this.allowDirectSuper||this.raise(n.start,"super() call outside constructor of a subclass"),this.type!==x.dot&&this.type!==x.bracketL&&this.type!==x.parenL&&this.unexpected(),this.finishNode(n,"Super");case x._this:return n=this.startNode(),this.next(),this.finishNode(n,"ThisExpression");case x.name:var s=this.start,a=this.startLoc,o=this.containsEsc,h=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&"async"===h.name&&!this.canInsertSemicolon()&&this.eat(x._function))return this.overrideContext(ti.f_expr),this.parseFunction(this.startNodeAt(s,a),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(x.arrow))return this.parseArrowExpression(this.startNodeAt(s,a),[h],!1,e);if(this.options.ecmaVersion>=8&&"async"===h.name&&this.type===x.name&&!o&&(!this.potentialArrowInForAwait||"of"!==this.value||this.containsEsc))return h=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(x.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,a),[h],!0,e)}return h;case x.regexp:var l=this.value;return(n=this.parseLiteral(l.value)).regex={pattern:l.pattern,flags:l.flags},n;case x.num:case x.string:return this.parseLiteral(this.value);case x._null:case x._true:case x._false:return(n=this.startNode()).value=this.type===x._null?null:this.type===x._true,n.raw=this.type.keyword,this.next(),this.finishNode(n,"Literal");case x.parenL:var u=this.start,c=this.parseParenAndDistinguishExpression(r,e);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(t.parenthesizedAssign=u),t.parenthesizedBind<0&&(t.parenthesizedBind=u)),c;case x.bracketL:return n=this.startNode(),this.next(),n.elements=this.parseExprList(x.bracketR,!0,!0,t),this.finishNode(n,"ArrayExpression");case x.braceL:return this.overrideContext(ti.b_expr),this.parseObj(!1,t);case x._function:return n=this.startNode(),this.next(),this.parseFunction(n,0);case x._class:return this.parseClass(this.startNode(),!1);case x._new:return this.parseNew();case x.backQuote:return this.parseTemplate();case x._import:if(this.options.ecmaVersion>=11)return this.parseExprImport(i);return this.unexpected();default:return this.parseExprAtomDefault()}},tr.parseExprAtomDefault=function(){this.unexpected()},tr.parseExprImport=function(t){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var i=this.parseIdent(!0);return this.type!==x.parenL||t?this.type===x.dot?(e.meta=i,this.parseImportMeta(e)):void this.unexpected():this.parseDynamicImport(e)},tr.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),!this.eat(x.parenR)){var e=this.start;this.eat(x.comma)&&this.eat(x.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")},tr.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),"meta"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),"module"===this.options.sourceType||this.options.allowImportExportEverywhere||this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")},tr.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")},tr.parseParenExpression=function(){this.expect(x.parenL);var t=this.parseExpression();return this.expect(x.parenR),t},tr.shouldParseArrow=function(t){return!this.canInsertSemicolon()},tr.parseParenAndDistinguishExpression=function(t,e){var i,n=this.start,r=this.startLoc,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,h=this.startLoc,l=[],u=!0,c=!1,d=new H,f=this.yieldPos,p=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==x.parenR;){if(u?u=!1:this.expect(x.comma),s&&this.afterTrailingComma(x.parenR,!0)){c=!0;break}if(this.type===x.ellipsis){a=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===x.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}l.push(this.parseMaybeAssign(!1,d,this.parseParenItem))}var g=this.lastTokEnd,m=this.lastTokEndLoc;if(this.expect(x.parenR),t&&this.shouldParseArrow(l)&&this.eat(x.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=f,this.awaitPos=p,this.parseParenArrowList(n,r,l,e);(!l.length||c)&&this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(d,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?((i=this.startNodeAt(o,h)).expressions=l,this.finishNodeAt(i,"SequenceExpression",g,m)):i=l[0]}else i=this.parseParenExpression();if(!this.options.preserveParens)return i;var _=this.startNodeAt(n,r);return _.expression=i,this.finishNode(_,"ParenthesizedExpression")},tr.parseParenItem=function(t){return t},tr.parseParenArrowList=function(t,e,i,n){return this.parseArrowExpression(this.startNodeAt(t,e),i,!1,n)};var ts=[];tr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(x.dot)){t.meta=e;var i=this.containsEsc;return t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),i&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(t.start,"'new.target' can only be used in functions and class static block"),this.finishNode(t,"MetaProperty")}var n=this.start,r=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),n,r,!0,!1),this.eat(x.parenL)?t.arguments=this.parseExprList(x.parenR,this.options.ecmaVersion>=8,!1):t.arguments=ts,this.finishNode(t,"NewExpression")},tr.parseTemplateElement=function(t){var e=t.isTagged,i=this.startNode();return this.type===x.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),i.value={raw:this.value,cooked:null}):i.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),i.tail=this.type===x.backQuote,this.finishNode(i,"TemplateElement")},tr.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var i=this.startNode();this.next(),i.expressions=[];var n=this.parseTemplateElement({isTagged:e});for(i.quasis=[n];!n.tail;)this.type===x.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(x.dollarBraceL),i.expressions.push(this.parseExpression()),this.expect(x.braceR),i.quasis.push(n=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(i,"TemplateLiteral")},tr.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===x.name||this.type===x.num||this.type===x.string||this.type===x.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===x.star)&&!w.test(this.input.slice(this.lastTokEnd,this.start))},tr.parseObj=function(t,e){var i=this.startNode(),n=!0,r={};for(i.properties=[],this.next();!this.eat(x.braceR);){if(n)n=!1;else if(this.expect(x.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(x.braceR))break;var s=this.parseProperty(t,e);t||this.checkPropClash(s,r,e),i.properties.push(s)}return this.finishNode(i,t?"ObjectPattern":"ObjectExpression")},tr.parseProperty=function(t,e){var i,n,r,s,a=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(x.ellipsis))return t?(a.argument=this.parseIdent(!1),this.type===x.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(a.argument=this.parseMaybeAssign(!1,e),this.type===x.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(a,"SpreadElement"));this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(t||e)&&(r=this.start,s=this.startLoc),t||(i=this.eat(x.star)));var o=this.containsEsc;return this.parsePropertyName(a),!t&&!o&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(a)?(n=!0,i=this.options.ecmaVersion>=9&&this.eat(x.star),this.parsePropertyName(a)):n=!1,this.parsePropertyValue(a,t,i,n,r,s,e,o),this.finishNode(a,"Property")},tr.parseGetterSetter=function(t){t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var e="get"===t.kind?0:1;if(t.value.params.length!==e){var i=t.value.start;"get"===t.kind?this.raiseRecoverable(i,"getter should have no params"):this.raiseRecoverable(i,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")},tr.parsePropertyValue=function(t,e,i,n,r,s,a,o){(i||n)&&this.type===x.colon&&this.unexpected(),this.eat(x.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init"):this.options.ecmaVersion>=6&&this.type===x.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(i,n)):e||o||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===x.comma||this.type===x.braceR||this.type===x.eq?this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((i||n)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=r),t.kind="init",e?t.value=this.parseMaybeDefault(r,s,this.copyNode(t.key)):this.type===x.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(r,s,this.copyNode(t.key))):t.value=this.copyNode(t.key),t.shorthand=!0):this.unexpected():((i||n)&&this.unexpected(),this.parseGetterSetter(t))},tr.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(x.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(x.bracketR),t.key;t.computed=!1}return t.key=this.type===x.num||this.type===x.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},tr.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},tr.parseMethod=function(t,e,i){var n=this.startNode(),r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=t),this.options.ecmaVersion>=8&&(n.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|F(e,n.generator)|(i?128:0)),this.expect(x.parenL),n.params=this.parseBindingList(x.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(n,"FunctionExpression")},tr.parseArrowExpression=function(t,e,i,n){var r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(16|F(i,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!i),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1,n),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(t,"ArrowFunctionExpression")},tr.parseFunctionBody=function(t,e,i,n){var r=e&&this.type!==x.braceL,s=this.strict,a=!1;if(r)t.body=this.parseMaybeAssign(n),t.expression=!0,this.checkParams(t,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);(!s||o)&&(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var h=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(t,!s&&!a&&!e&&!i&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLValSimple(t.id,5),t.body=this.parseBlock(!1,void 0,a&&!s),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=h}this.exitScope()},tr.isSimpleParamList=function(t){for(var e=0;e<t.length;e+=1)if("Identifier"!==t[e].type)return!1;return!0},tr.checkParams=function(t,e){for(var i=Object.create(null),n=0,r=t.params;n<r.length;n+=1){var s=r[n];this.checkLValInnerPattern(s,1,e?null:i)}},tr.parseExprList=function(t,e,i,n){for(var r=[],s=!0;!this.eat(t);){if(s)s=!1;else if(this.expect(x.comma),e&&this.afterTrailingComma(t))break;var a=void 0;i&&this.type===x.comma?a=null:this.type===x.ellipsis?(a=this.parseSpread(n),n&&this.type===x.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):a=this.parseMaybeAssign(!1,n),r.push(a)}return r},tr.checkUnreserved=function(t){var e=t.start,i=t.end,n=t.name;this.inGenerator&&"yield"===n&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===n&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&"arguments"===n&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&("arguments"===n||"await"===n)&&this.raise(e,"Cannot use "+n+" in class static initialization block"),this.keywords.test(n)&&this.raise(e,"Unexpected keyword '"+n+"'"),(!(this.options.ecmaVersion<6)||-1===this.input.slice(e,i).indexOf("\\"))&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(n)&&(this.inAsync||"await"!==n||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+n+"' is reserved"))},tr.parseIdent=function(t){var e=this.parseIdentNode();return this.next(!!t),this.finishNode(e,"Identifier"),t||(this.checkUnreserved(e),"await"!==e.name||this.awaitIdentPos||(this.awaitIdentPos=e.start)),e},tr.parseIdentNode=function(){var t=this.startNode();return this.type===x.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,("class"===t.name||"function"===t.name)&&(this.lastTokEnd!==this.lastTokStart+1||46!==this.input.charCodeAt(this.lastTokStart))&&this.context.pop()):this.unexpected(),t},tr.parsePrivateIdent=function(){var t=this.startNode();return this.type===x.privateId?t.name=this.value:this.unexpected(),this.next(),this.finishNode(t,"PrivateIdentifier"),this.options.checkPrivateFields&&(0===this.privateNameStack.length?this.raise(t.start,"Private field '#"+t.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(t)),t},tr.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===x.semi||this.canInsertSemicolon()||this.type!==x.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(x.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},tr.parseAwait=function(t){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,t),this.finishNode(e,"AwaitExpression")};var ta=U.prototype;ta.raise=function(t,e){var i=B(this.input,t),n=SyntaxError(e+=" ("+i.line+":"+i.column+")");throw n.pos=t,n.loc=i,n.raisedAt=this.pos,n},ta.raiseRecoverable=ta.raise,ta.curPosition=function(){if(this.options.locations)return new z(this.curLine,this.pos-this.lineStart)};var to=U.prototype,th=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};to.enterScope=function(t){this.scopeStack.push(new th(t))},to.exitScope=function(){this.scopeStack.pop()},to.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},to.declareName=function(t,e,i){var n=!1;if(2===e){var r=this.currentScope();n=r.lexical.indexOf(t)>-1||r.functions.indexOf(t)>-1||r.var.indexOf(t)>-1,r.lexical.push(t),this.inModule&&1&r.flags&&delete this.undefinedExports[t]}else if(4===e)this.currentScope().lexical.push(t);else if(3===e){var s=this.currentScope();n=this.treatFunctionsAsVar?s.lexical.indexOf(t)>-1:s.lexical.indexOf(t)>-1||s.var.indexOf(t)>-1,s.functions.push(t)}else for(var a=this.scopeStack.length-1;a>=0;--a){var o=this.scopeStack[a];if(o.lexical.indexOf(t)>-1&&!(32&o.flags&&o.lexical[0]===t)||!this.treatFunctionsAsVarInScope(o)&&o.functions.indexOf(t)>-1){n=!0;break}if(o.var.push(t),this.inModule&&1&o.flags&&delete this.undefinedExports[t],259&o.flags)break}n&&this.raiseRecoverable(i,"Identifier '"+t+"' has already been declared")},to.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},to.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},to.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(259&e.flags)return e}},to.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(259&e.flags&&!(16&e.flags))return e}};var tl=function(t,e,i){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new D(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},tu=U.prototype;function tc(t,e,i,n){return t.type=e,t.end=i,this.options.locations&&(t.loc.end=n),this.options.ranges&&(t.range[1]=i),t}tu.startNode=function(){return new tl(this,this.start,this.startLoc)},tu.startNodeAt=function(t,e){return new tl(this,t,e)},tu.finishNode=function(t,e){return tc.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},tu.finishNodeAt=function(t,e,i,n){return tc.call(this,t,e,i,n)},tu.copyNode=function(t){var e=new tl(this,t.start,this.startLoc);for(var i in t)e[i]=t[i];return e};for(var td="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",tf=td+" Extended_Pictographic",tp=tf+" EBase EComp EMod EPres ExtPict",tg={9:td,10:tf,11:tf,12:tp,13:tp,14:tp},tm={9:"",10:"",11:"",12:"",13:"",14:"Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji"},t_="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",tv="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ty=tv+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",tb=ty+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",tx=tb+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",tw=tx+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",tk={9:tv,10:ty,11:tb,12:tx,13:tw,14:tw+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz"},tC={},tS=0,tI=[9,10,11,12,13,14];tS<tI.length;tS+=1)!function(t){var e=tC[t]={binary:L(tg[t]+" "+t_),binaryOfStrings:L(tm[t]),nonBinary:{General_Category:L(t_),Script:L(tk[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}(tI[tS]);var tE=U.prototype,tT=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=tC[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function tA(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function tP(t){return t>=65&&t<=90||t>=97&&t<=122}function tM(t){return tP(t)||95===t}function tO(t){return t>=48&&t<=57}function tL(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function tN(t){return t>=65&&t<=70?10+(t-65):t>=97&&t<=102?10+(t-97):t-48}function tR(t){return t>=48&&t<=55}tT.prototype.reset=function(t,e,i){var n=-1!==i.indexOf("v"),r=-1!==i.indexOf("u");this.start=0|t,this.source=e+"",this.flags=i,n&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)},tT.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},tT.prototype.at=function(t,e){void 0===e&&(e=!1);var i=this.source,n=i.length;if(t>=n)return -1;var r=i.charCodeAt(t);if(!(e||this.switchU)||r<=55295||r>=57344||t+1>=n)return r;var s=i.charCodeAt(t+1);return s>=56320&&s<=57343?(r<<10)+s-56613888:r},tT.prototype.nextIndex=function(t,e){void 0===e&&(e=!1);var i=this.source,n=i.length;if(t>=n)return n;var r,s=i.charCodeAt(t);return!(e||this.switchU)||s<=55295||s>=57344||t+1>=n||(r=i.charCodeAt(t+1))<56320||r>57343?t+1:t+2},tT.prototype.current=function(t){return void 0===t&&(t=!1),this.at(this.pos,t)},tT.prototype.lookahead=function(t){return void 0===t&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},tT.prototype.advance=function(t){void 0===t&&(t=!1),this.pos=this.nextIndex(this.pos,t)},tT.prototype.eat=function(t,e){return void 0===e&&(e=!1),this.current(e)===t&&(this.advance(e),!0)},tT.prototype.eatChars=function(t,e){void 0===e&&(e=!1);for(var i=this.pos,n=0;n<t.length;n+=1){var r=t[n],s=this.at(i,e);if(-1===s||s!==r)return!1;i=this.nextIndex(i,e)}return this.pos=i,!0},tE.validateRegExpFlags=function(t){for(var e=t.validFlags,i=t.flags,n=!1,r=!1,s=0;s<i.length;s++){var a=i.charAt(s);-1===e.indexOf(a)&&this.raise(t.start,"Invalid regular expression flag"),i.indexOf(a,s+1)>-1&&this.raise(t.start,"Duplicate regular expression flag"),"u"===a&&(n=!0),"v"===a&&(r=!0)}this.options.ecmaVersion>=15&&n&&r&&this.raise(t.start,"Invalid regular expression flag")},tE.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},tE.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,i=t.backReferenceNames;e<i.length;e+=1){var n=i[e];-1===t.groupNames.indexOf(n)&&t.raise("Invalid named capture referenced")}},tE.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},tE.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},tE.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):(t.switchU?!!this.regexp_eatAtom(t):!!this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},tE.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var i=!1;if(this.options.ecmaVersion>=9&&(i=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!i,!0}return t.pos=e,!1},tE.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},tE.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},tE.regexp_eatBracedQuantifier=function(t,e){var i=t.pos;if(t.eat(123)){var n=0,r=-1;if(this.regexp_eatDecimalDigits(t)&&(n=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue),t.eat(125)))return -1!==r&&r<n&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=i}return!1},tE.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},tE.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},tE.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},tE.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},tE.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},tE.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},tE.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!tA(e)&&(t.lastIntValue=e,t.advance(),!0)},tE.regexp_eatPatternCharacters=function(t){for(var e=t.pos,i=0;-1!==(i=t.current())&&!tA(i);)t.advance();return t.pos!==e},tE.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return -1!==e&&36!==e&&(!(e>=40)||!(e<=43))&&46!==e&&63!==e&&91!==e&&94!==e&&124!==e&&(t.advance(),!0)},tE.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t)){-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),t.groupNames.push(t.lastStringValue);return}t.raise("Invalid group")}},tE.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},tE.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=N(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=N(t.lastIntValue);return!0}return!1},tE.regexp_eatRegExpIdentifierStart=function(t){var e,i=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return(t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),f(e=r,!0)||36===e||95===e)?(t.lastIntValue=r,!0):(t.pos=i,!1)},tE.regexp_eatRegExpIdentifierPart=function(t){var e,i=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return(t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),p(e=r,!0)||36===e||95===e||8204===e||8205===e)?(t.lastIntValue=r,!0):(t.pos=i,!1)},tE.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},tE.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var i=t.lastIntValue;if(t.switchU)return i>t.maxBackReference&&(t.maxBackReference=i),!0;if(i<=t.numCapturingParens)return!0;t.pos=e}return!1},tE.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},tE.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},tE.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},tE.regexp_eatZero=function(t){return!(48!==t.current()||tO(t.lookahead()))&&(t.lastIntValue=0,t.advance(),!0)},tE.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},tE.regexp_eatControlLetter=function(t){var e=t.current();return!!tP(e)&&(t.lastIntValue=e%32,t.advance(),!0)},tE.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){void 0===e&&(e=!1);var i=t.pos,n=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r,s=t.lastIntValue;if(n&&s>=55296&&s<=56319){var a=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var o=t.lastIntValue;if(o>=56320&&o<=57343)return t.lastIntValue=(s-55296)*1024+(o-56320)+65536,!0}t.pos=a,t.lastIntValue=s}return!0}if(n&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&(r=t.lastIntValue)>=0&&r<=1114111)return!0;n&&t.raise("Invalid unicode escape"),t.pos=i}return!1},tE.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return 99!==e&&(!t.switchN||107!==e)&&(t.lastIntValue=e,t.advance(),!0)},tE.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do t.lastIntValue=10*t.lastIntValue+(e-48),t.advance();while((e=t.current())>=48&&e<=57)return!0}return!1},tE.regexp_eatCharacterClassEscape=function(t){var e,i=t.current();if(100===i||68===i||115===i||83===i||119===i||87===i)return t.lastIntValue=-1,t.advance(),1;var n=!1;if(t.switchU&&this.options.ecmaVersion>=9&&((n=80===i)||112===i)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&(e=this.regexp_eatUnicodePropertyValueExpression(t))&&t.eat(125))return n&&2===e&&t.raise("Invalid property name"),e;t.raise("Invalid property name")}return 0},tE.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var i=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var n=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,i,n),1}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,r)}return 0},tE.regexp_validateUnicodePropertyNameAndValue=function(t,e,i){M(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(i)||t.raise("Invalid property value")},tE.regexp_validateUnicodePropertyNameOrValue=function(t,e){return t.unicodeProperties.binary.test(e)?1:t.switchV&&t.unicodeProperties.binaryOfStrings.test(e)?2:void t.raise("Invalid property name")},tE.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";tM(e=t.current());)t.lastStringValue+=N(e),t.advance();return""!==t.lastStringValue},tE.regexp_eatUnicodePropertyValue=function(t){var e,i=0;for(t.lastStringValue="";tM(e=i=t.current())||tO(e);)t.lastStringValue+=N(i),t.advance();return""!==t.lastStringValue},tE.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},tE.regexp_eatCharacterClass=function(t){if(t.eat(91)){var e=t.eat(94),i=this.regexp_classContents(t);return t.eat(93)||t.raise("Unterminated character class"),e&&2===i&&t.raise("Negated character class may contain strings"),!0}return!1},tE.regexp_classContents=function(t){return 93===t.current()?1:t.switchV?this.regexp_classSetExpression(t):(this.regexp_nonEmptyClassRanges(t),1)},tE.regexp_nonEmptyClassRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var i=t.lastIntValue;t.switchU&&(-1===e||-1===i)&&t.raise("Invalid character class"),-1!==e&&-1!==i&&e>i&&t.raise("Range out of order in character class")}}},tE.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var i=t.current();(99===i||tR(i))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var n=t.current();return 93!==n&&(t.lastIntValue=n,t.advance(),!0)},tE.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},tE.regexp_classSetExpression=function(t){var e,i=1;if(this.regexp_eatClassSetRange(t));else if(e=this.regexp_eatClassSetOperand(t)){2===e&&(i=2);for(var n=t.pos;t.eatChars([38,38]);){if(38!==t.current()&&(e=this.regexp_eatClassSetOperand(t))){2!==e&&(i=1);continue}t.raise("Invalid character in character class")}if(n!==t.pos)return i;for(;t.eatChars([45,45]);)this.regexp_eatClassSetOperand(t)||t.raise("Invalid character in character class");if(n!==t.pos)return i}else t.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(t)){if(!(e=this.regexp_eatClassSetOperand(t)))return i;2===e&&(i=2)}},tE.regexp_eatClassSetRange=function(t){var e=t.pos;if(this.regexp_eatClassSetCharacter(t)){var i=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassSetCharacter(t)){var n=t.lastIntValue;return -1!==i&&-1!==n&&i>n&&t.raise("Range out of order in character class"),!0}t.pos=e}return!1},tE.regexp_eatClassSetOperand=function(t){return this.regexp_eatClassSetCharacter(t)?1:this.regexp_eatClassStringDisjunction(t)||this.regexp_eatNestedClass(t)},tE.regexp_eatNestedClass=function(t){var e=t.pos;if(t.eat(91)){var i=t.eat(94),n=this.regexp_classContents(t);if(t.eat(93))return i&&2===n&&t.raise("Negated character class may contain strings"),n;t.pos=e}if(t.eat(92)){var r=this.regexp_eatCharacterClassEscape(t);if(r)return r;t.pos=e}return null},tE.regexp_eatClassStringDisjunction=function(t){var e=t.pos;if(t.eatChars([92,113])){if(t.eat(123)){var i=this.regexp_classStringDisjunctionContents(t);if(t.eat(125))return i}else t.raise("Invalid escape");t.pos=e}return null},tE.regexp_classStringDisjunctionContents=function(t){for(var e=this.regexp_classString(t);t.eat(124);)2===this.regexp_classString(t)&&(e=2);return e},tE.regexp_classString=function(t){for(var e=0;this.regexp_eatClassSetCharacter(t);)e++;return 1===e?1:2},tE.regexp_eatClassSetCharacter=function(t){var e,i=t.pos;if(t.eat(92))return!!(this.regexp_eatCharacterEscape(t)||this.regexp_eatClassSetReservedPunctuator(t))||(t.eat(98)?(t.lastIntValue=8,!0):(t.pos=i,!1));var n=t.current();return!(n<0||n===t.lookahead()&&(33===n||n>=35&&n<=38||n>=42&&n<=44||46===n||n>=58&&n<=64||94===n||96===n||126===n)||40===(e=n)||41===e||45===e||47===e||e>=91&&e<=93||e>=123&&e<=125)&&(t.advance(),t.lastIntValue=n,!0)},tE.regexp_eatClassSetReservedPunctuator=function(t){var e=t.current();return!!(33===e||35===e||37===e||38===e||44===e||45===e||e>=58&&e<=62||64===e||96===e||126===e)&&(t.lastIntValue=e,t.advance(),!0)},tE.regexp_eatClassControlLetter=function(t){var e=t.current();return(!!tO(e)||95===e)&&(t.lastIntValue=e%32,t.advance(),!0)},tE.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},tE.regexp_eatDecimalDigits=function(t){var e=t.pos,i=0;for(t.lastIntValue=0;tO(i=t.current());)t.lastIntValue=10*t.lastIntValue+(i-48),t.advance();return t.pos!==e},tE.regexp_eatHexDigits=function(t){var e=t.pos,i=0;for(t.lastIntValue=0;tL(i=t.current());)t.lastIntValue=16*t.lastIntValue+tN(i),t.advance();return t.pos!==e},tE.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var i=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*i+t.lastIntValue:t.lastIntValue=8*e+i}else t.lastIntValue=e;return!0}return!1},tE.regexp_eatOctalDigit=function(t){var e=t.current();return tR(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},tE.regexp_eatFixedHexDigits=function(t,e){var i=t.pos;t.lastIntValue=0;for(var n=0;n<e;++n){var r=t.current();if(!tL(r))return t.pos=i,!1;t.lastIntValue=16*t.lastIntValue+tN(r),t.advance()}return!0};var tz=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new D(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},tD=U.prototype;function tB(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}tD.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new tz(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},tD.getToken=function(){return this.next(),new tz(this)},"undefined"!=typeof Symbol&&(tD[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===x.eof,value:e}}}}),tD.nextToken=function(){var t=this.curContext();return(t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)?this.finishToken(x.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},tD.readToken=function(t){return f(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},tD.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?t:(t<<10)+e-56613888},tD.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,i=this.input.indexOf("*/",this.pos+=2);if(-1===i&&this.raise(this.pos-2,"Unterminated comment"),this.pos=i+2,this.options.locations)for(var n=void 0,r=e;(n=S(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=n;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,i),e,this.pos,t,this.curPosition())},tD.skipLineComment=function(t){for(var e=this.pos,i=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!C(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,i,this.curPosition())},tD.skipSpace=function(){e:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(t>8&&t<14||t>=5760&&I.test(String.fromCharCode(t)))++this.pos;else break e}}},tD.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var i=this.type;this.type=t,this.value=e,this.updateContext(i)},tD.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(x.ellipsis)):(++this.pos,this.finishToken(x.dot))},tD.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(x.assign,2):this.finishOp(x.slash,1)},tD.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),i=1,n=42===t?x.star:x.modulo;return(this.options.ecmaVersion>=7&&42===t&&42===e&&(++i,n=x.starstar,e=this.input.charCodeAt(this.pos+2)),61===e)?this.finishOp(x.assign,i+1):this.finishOp(n,i)},tD.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(x.assign,3):this.finishOp(124===t?x.logicalOR:x.logicalAND,2):61===e?this.finishOp(x.assign,2):this.finishOp(124===t?x.bitwiseOR:x.bitwiseAND,1)},tD.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(x.assign,2):this.finishOp(x.bitwiseXOR,1)},tD.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45===e&&!this.inModule&&62===this.input.charCodeAt(this.pos+2)&&(0===this.lastTokEnd||w.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(x.incDec,2):61===e?this.finishOp(x.assign,2):this.finishOp(x.plusMin,1)},tD.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),i=1;return e===t?(i=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+i))?this.finishOp(x.assign,i+1):this.finishOp(x.bitShift,i):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(i=2),this.finishOp(x.relational,i)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},tD.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(x.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(x.arrow)):this.finishOp(61===t?x.eq:x.prefix,1)},tD.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(46===e){var i=this.input.charCodeAt(this.pos+2);if(i<48||i>57)return this.finishOp(x.questionDot,2)}if(63===e)return t>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(x.assign,3):this.finishOp(x.coalesce,2)}return this.finishOp(x.question,1)},tD.readToken_numberSign=function(){var t=this.options.ecmaVersion,e=35;if(t>=13&&(++this.pos,f(e=this.fullCharCodeAtPos(),!0)||92===e))return this.finishToken(x.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+N(e)+"'")},tD.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(x.parenL);case 41:return++this.pos,this.finishToken(x.parenR);case 59:return++this.pos,this.finishToken(x.semi);case 44:return++this.pos,this.finishToken(x.comma);case 91:return++this.pos,this.finishToken(x.bracketL);case 93:return++this.pos,this.finishToken(x.bracketR);case 123:return++this.pos,this.finishToken(x.braceL);case 125:return++this.pos,this.finishToken(x.braceR);case 58:return++this.pos,this.finishToken(x.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(x.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(x.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+N(t)+"'")},tD.finishOp=function(t,e){var i=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,i)},tD.readRegexp=function(){for(var t,e,i=this.pos;;){this.pos>=this.input.length&&this.raise(i,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(w.test(n)&&this.raise(i,"Unterminated regular expression"),t)t=!1;else{if("["===n)e=!0;else if("]"===n&&e)e=!1;else if("/"===n&&!e)break;t="\\"===n}++this.pos}var r=this.input.slice(i,this.pos);++this.pos;var s=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(s);var o=this.regexpState||(this.regexpState=new tT(this));o.reset(i,r,a),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var h=null;try{h=new RegExp(r,a)}catch(t){}return this.finishToken(x.regexp,{pattern:r,flags:a,value:h})},tD.readInt=function(t,e,i){for(var n=this.options.ecmaVersion>=12&&void 0===e,r=i&&48===this.input.charCodeAt(this.pos),s=this.pos,a=0,o=0,h=0,l=null==e?1/0:e;h<l;++h,++this.pos){var u=this.input.charCodeAt(this.pos),c=void 0;if(n&&95===u){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===o&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===h&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=u;continue}if((c=u>=97?u-97+10:u>=65?u-65+10:u>=48&&u<=57?u-48:1/0)>=t)break;o=u,a=a*t+c}return(n&&95===o&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||null!=e&&this.pos-s!==e)?null:a},tD.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var i=this.readInt(t);return null==i&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(i=tB(this.input.slice(e,this.pos)),++this.pos):f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(x.num,i)},tD.readNumber=function(t){var e,i=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(i,"Invalid number");var n=this.pos-i>=2&&48===this.input.charCodeAt(i);n&&this.strict&&this.raise(i,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===r){var s=tB(this.input.slice(i,this.pos));return++this.pos,f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(x.num,s)}n&&/[89]/.test(this.input.slice(i,this.pos))&&(n=!1),46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||((43===(r=this.input.charCodeAt(++this.pos))||45===r)&&++this.pos,null===this.readInt(10)&&this.raise(i,"Invalid number")),f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=(e=this.input.slice(i,this.pos),n?parseInt(e,8):parseFloat(e.replace(/_/g,"")));return this.finishToken(x.num,a)},tD.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},tD.readString=function(t){for(var e="",i=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===t)break;92===n?(e+=this.input.slice(i,this.pos)+this.readEscapedChar(!1),i=this.pos):8232===n||8233===n?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(C(n)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(i,this.pos++),this.finishToken(x.string,e)};var tj={};tD.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t===tj)this.readInvalidTemplateToken();else throw t}this.inTemplateElement=!1},tD.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw tj;this.raise(t,e)},tD.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var i=this.input.charCodeAt(this.pos);if(96===i||36===i&&123===this.input.charCodeAt(this.pos+1)){if(this.pos===this.start&&(this.type===x.template||this.type===x.invalidTemplate)){if(36===i)return this.pos+=2,this.finishToken(x.dollarBraceL);return++this.pos,this.finishToken(x.backQuote)}return t+=this.input.slice(e,this.pos),this.finishToken(x.template,t)}if(92===i)t+=this.input.slice(e,this.pos)+this.readEscapedChar(!0),e=this.pos;else if(C(i)){switch(t+=this.input.slice(e,this.pos),++this.pos,i){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(i)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},tD.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(x.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},tD.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return N(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){var i=this.pos-1;this.invalidStringToken(i,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(n,8);return r>255&&(r=parseInt(n=n.slice(0,-1),8)),this.pos+=n.length-1,e=this.input.charCodeAt(this.pos),("0"!==n||56===e||57===e)&&(this.strict||t)&&this.invalidStringToken(this.pos-1-n.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}if(C(e))return"";return String.fromCharCode(e)}},tD.readHexChar=function(t){var e=this.pos,i=this.readInt(16,t);return null===i&&this.invalidStringToken(e,"Bad character escape sequence"),i},tD.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,i=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(p(r,n))this.pos+=r<=65535?1:2;else if(92===r){this.containsEsc=!0,t+=this.input.slice(i,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(e?f:p)(a,n)||this.invalidStringToken(s,"Invalid Unicode escape"),t+=N(a),i=this.pos}else break;e=!1}return t+this.input.slice(i,this.pos)},tD.readWord=function(){var t=this.readWord1(),e=x.name;return this.keywords.test(t)&&(e=y[t]),this.finishToken(e,t)};var tV="8.10.0";function tF(t,e){return U.parse(t,e)}function tU(t,e,i){return U.parseExpressionAt(t,e,i)}function tq(t,e){return U.tokenizer(t,e)}U.acorn={Parser:U,version:tV,defaultOptions:j,Position:z,SourceLocation:D,getLineInfo:B,Node:tl,TokenType:g,tokTypes:x,keywordTypes:y,TokContext:te,tokContexts:ti,isIdentifierChar:p,isIdentifierStart:f,Token:tz,isNewLine:C,lineBreak:w,lineBreakG:k,nonASCIIwhitespace:I}}),c("7yz2R",function(t,e){});var d=(u("hFpCu"),u("hFpCu"));class f{constructor(t,e){this.coordinates=[t,e],this.r=t,this.c=e}toString(){return this.coordinates.join(",")}static toAxialCoordinates(t){return new p(t.c-(t.r-(1&t.r))/2,t.r)}}class p{constructor(t,e,i){i||(i=-t-e),this.coordinates=[t,e,i],this.q=t,this.r=e,this.s=i}add(t){return p.add(this,t)}equals(t){return this.q===t.q&&this.r===t.r&&this.s===t.s}isNeighbor(t){return p.isNeighbor(this,t)}neighbor(t){return p.neighbor(this,t)}toString(){return this.coordinates.join(",")}static add(t,e){return new p(t.q+e.q,t.r+e.r)}static direction(t){return 0===t&&(t=6),p.directions[6-t]}static directions=[new p(1,0),new p(1,-1),new p(0,-1),new p(-1,0),new p(-1,1),new p(0,1)];static isNeighbor(t,e){return p.directions.map(e=>p.add(t,e)).some(t=>t.equals(e))}static neighbor(t,e){return p.add(t,p.direction(e))}static toOffsetCoordinates(t){return new f(t.q+(t.r-(1&t.r))/2,t.r)}}var d=u("hFpCu"),g={};function m(t){let e=t.length;for(;--e>=0;)t[e]=0}!function(t,e){let i,n,r,s,a;class o{constructor(t){this.selfOptions=t||{},this.pipes={}}options(t){return t&&(this.selfOptions=t),this.selfOptions}pipe(t,e){let i=e;if("string"==typeof t){if(void 0===i)return this.pipes[t];this.pipes[t]=i}if(t&&t.name){if((i=t).processor===this)return i;this.pipes[i.name]=i}return i.processor=this,i}process(t,e){let i,n,r=t;r.options=this.options();let s=e||t.pipe||"default";for(;s;)void 0!==r.nextAfterChildren&&(r.next=r.nextAfterChildren,r.nextAfterChildren=null),"string"==typeof s&&(s=this.pipe(s)),s.process(r),n=r,i=s,s=null,r&&r.next&&(r=r.next,s=n.nextPipe||r.pipe||i);return r.hasResult?r.result:void 0}}class h{constructor(t){this.name=t,this.filters=[]}process(t){if(!this.processor)throw Error("add this pipe to a processor before using it");let e=this.debug,i=this.filters.length;for(let n=0;n<i;n++){let i=this.filters[n];if(e&&this.log(`filter: ${i.filterName}`),i(t),"object"==typeof t&&t.exiting){t.exiting=!1;break}}!t.next&&this.resultCheck&&this.resultCheck(t)}log(t){console.log(`[jsondiffpatch] ${this.name} pipe, ${t}`)}append(){return this.filters.push(...arguments),this}prepend(){return this.filters.unshift(...arguments),this}indexOf(t){if(!t)throw Error("a filter name is required");for(let e=0;e<this.filters.length;e++)if(this.filters[e].filterName===t)return e;throw Error(`filter not found: ${t}`)}list(){return this.filters.map(t=>t.filterName)}after(t){let e=this.indexOf(t),i=Array.prototype.slice.call(arguments,1);if(!i.length)throw Error("a filter is required");return i.unshift(e+1,0),Array.prototype.splice.apply(this.filters,i),this}before(t){let e=this.indexOf(t),i=Array.prototype.slice.call(arguments,1);if(!i.length)throw Error("a filter is required");return i.unshift(e,0),Array.prototype.splice.apply(this.filters,i),this}replace(t){let e=this.indexOf(t),i=Array.prototype.slice.call(arguments,1);if(!i.length)throw Error("a filter is required");return i.unshift(e,1),Array.prototype.splice.apply(this.filters,i),this}remove(t){let e=this.indexOf(t);return this.filters.splice(e,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(t){if(!1===t){this.resultCheck=null;return}if(this.resultCheck)return;let e=this;return this.resultCheck=t=>{if(!t.hasResult){console.log(t);let i=Error(`${e.name} failed`);throw i.noResult=!0,i}},this}}class l{setResult(t){return this.result=t,this.hasResult=!0,this}exit(){return this.exiting=!0,this}switchTo(t,e){return"string"==typeof t||t instanceof h?this.nextPipe=t:(this.next=t,e&&(this.nextPipe=e)),this}push(t,e){return t.parent=this,void 0!==e&&(t.childName=e),t.root=this.root||this,t.options=t.options||this.options,this.children?(this.children[this.children.length-1].next=t,this.children.push(t)):(this.children=[t],this.nextAfterChildren=this.next||null,this.next=t),t.next=this,this}}let u="function"==typeof Array.isArray?Array.isArray:t=>t instanceof Array;function c(t){if("object"!=typeof t)return t;if(null===t)return null;if(u(t))return t.map(c);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return function(t){let e=/^\/(.*)\/([gimyu]*)$/.exec(t.toString());return new RegExp(e[1],e[2])}(t);let e={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=c(t[i]));return e}class d extends l{constructor(t,e){super(),this.left=t,this.right=e,this.pipe="diff"}setResult(t){if(this.options.cloneDiffValues&&"object"==typeof t){let e="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:c;"object"==typeof t[0]&&(t[0]=e(t[0])),"object"==typeof t[1]&&(t[1]=e(t[1]))}return l.prototype.setResult.apply(this,arguments)}}class f extends l{constructor(t,e){super(),this.left=t,this.delta=e,this.pipe="patch"}}class p extends l{constructor(t){super(),this.delta=t,this.pipe="reverse"}}let g="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},m=function(t){if(t.left===t.right){t.setResult(void 0).exit();return}if(void 0===t.left){if("function"==typeof t.right)throw Error("functions are not supported");t.setResult([t.right]).exit();return}if(void 0===t.right){t.setResult([t.left,0,0]).exit();return}if("function"==typeof t.left||"function"==typeof t.right)throw Error("functions are not supported");if(t.leftType=null===t.left?"null":typeof t.left,t.rightType=null===t.right?"null":typeof t.right,t.leftType!==t.rightType||"boolean"===t.leftType||"number"===t.leftType||("object"===t.leftType&&(t.leftIsArray=g(t.left)),"object"===t.rightType&&(t.rightIsArray=g(t.right)),t.leftIsArray!==t.rightIsArray)){t.setResult([t.left,t.right]).exit();return}t.left instanceof RegExp&&(t.right instanceof RegExp?t.setResult([t.left.toString(),t.right.toString()]).exit():t.setResult([t.left,t.right]).exit())};m.filterName="trivial";let _=function(t){if(void 0===t.delta){t.setResult(t.left).exit();return}if(t.nested=!g(t.delta),!t.nested){if(1===t.delta.length){t.setResult(t.delta[0]).exit();return}if(2===t.delta.length){if(t.left instanceof RegExp){let e=/^\/(.*)\/([gimyu]+)$/.exec(t.delta[1]);if(e){t.setResult(new RegExp(e[1],e[2])).exit();return}}t.setResult(t.delta[1]).exit();return}3===t.delta.length&&0===t.delta[2]&&t.setResult(void 0).exit()}};_.filterName="trivial";let v=function(t){if(void 0===t.delta){t.setResult(t.delta).exit();return}if(t.nested=!g(t.delta),!t.nested){if(1===t.delta.length){t.setResult([t.delta[0],0,0]).exit();return}if(2===t.delta.length){t.setResult([t.delta[1],t.delta[0]]).exit();return}3===t.delta.length&&0===t.delta[2]&&t.setResult([t.delta[0]]).exit()}};function y(t){let e;if(!t||!t.children)return;let i=t.children.length,n=t.result;for(let r=0;r<i;r++)void 0!==(e=t.children[r]).result&&((n=n||{})[e.childName]=e.result);n&&t.leftIsArray&&(n._t="a"),t.setResult(n).exit()}function b(t){let e,i;if(t.leftIsArray||"object"!==t.leftType)return;let n=t.options.propertyFilter;for(e in t.left)Object.prototype.hasOwnProperty.call(t.left,e)&&(!n||n(e,t))&&(i=new d(t.left[e],t.right[e]),t.push(i,e));for(e in t.right)Object.prototype.hasOwnProperty.call(t.right,e)&&(!n||n(e,t))&&void 0===t.left[e]&&(i=new d(void 0,t.right[e]),t.push(i,e));if(!t.children||0===t.children.length){t.setResult(void 0).exit();return}t.exit()}v.filterName="trivial",y.filterName="collectChildren",b.filterName="objects";let x=function(t){let e,i;if(t.nested&&!t.delta._t){for(e in t.delta)i=new f(t.left[e],t.delta[e]),t.push(i,e);t.exit()}};x.filterName="objects";let w=function(t){let e;if(!t||!t.children||t.delta._t)return;let i=t.children.length;for(let n=0;n<i;n++)e=t.children[n],Object.prototype.hasOwnProperty.call(t.left,e.childName)&&void 0===e.result?delete t.left[e.childName]:t.left[e.childName]!==e.result&&(t.left[e.childName]=e.result);t.setResult(t.left).exit()};w.filterName="collectChildren";let k=function(t){let e,i;if(t.nested&&!t.delta._t){for(e in t.delta)i=new p(t.delta[e]),t.push(i,e);t.exit()}};function C(t){let e;if(!t||!t.children||t.delta._t)return;let i=t.children.length,n={};for(let r=0;r<i;r++)n[(e=t.children[r]).childName]!==e.result&&(n[e.childName]=e.result);t.setResult(n).exit()}k.filterName="objects",C.filterName="collectChildren";let S=function(t,e,i,n){return t[i]===e[n]},I=function(t,e,i,n){let r,s;let a=t.length,o=e.length,h=[a+1];for(r=0;r<a+1;r++)for(s=0,h[r]=[o+1];s<o+1;s++)h[r][s]=0;for(r=1,h.match=i;r<a+1;r++)for(s=1;s<o+1;s++)i(t,e,r-1,s-1,n)?h[r][s]=h[r-1][s-1]+1:h[r][s]=Math.max(h[r-1][s],h[r][s-1]);return h},E=function(t,e,i,n){let r=e.length,s=i.length,a={sequence:[],indices1:[],indices2:[]};for(;0!==r&&0!==s;)t.match(e,i,r-1,s-1,n)?(a.sequence.unshift(e[r-1]),a.indices1.unshift(r-1),a.indices2.unshift(s-1),--r,--s):t[r][s-1]>t[r-1][s]?--s:--r;return a};var T,A,P={get:function(t,e,i,n){let r=n||{},s=E(I(t,e,i||S,r),t,e,r);return"string"==typeof t&&"string"==typeof e&&(s.sequence=s.sequence.join("")),s}};let M="function"==typeof Array.isArray?Array.isArray:t=>t instanceof Array,O="function"==typeof Array.prototype.indexOf?(t,e)=>t.indexOf(e):(t,e)=>{let i=t.length;for(let n=0;n<i;n++)if(t[n]===e)return n;return -1};function L(t,e,i,n,r){let s,a;let o=t[i],h=e[n];if(o===h)return!0;if("object"!=typeof o||"object"!=typeof h)return!1;let l=r.objectHash;return l?("number"==typeof i?(r.hashCache1=r.hashCache1||[],void 0===(s=r.hashCache1[i])&&(r.hashCache1[i]=s=l(o,i))):s=l(o),void 0!==s&&("number"==typeof n?(r.hashCache2=r.hashCache2||[],void 0===(a=r.hashCache2[n])&&(r.hashCache2[n]=a=l(h,n))):a=l(h),void 0!==a&&s===a)):r.matchByPosition&&i===n}let N=function(t){let e,i,n,r,s;if(!t.leftIsArray)return;let a={objectHash:t.options&&t.options.objectHash,matchByPosition:t.options&&t.options.matchByPosition},o=0,h=0,l=t.left,u=t.right,c=l.length,f=u.length;for(c>0&&f>0&&!a.objectHash&&"boolean"!=typeof a.matchByPosition&&(a.matchByPosition=!function(t,e,i,n){for(let r=0;r<i;r++){let i=t[r];for(let t=0;t<n;t++){let n=e[t];if(r!==t&&i===n)return!0}}}(l,u,c,f));o<c&&o<f&&L(l,u,o,o,a);)e=o,r=new d(t.left[e],t.right[e]),t.push(r,e),o++;for(;h+o<c&&h+o<f&&L(l,u,c-1-h,f-1-h,a);)i=c-1-h,n=f-1-h,r=new d(t.left[i],t.right[n]),t.push(r,n),h++;if(o+h===c){if(c===f){t.setResult(void 0).exit();return}for(s=s||{_t:"a"},e=o;e<f-h;e++)s[e]=[u[e]];t.setResult(s).exit();return}if(o+h===f){for(s=s||{_t:"a"},e=o;e<c-h;e++)s[`_${e}`]=[l[e],0,0];t.setResult(s).exit();return}delete a.hashCache1,delete a.hashCache2;let p=l.slice(o,c-h),g=u.slice(o,f-h),m=P.get(p,g,L,a),_=[];for(s=s||{_t:"a"},e=o;e<c-h;e++)0>O(m.indices1,e-o)&&(s[`_${e}`]=[l[e],0,0],_.push(e));let v=!0;t.options&&t.options.arrays&&!1===t.options.arrays.detectMove&&(v=!1);let y=!1;t.options&&t.options.arrays&&t.options.arrays.includeValueOnMove&&(y=!0);let b=_.length;for(e=o;e<f-h;e++){let h=O(m.indices2,e-o);if(h<0){let h=!1;if(v&&b>0){for(let l=0;l<b;l++)if(L(p,g,(i=_[l])-o,e-o,a)){s[`_${i}`].splice(1,2,e,3),y||(s[`_${i}`][0]=""),n=e,r=new d(t.left[i],t.right[n]),t.push(r,n),_.splice(l,1),h=!0;break}}h||(s[e]=[u[e]])}else i=m.indices1[h]+o,n=m.indices2[h]+o,r=new d(t.left[i],t.right[n]),t.push(r,n)}t.setResult(s).exit()};N.filterName="arrays";let R={numerically:(t,e)=>t-e,numericallyBy:t=>(e,i)=>e[t]-i[t]},z=function(t){let e,i,n;if(!t.nested||"a"!==t.delta._t)return;let r=t.delta,s=t.left,a=[],o=[],h=[];for(e in r)if("_t"!==e){if("_"===e[0]){if(0===r[e][2]||3===r[e][2])a.push(parseInt(e.slice(1),10));else throw Error(`only removal or move can be applied at original array indices, invalid diff type: ${r[e][2]}`)}else 1===r[e].length?o.push({index:parseInt(e,10),value:r[e][0]}):h.push({index:parseInt(e,10),delta:r[e]})}for(e=(a=a.sort(R.numerically)).length-1;e>=0;e--){i=a[e];let t=r[`_${i}`],n=s.splice(i,1)[0];3===t[2]&&o.push({index:t[1],value:n})}let l=(o=o.sort(R.numericallyBy("index"))).length;for(e=0;e<l;e++){let t=o[e];s.splice(t.index,0,t.value)}let u=h.length;if(u>0)for(e=0;e<u;e++){let i=h[e];n=new f(t.left[i.index],i.delta),t.push(n,i.index)}if(!t.children){t.setResult(t.left).exit();return}t.exit()};z.filterName="arrays";let D=function(t){let e;if(!t||!t.children||"a"!==t.delta._t)return;let i=t.children.length;for(let n=0;n<i;n++)e=t.children[n],t.left[e.childName]=e.result;t.setResult(t.left).exit()};D.filterName="arraysCollectChildren";let B=function(t){let e,i;if(!t.nested){3===t.delta[2]&&(t.newName=`_${t.delta[1]}`,t.setResult([t.delta[0],parseInt(t.childName.substr(1),10),3]).exit());return}if("a"===t.delta._t){for(e in t.delta)"_t"!==e&&(i=new p(t.delta[e]),t.push(i,e));t.exit()}};B.filterName="arrays";let j=(t,e,i)=>{if("string"==typeof e&&"_"===e[0])return parseInt(e.substr(1),10);if(M(i)&&0===i[2])return`_${e}`;let n=+e;for(let i in t){let r=t[i];if(M(r)){if(3===r[2]){let t=parseInt(i.substr(1),10),s=r[1];if(s===+e)return t;t<=n&&s>n?n++:t>=n&&s<n&&n--}else 0===r[2]?parseInt(i.substr(1),10)<=n&&n++:1===r.length&&i<=n&&n--}}return n};function V(t){let e;if(!t||!t.children||"a"!==t.delta._t)return;let i=t.children.length,n={_t:"a"};for(let r=0;r<i;r++){let i=(e=t.children[r]).newName;void 0===i&&(i=j(t.delta,e.childName,e.result)),n[i]!==e.result&&(n[i]=e.result)}t.setResult(n).exit()}V.filterName="arraysCollectChildren";let F=function(t){t.left instanceof Date?(t.right instanceof Date?t.left.getTime()!==t.right.getTime()?t.setResult([t.left,t.right]):t.setResult(void 0):t.setResult([t.left,t.right]),t.exit()):t.right instanceof Date&&t.setResult([t.left,t.right]).exit()};F.filterName="dates";var U={exports:{}};(T=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}).Diff=function(t,e){return[t,e]},T.prototype.diff_main=function(t,e,i,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==t||null==e)throw Error("Null input. (diff_main)");if(t==e)return t?[new T.Diff(0,t)]:[];void 0===i&&(i=!0);var s=i,a=this.diff_commonPrefix(t,e),o=t.substring(0,a);t=t.substring(a),e=e.substring(a),a=this.diff_commonSuffix(t,e);var h=t.substring(t.length-a);t=t.substring(0,t.length-a),e=e.substring(0,e.length-a);var l=this.diff_compute_(t,e,s,r);return o&&l.unshift(new T.Diff(0,o)),h&&l.push(new T.Diff(0,h)),this.diff_cleanupMerge(l),l},T.prototype.diff_compute_=function(t,e,i,n){if(!t)return[new T.Diff(1,e)];if(!e)return[new T.Diff(-1,t)];var r,s=t.length>e.length?t:e,a=t.length>e.length?e:t,o=s.indexOf(a);if(-1!=o)return r=[new T.Diff(1,s.substring(0,o)),new T.Diff(0,a),new T.Diff(1,s.substring(o+a.length))],t.length>e.length&&(r[0][0]=r[2][0]=-1),r;if(1==a.length)return[new T.Diff(-1,t),new T.Diff(1,e)];var h=this.diff_halfMatch_(t,e);if(h){var l=h[0],u=h[1],c=h[2],d=h[3],f=h[4],p=this.diff_main(l,c,i,n),g=this.diff_main(u,d,i,n);return p.concat([new T.Diff(0,f)],g)}return i&&t.length>100&&e.length>100?this.diff_lineMode_(t,e,n):this.diff_bisect_(t,e,n)},T.prototype.diff_lineMode_=function(t,e,i){var n=this.diff_linesToChars_(t,e);t=n.chars1,e=n.chars2;var r=n.lineArray,s=this.diff_main(t,e,!1,i);this.diff_charsToLines_(s,r),this.diff_cleanupSemantic(s),s.push(new T.Diff(0,""));for(var a=0,o=0,h=0,l="",u="";a<s.length;){switch(s[a][0]){case 1:h++,u+=s[a][1];break;case -1:o++,l+=s[a][1];break;case 0:if(o>=1&&h>=1){s.splice(a-o-h,o+h),a=a-o-h;for(var c=this.diff_main(l,u,!1,i),d=c.length-1;d>=0;d--)s.splice(a,0,c[d]);a+=c.length}h=0,o=0,l="",u=""}a++}return s.pop(),s},T.prototype.diff_bisect_=function(t,e,i){for(var n=t.length,r=e.length,s=Math.ceil((n+r)/2),a=2*s,o=Array(a),h=Array(a),l=0;l<a;l++)o[l]=-1,h[l]=-1;o[s+1]=0,h[s+1]=0;for(var u=n-r,c=u%2!=0,d=0,f=0,p=0,g=0,m=0;m<s&&!(new Date().getTime()>i);m++){for(var _=-m+d;_<=m-f;_+=2){for(var v,y=s+_,b=(v=_==-m||_!=m&&o[y-1]<o[y+1]?o[y+1]:o[y-1]+1)-_;v<n&&b<r&&t.charAt(v)==e.charAt(b);)v++,b++;if(o[y]=v,v>n)f+=2;else if(b>r)d+=2;else if(c){var x=s+u-_;if(x>=0&&x<a&&-1!=h[x]){var w=n-h[x];if(v>=w)return this.diff_bisectSplit_(t,e,v,b,i)}}}for(var k=-m+p;k<=m-g;k+=2){for(var w,x=s+k,C=(w=k==-m||k!=m&&h[x-1]<h[x+1]?h[x+1]:h[x-1]+1)-k;w<n&&C<r&&t.charAt(n-w-1)==e.charAt(r-C-1);)w++,C++;if(h[x]=w,w>n)g+=2;else if(C>r)p+=2;else if(!c){var y=s+u-k;if(y>=0&&y<a&&-1!=o[y]){var v=o[y],b=s+v-y;if(v>=(w=n-w))return this.diff_bisectSplit_(t,e,v,b,i)}}}}return[new T.Diff(-1,t),new T.Diff(1,e)]},T.prototype.diff_bisectSplit_=function(t,e,i,n,r){var s=t.substring(0,i),a=e.substring(0,n),o=t.substring(i),h=e.substring(n),l=this.diff_main(s,a,!1,r),u=this.diff_main(o,h,!1,r);return l.concat(u)},T.prototype.diff_linesToChars_=function(t,e){var i=[],n={};function r(t){for(var e="",r=0,a=-1,o=i.length;a<t.length-1;){-1==(a=t.indexOf("\n",r))&&(a=t.length-1);var h=t.substring(r,a+1);(n.hasOwnProperty?n.hasOwnProperty(h):void 0!==n[h])?e+=String.fromCharCode(n[h]):(o==s&&(h=t.substring(r),a=t.length),e+=String.fromCharCode(o),n[h]=o,i[o++]=h),r=a+1}return e}i[0]="";var s=4e4,a=r(t);return s=65535,{chars1:a,chars2:r(e),lineArray:i}},T.prototype.diff_charsToLines_=function(t,e){for(var i=0;i<t.length;i++){for(var n=t[i][1],r=[],s=0;s<n.length;s++)r[s]=e[n.charCodeAt(s)];t[i][1]=r.join("")}},T.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var i=0,n=Math.min(t.length,e.length),r=n,s=0;i<r;)t.substring(s,r)==e.substring(s,r)?s=i=r:n=r,r=Math.floor((n-i)/2+i);return r},T.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var i=0,n=Math.min(t.length,e.length),r=n,s=0;i<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=i=r:n=r,r=Math.floor((n-i)/2+i);return r},T.prototype.diff_commonOverlap_=function(t,e){var i=t.length,n=e.length;if(0==i||0==n)return 0;i>n?t=t.substring(i-n):i<n&&(e=e.substring(0,i));var r=Math.min(i,n);if(t==e)return r;for(var s=0,a=1;;){var o=t.substring(r-a),h=e.indexOf(o);if(-1==h)return s;a+=h,(0==h||t.substring(r-a)==e.substring(0,a))&&(s=a,a++)}},T.prototype.diff_halfMatch_=function(t,e){if(this.Diff_Timeout<=0)return null;var i,n,r,s,a,o=t.length>e.length?t:e,h=t.length>e.length?e:t;if(o.length<4||2*h.length<o.length)return null;var l=this;function u(t,e,i){for(var n,r,s,a,o=t.substring(i,i+Math.floor(t.length/4)),h=-1,u="";-1!=(h=e.indexOf(o,h+1));){var c=l.diff_commonPrefix(t.substring(i),e.substring(h)),d=l.diff_commonSuffix(t.substring(0,i),e.substring(0,h));u.length<d+c&&(u=e.substring(h-d,h)+e.substring(h,h+c),n=t.substring(0,i-d),r=t.substring(i+c),s=e.substring(0,h-d),a=e.substring(h+c))}return 2*u.length>=t.length?[n,r,s,a,u]:null}var c=u(o,h,Math.ceil(o.length/4)),d=u(o,h,Math.ceil(o.length/2));return c||d?(i=d?c&&c[4].length>d[4].length?c:d:c,t.length>e.length?(n=i[0],r=i[1],s=i[2],a=i[3]):(s=i[0],a=i[1],n=i[2],r=i[3]),[n,r,s,a,i[4]]):null},T.prototype.diff_cleanupSemantic=function(t){for(var e=!1,i=[],n=0,r=null,s=0,a=0,o=0,h=0,l=0;s<t.length;)0==t[s][0]?(i[n++]=s,a=h,o=l,h=0,l=0,r=t[s][1]):(1==t[s][0]?h+=t[s][1].length:l+=t[s][1].length,r&&r.length<=Math.max(a,o)&&r.length<=Math.max(h,l)&&(t.splice(i[n-1],0,new T.Diff(-1,r)),t[i[n-1]+1][0]=1,n--,s=--n>0?i[n-1]:-1,a=0,o=0,h=0,l=0,r=null,e=!0)),s++;for(e&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),s=1;s<t.length;){if(-1==t[s-1][0]&&1==t[s][0]){var u=t[s-1][1],c=t[s][1],d=this.diff_commonOverlap_(u,c),f=this.diff_commonOverlap_(c,u);d>=f?(d>=u.length/2||d>=c.length/2)&&(t.splice(s,0,new T.Diff(0,c.substring(0,d))),t[s-1][1]=u.substring(0,u.length-d),t[s+1][1]=c.substring(d),s++):(f>=u.length/2||f>=c.length/2)&&(t.splice(s,0,new T.Diff(0,u.substring(0,f))),t[s-1][0]=1,t[s-1][1]=c.substring(0,c.length-f),t[s+1][0]=-1,t[s+1][1]=u.substring(f),s++),s++}s++}},T.prototype.diff_cleanupSemanticLossless=function(t){function e(t,e){if(!t||!e)return 6;var i=t.charAt(t.length-1),n=e.charAt(0),r=i.match(T.nonAlphaNumericRegex_),s=n.match(T.nonAlphaNumericRegex_),a=r&&i.match(T.whitespaceRegex_),o=s&&n.match(T.whitespaceRegex_),h=a&&i.match(T.linebreakRegex_),l=o&&n.match(T.linebreakRegex_),u=h&&t.match(T.blanklineEndRegex_),c=l&&e.match(T.blanklineStartRegex_);return u||c?5:h||l?4:r&&!a&&o?3:a||o?2:r||s?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var n=t[i-1][1],r=t[i][1],s=t[i+1][1],a=this.diff_commonSuffix(n,r);if(a){var o=r.substring(r.length-a);n=n.substring(0,n.length-a),r=o+r.substring(0,r.length-a),s=o+s}for(var h=n,l=r,u=s,c=e(n,r)+e(r,s);r.charAt(0)===s.charAt(0);){n+=r.charAt(0),r=r.substring(1)+s.charAt(0),s=s.substring(1);var d=e(n,r)+e(r,s);d>=c&&(c=d,h=n,l=r,u=s)}t[i-1][1]!=h&&(h?t[i-1][1]=h:(t.splice(i-1,1),i--),t[i][1]=l,u?t[i+1][1]=u:(t.splice(i+1,1),i--))}i++}},T.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,T.whitespaceRegex_=/\s/,T.linebreakRegex_=/[\r\n]/,T.blanklineEndRegex_=/\n\r?\n$/,T.blanklineStartRegex_=/^\r?\n\r?\n/,T.prototype.diff_cleanupEfficiency=function(t){for(var e=!1,i=[],n=0,r=null,s=0,a=!1,o=!1,h=!1,l=!1;s<t.length;)0==t[s][0]?(t[s][1].length<this.Diff_EditCost&&(h||l)?(i[n++]=s,a=h,o=l,r=t[s][1]):(n=0,r=null),h=l=!1):(-1==t[s][0]?l=!0:h=!0,r&&(a&&o&&h&&l||r.length<this.Diff_EditCost/2&&a+o+h+l==3)&&(t.splice(i[n-1],0,new T.Diff(-1,r)),t[i[n-1]+1][0]=1,n--,r=null,a&&o?(h=l=!0,n=0):(s=--n>0?i[n-1]:-1,h=l=!1),e=!0)),s++;e&&this.diff_cleanupMerge(t)},T.prototype.diff_cleanupMerge=function(t){t.push(new T.Diff(0,""));for(var e,i=0,n=0,r=0,s="",a="";i<t.length;)switch(t[i][0]){case 1:r++,a+=t[i][1],i++;break;case -1:n++,s+=t[i][1],i++;break;case 0:n+r>1?(0!==n&&0!==r&&(0!==(e=this.diff_commonPrefix(a,s))&&(i-n-r>0&&0==t[i-n-r-1][0]?t[i-n-r-1][1]+=a.substring(0,e):(t.splice(0,0,new T.Diff(0,a.substring(0,e))),i++),a=a.substring(e),s=s.substring(e)),0!==(e=this.diff_commonSuffix(a,s))&&(t[i][1]=a.substring(a.length-e)+t[i][1],a=a.substring(0,a.length-e),s=s.substring(0,s.length-e))),i-=n+r,t.splice(i,n+r),s.length&&(t.splice(i,0,new T.Diff(-1,s)),i++),a.length&&(t.splice(i,0,new T.Diff(1,a)),i++),i++):0!==i&&0==t[i-1][0]?(t[i-1][1]+=t[i][1],t.splice(i,1)):i++,r=0,n=0,s="",a=""}""===t[t.length-1][1]&&t.pop();var o=!1;for(i=1;i<t.length-1;)0==t[i-1][0]&&0==t[i+1][0]&&(t[i][1].substring(t[i][1].length-t[i-1][1].length)==t[i-1][1]?(t[i][1]=t[i-1][1]+t[i][1].substring(0,t[i][1].length-t[i-1][1].length),t[i+1][1]=t[i-1][1]+t[i+1][1],t.splice(i-1,1),o=!0):t[i][1].substring(0,t[i+1][1].length)==t[i+1][1]&&(t[i-1][1]+=t[i+1][1],t[i][1]=t[i][1].substring(t[i+1][1].length)+t[i+1][1],t.splice(i+1,1),o=!0)),i++;o&&this.diff_cleanupMerge(t)},T.prototype.diff_xIndex=function(t,e){var i,n=0,r=0,s=0,a=0;for(i=0;i<t.length&&(1!==t[i][0]&&(n+=t[i][1].length),-1!==t[i][0]&&(r+=t[i][1].length),!(n>e));i++)s=n,a=r;return t.length!=i&&-1===t[i][0]?a:a+(e-s)},T.prototype.diff_prettyHtml=function(t){for(var e=[],i=/&/g,n=/</g,r=/>/g,s=/\n/g,a=0;a<t.length;a++){var o=t[a][0],h=t[a][1].replace(i,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(s,"&para;<br>");switch(o){case 1:e[a]='<ins style="background:#e6ffe6;">'+h+"</ins>";break;case -1:e[a]='<del style="background:#ffe6e6;">'+h+"</del>";break;case 0:e[a]="<span>"+h+"</span>"}}return e.join("")},T.prototype.diff_text1=function(t){for(var e=[],i=0;i<t.length;i++)1!==t[i][0]&&(e[i]=t[i][1]);return e.join("")},T.prototype.diff_text2=function(t){for(var e=[],i=0;i<t.length;i++)-1!==t[i][0]&&(e[i]=t[i][1]);return e.join("")},T.prototype.diff_levenshtein=function(t){for(var e=0,i=0,n=0,r=0;r<t.length;r++){var s=t[r][0],a=t[r][1];switch(s){case 1:i+=a.length;break;case -1:n+=a.length;break;case 0:e+=Math.max(i,n),i=0,n=0}}return e+Math.max(i,n)},T.prototype.diff_toDelta=function(t){for(var e=[],i=0;i<t.length;i++)switch(t[i][0]){case 1:e[i]="+"+encodeURI(t[i][1]);break;case -1:e[i]="-"+t[i][1].length;break;case 0:e[i]="="+t[i][1].length}return e.join("	").replace(/%20/g," ")},T.prototype.diff_fromDelta=function(t,e){for(var i=[],n=0,r=0,s=e.split(/\t/g),a=0;a<s.length;a++){var o=s[a].substring(1);switch(s[a].charAt(0)){case"+":try{i[n++]=new T.Diff(1,decodeURI(o))}catch(t){throw Error("Illegal escape in diff_fromDelta: "+o)}break;case"-":case"=":var h=parseInt(o,10);if(isNaN(h)||h<0)throw Error("Invalid number in diff_fromDelta: "+o);var l=t.substring(r,r+=h);"="==s[a].charAt(0)?i[n++]=new T.Diff(0,l):i[n++]=new T.Diff(-1,l);break;default:if(s[a])throw Error("Invalid diff operation in diff_fromDelta: "+s[a])}}if(r!=t.length)throw Error("Delta length ("+r+") does not equal source text length ("+t.length+").");return i},T.prototype.match_main=function(t,e,i){if(null==t||null==e||null==i)throw Error("Null input. (match_main)");return(i=Math.max(0,Math.min(i,t.length)),t==e)?0:t.length?t.substring(i,i+e.length)==e?i:this.match_bitap_(t,e,i):-1},T.prototype.match_bitap_=function(t,e,i){if(e.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var n,r,s,a=this.match_alphabet_(e),o=this;function h(t,n){var r=t/e.length,s=Math.abs(i-n);return o.Match_Distance?r+s/o.Match_Distance:s?1:r}var l=this.Match_Threshold,u=t.indexOf(e,i);-1!=u&&(l=Math.min(h(0,u),l),-1!=(u=t.lastIndexOf(e,i+e.length))&&(l=Math.min(h(0,u),l)));var c=1<<e.length-1;u=-1;for(var d=e.length+t.length,f=0;f<e.length;f++){for(n=0,r=d;n<r;)h(f,i+r)<=l?n=r:d=r,r=Math.floor((d-n)/2+n);d=r;var p=Math.max(1,i-r+1),g=Math.min(i+r,t.length)+e.length,m=Array(g+2);m[g+1]=(1<<f)-1;for(var _=g;_>=p;_--){var v=a[t.charAt(_-1)];if(0===f?m[_]=(m[_+1]<<1|1)&v:m[_]=(m[_+1]<<1|1)&v|((s[_+1]|s[_])<<1|1)|s[_+1],m[_]&c){var y=h(f,_-1);if(y<=l){if(l=y,(u=_-1)>i)p=Math.max(1,2*i-u);else break}}}if(h(f+1,i)>l)break;s=m}return u},T.prototype.match_alphabet_=function(t){for(var e={},i=0;i<t.length;i++)e[t.charAt(i)]=0;for(var i=0;i<t.length;i++)e[t.charAt(i)]|=1<<t.length-i-1;return e},T.prototype.patch_addContext_=function(t,e){if(0!=e.length){if(null===t.start2)throw Error("patch not initialized");for(var i=e.substring(t.start2,t.start2+t.length1),n=0;e.indexOf(i)!=e.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=e.substring(t.start2-n,t.start2+t.length1+n);n+=this.Patch_Margin;var r=e.substring(t.start2-n,t.start2);r&&t.diffs.unshift(new T.Diff(0,r));var s=e.substring(t.start2+t.length1,t.start2+t.length1+n);s&&t.diffs.push(new T.Diff(0,s)),t.start1-=r.length,t.start2-=r.length,t.length1+=r.length+s.length,t.length2+=r.length+s.length}},T.prototype.patch_make=function(t,e,i){if("string"==typeof t&&"string"==typeof e&&void 0===i)n=t,(r=this.diff_main(n,e,!0)).length>2&&(this.diff_cleanupSemantic(r),this.diff_cleanupEfficiency(r));else if(t&&"object"==typeof t&&void 0===e&&void 0===i)r=t,n=this.diff_text1(r);else if("string"==typeof t&&e&&"object"==typeof e&&void 0===i)n=t,r=e;else if("string"==typeof t&&"string"==typeof e&&i&&"object"==typeof i)n=t,r=i;else throw Error("Unknown call format to patch_make.");if(0===r.length)return[];for(var n,r,s=[],a=new T.patch_obj,o=0,h=0,l=0,u=n,c=n,d=0;d<r.length;d++){var f=r[d][0],p=r[d][1];switch(o||0===f||(a.start1=h,a.start2=l),f){case 1:a.diffs[o++]=r[d],a.length2+=p.length,c=c.substring(0,l)+p+c.substring(l);break;case -1:a.length1+=p.length,a.diffs[o++]=r[d],c=c.substring(0,l)+c.substring(l+p.length);break;case 0:p.length<=2*this.Patch_Margin&&o&&r.length!=d+1?(a.diffs[o++]=r[d],a.length1+=p.length,a.length2+=p.length):p.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(a,u),s.push(a),a=new T.patch_obj,o=0,u=c,h=l)}1!==f&&(h+=p.length),-1!==f&&(l+=p.length)}return o&&(this.patch_addContext_(a,u),s.push(a)),s},T.prototype.patch_deepCopy=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=new T.patch_obj;r.diffs=[];for(var s=0;s<n.diffs.length;s++)r.diffs[s]=new T.Diff(n.diffs[s][0],n.diffs[s][1]);r.start1=n.start1,r.start2=n.start2,r.length1=n.length1,r.length2=n.length2,e[i]=r}return e},T.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var i=this.patch_addPadding(t);e=i+e+i,this.patch_splitMax(t);for(var n=0,r=[],s=0;s<t.length;s++){var a=t[s].start2+n,o=this.diff_text1(t[s].diffs),h=-1;if(o.length>this.Match_MaxBits?-1!=(u=this.match_main(e,o.substring(0,this.Match_MaxBits),a))&&(-1==(h=this.match_main(e,o.substring(o.length-this.Match_MaxBits),a+o.length-this.Match_MaxBits))||u>=h)&&(u=-1):u=this.match_main(e,o,a),-1==u)r[s]=!1,n-=t[s].length2-t[s].length1;else if(r[s]=!0,n=u-a,c=-1==h?e.substring(u,u+o.length):e.substring(u,h+this.Match_MaxBits),o==c)e=e.substring(0,u)+this.diff_text2(t[s].diffs)+e.substring(u+o.length);else{var l=this.diff_main(o,c,!1);if(o.length>this.Match_MaxBits&&this.diff_levenshtein(l)/o.length>this.Patch_DeleteThreshold)r[s]=!1;else{this.diff_cleanupSemanticLossless(l);for(var u,c,d,f=0,p=0;p<t[s].diffs.length;p++){var g=t[s].diffs[p];0!==g[0]&&(d=this.diff_xIndex(l,f)),1===g[0]?e=e.substring(0,u+d)+g[1]+e.substring(u+d):-1===g[0]&&(e=e.substring(0,u+d)+e.substring(u+this.diff_xIndex(l,f+g[1].length))),-1!==g[0]&&(f+=g[1].length)}}}}return[e=e.substring(i.length,e.length-i.length),r]},T.prototype.patch_addPadding=function(t){for(var e=this.Patch_Margin,i="",n=1;n<=e;n++)i+=String.fromCharCode(n);for(var n=0;n<t.length;n++)t[n].start1+=e,t[n].start2+=e;var r=t[0],s=r.diffs;if(0==s.length||0!=s[0][0])s.unshift(new T.Diff(0,i)),r.start1-=e,r.start2-=e,r.length1+=e,r.length2+=e;else if(e>s[0][1].length){var a=e-s[0][1].length;s[0][1]=i.substring(s[0][1].length)+s[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}if(0==(s=(r=t[t.length-1]).diffs).length||0!=s[s.length-1][0])s.push(new T.Diff(0,i)),r.length1+=e,r.length2+=e;else if(e>s[s.length-1][1].length){var a=e-s[s.length-1][1].length;s[s.length-1][1]+=i.substring(0,a),r.length1+=a,r.length2+=a}return i},T.prototype.patch_splitMax=function(t){for(var e=this.Match_MaxBits,i=0;i<t.length;i++)if(!(t[i].length1<=e)){var n=t[i];t.splice(i--,1);for(var r=n.start1,s=n.start2,a="";0!==n.diffs.length;){var o=new T.patch_obj,h=!0;for(o.start1=r-a.length,o.start2=s-a.length,""!==a&&(o.length1=o.length2=a.length,o.diffs.push(new T.Diff(0,a)));0!==n.diffs.length&&o.length1<e-this.Patch_Margin;){var l=n.diffs[0][0],u=n.diffs[0][1];1===l?(o.length2+=u.length,s+=u.length,o.diffs.push(n.diffs.shift()),h=!1):-1===l&&1==o.diffs.length&&0==o.diffs[0][0]&&u.length>2*e?(o.length1+=u.length,r+=u.length,h=!1,o.diffs.push(new T.Diff(l,u)),n.diffs.shift()):(u=u.substring(0,e-o.length1-this.Patch_Margin),o.length1+=u.length,r+=u.length,0===l?(o.length2+=u.length,s+=u.length):h=!1,o.diffs.push(new T.Diff(l,u)),u==n.diffs[0][1]?n.diffs.shift():n.diffs[0][1]=n.diffs[0][1].substring(u.length))}a=(a=this.diff_text2(o.diffs)).substring(a.length-this.Patch_Margin);var c=this.diff_text1(n.diffs).substring(0,this.Patch_Margin);""!==c&&(o.length1+=c.length,o.length2+=c.length,0!==o.diffs.length&&0===o.diffs[o.diffs.length-1][0]?o.diffs[o.diffs.length-1][1]+=c:o.diffs.push(new T.Diff(0,c))),h||t.splice(++i,0,o)}}},T.prototype.patch_toText=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return e.join("")},T.prototype.patch_fromText=function(t){var e=[];if(!t)return e;for(var i=t.split("\n"),n=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;n<i.length;){var s=i[n].match(r);if(!s)throw Error("Invalid patch string: "+i[n]);var a=new T.patch_obj;for(e.push(a),a.start1=parseInt(s[1],10),""===s[2]?(a.start1--,a.length1=1):"0"==s[2]?a.length1=0:(a.start1--,a.length1=parseInt(s[2],10)),a.start2=parseInt(s[3],10),""===s[4]?(a.start2--,a.length2=1):"0"==s[4]?a.length2=0:(a.start2--,a.length2=parseInt(s[4],10)),n++;n<i.length;){var o=i[n].charAt(0);try{var h=decodeURI(i[n].substring(1))}catch(t){throw Error("Illegal escape in patch_fromText: "+h)}if("-"==o)a.diffs.push(new T.Diff(-1,h));else if("+"==o)a.diffs.push(new T.Diff(1,h));else if(" "==o)a.diffs.push(new T.Diff(0,h));else if("@"==o)break;else if(""===o);else throw Error('Invalid patch mode "'+o+'" in: '+h);n++}}return e},T.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},T.patch_obj.prototype.toString=function(){t=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1;for(var t,e,i=["@@ -"+t+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case -1:e="-";break;case 0:e=" "}i[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return i.join("").replace(/%20/g," ")},U.exports=T,U.exports.diff_match_patch=T,U.exports.DIFF_DELETE=-1,U.exports.DIFF_INSERT=1,U.exports.DIFF_EQUAL=0;var q=(A=U.exports)&&A.__esModule&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A;let $=null,Z=function(t){if(!$){let e;if("undefined"!=typeof diff_match_patch)e="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch;else if(q)try{e=q&&new q}catch(t){e=null}if(!e){if(!t)return null;let e=Error("text diff_match_patch library not found");throw e.diff_match_patch_not_found=!0,e}$={diff:function(t,i){return e.patch_toText(e.patch_make(t,i))},patch:function(t,i){let n=e.patch_apply(e.patch_fromText(i),t);for(let t=0;t<n[1].length;t++)n[1][t]||(Error("text patch failed").textPatchFailed=!0);return n[0]}}}return $},H=function(t){if("string"!==t.leftType)return;let e=t.options&&t.options.textDiff&&t.options.textDiff.minLength||60;if(t.left.length<e||t.right.length<e){t.setResult([t.left,t.right]).exit();return}let i=Z();if(!i){t.setResult([t.left,t.right]).exit();return}let n=i.diff;t.setResult([n(t.left,t.right),0,2]).exit()};H.filterName="texts";let G=function(t){if(t.nested||2!==t.delta[2])return;let e=Z(!0).patch;t.setResult(e(t.left,t.delta[0])).exit()};G.filterName="texts";let W=function(t){let e,i,n,r;let s=null,a=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,o=t.split("\n");for(e=0,i=o.length;e<i;e++){let t=(n=o[e]).slice(0,1);"@"===t?(s=a.exec(n),o[e]="@@ -"+s[3]+","+s[4]+" +"+s[1]+","+s[2]+" @@"):"+"===t?(o[e]="-"+o[e].slice(1),"+"===o[e-1].slice(0,1)&&(r=o[e],o[e]=o[e-1],o[e-1]=r)):"-"===t&&(o[e]="+"+o[e].slice(1))}return o.join("\n")},K=function(t){t.nested||2!==t.delta[2]||t.setResult([W(t.delta[0]),0,2]).exit()};K.filterName="texts";class Y{constructor(t){this.processor=new o(t),this.processor.pipe(new h("diff").append(y,m,F,H,b,N).shouldHaveResult()),this.processor.pipe(new h("patch").append(w,D,_,G,x,z).shouldHaveResult()),this.processor.pipe(new h("reverse").append(C,V,v,K,k,B).shouldHaveResult())}options(){return this.processor.options(...arguments)}diff(t,e){return this.processor.process(new d(t,e))}patch(t,e){return this.processor.process(new f(t,e))}reverse(t){return this.processor.process(new p(t))}unpatch(t,e){return this.patch(t,this.reverse(e))}clone(t){return c(t)}}let Q="function"==typeof Array.isArray?Array.isArray:t=>t instanceof Array,X="function"==typeof Object.keys?t=>Object.keys(t):t=>{let e=[];for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e},J=t=>"_"===t.substr(0,1)?t.slice(1):t,tt=t=>"_t"===t?-1:"_"===t.substr(0,1)?parseInt(t.slice(1),10):parseInt(t,10)+.1,te=(t,e)=>tt(t)-tt(e);class ti{format(t,e){let i={};return this.prepareContext(i),this.recurse(i,t,e),this.finalize(i)}prepareContext(t){t.buffer=[],t.out=function(){this.buffer.push(...arguments)}}typeFormattterNotFound(t,e){throw Error(`cannot format delta type: ${e}`)}typeFormattterErrorFormatter(t,e){return e.toString()}finalize(t){let{buffer:e}=t;if(Q(e))return e.join("")}recurse(t,e,i,n,r,s,a){let o=e&&s?s.value:i;if(void 0===e&&void 0===n)return;let h=this.getDeltaType(e,s),l="node"===h?"a"===e._t?"array":"object":"";void 0!==n?this.nodeBegin(t,n,r,h,l,a):this.rootBegin(t,h,l);try{(this[`format_${h}`]||this.typeFormattterNotFound(t,h)).call(this,t,e,o,n,r,s)}catch(i){this.typeFormattterErrorFormatter(t,i,e,o,n,r,s),"undefined"!=typeof console&&console.error&&console.error(i.stack)}void 0!==n?this.nodeEnd(t,n,r,h,l,a):this.rootEnd(t,h,l)}formatDeltaChildren(t,e,i){let n=this;this.forEachDeltaKey(e,i,(r,s,a,o)=>{n.recurse(t,e[r],i?i[s]:void 0,r,s,a,o)})}forEachDeltaKey(t,e,i){let n;let r=X(t),s="a"===t._t,a={};if(void 0!==e)for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&void 0===t[n]&&(!s||void 0===t[`_${n}`])&&r.push(n);for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let i=t[n];Q(i)&&3===i[2]&&(a[i[1].toString()]={key:n,value:e&&e[parseInt(n.substr(1))]},!1!==this.includeMoveDestinations&&void 0===e&&void 0===t[i[1]]&&r.push(i[1].toString()))}s?r.sort(te):r.sort();for(let t=0,e=r.length;t<e;t++){let n=r[t];if(s&&"_t"===n)continue;let o=s?"number"==typeof n?n:parseInt(J(n),10):n,h=t===e-1;i(n,o,a[o],h)}}getDeltaType(t,e){if(void 0===t)return void 0!==e?"movedestination":"unchanged";if(Q(t)){if(1===t.length)return"added";if(2===t.length)return"modified";if(3===t.length&&0===t[2])return"deleted";if(3===t.length&&2===t[2])return"textdiff";if(3===t.length&&3===t[2])return"moved"}else if("object"==typeof t)return"node";return"unknown"}parseTextDiff(t){let e=[],i=t.split("\n@@ ");for(let t=0,n=i.length;t<n;t++){let n=i[t],r={pieces:[]},s=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(n).slice(1);r.location={line:s[0],chr:s[1]};let a=n.split("\n").slice(1);for(let t=0,e=a.length;t<e;t++){let e=a[t];if(!e.length)continue;let i={type:"context"};"+"===e.substr(0,1)?i.type="added":"-"===e.substr(0,1)&&(i.type="deleted"),i.text=e.slice(1),r.pieces.push(i)}e.push(r)}return e}}var tn=Object.freeze({__proto__:null,default:ti});class tr extends ti{typeFormattterErrorFormatter(t,e){t.out(`<pre class="jsondiffpatch-error">${e}</pre>`)}formatValue(t,e){t.out(`<pre>${ts(JSON.stringify(e,null,2))}</pre>`)}formatTextDiffString(t,e){let i=this.parseTextDiff(e);t.out('<ul class="jsondiffpatch-textdiff">');for(let e=0,n=i.length;e<n;e++){let n=i[e];t.out(`<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">${n.location.line}</span><span class="jsondiffpatch-textdiff-char">${n.location.chr}</span></div><div class="jsondiffpatch-textdiff-line">`);let r=n.pieces;for(let e=0,i=r.length;e<i;e++){let i=r[e];t.out(`<span class="jsondiffpatch-textdiff-${i.type}">${ts(decodeURI(i.text))}</span>`)}t.out("</div></li>")}t.out("</ul>")}rootBegin(t,e,i){let n=`jsondiffpatch-${e}${i?` jsondiffpatch-child-node-type-${i}`:""}`;t.out(`<div class="jsondiffpatch-delta ${n}">`)}rootEnd(t){t.out(`</div>${t.hasArrows?`<script type="text/javascript">setTimeout(${ta.toString()},10);</script>`:""}`)}nodeBegin(t,e,i,n,r){let s=`jsondiffpatch-${n}${r?` jsondiffpatch-child-node-type-${r}`:""}`;t.out(`<li class="${s}" data-key="${i}"><div class="jsondiffpatch-property-name">${i}</div>`)}nodeEnd(t){t.out("</li>")}format_unchanged(t,e,i){void 0!==i&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,i),t.out("</div>"))}format_movedestination(t,e,i){void 0!==i&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,i),t.out("</div>"))}format_node(t,e,i){let n="a"===e._t?"array":"object";t.out(`<ul class="jsondiffpatch-node jsondiffpatch-node-type-${n}">`),this.formatDeltaChildren(t,e,i),t.out("</ul>")}format_added(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")}format_modified(t,e){t.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(t,e[0]),t.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(t,e[1]),t.out("</div>")}format_deleted(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")}format_moved(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out(`</div><div class="jsondiffpatch-moved-destination">${e[1]}</div>`),t.out(`<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">
          <svg width="30" height="60" style="position: absolute; display: none;">
          <defs>
              <marker id="markerArrow" markerWidth="8" markerHeight="8"
                 refx="2" refy="4"
                     orient="auto" markerUnits="userSpaceOnUse">
                  <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />
              </marker>
          </defs>
          <path d="M30,0 Q-10,25 26,50"
            style="stroke: #88f; stroke-width: 2px; fill: none; stroke-opacity: 0.5; marker-end: url(#markerArrow);"
          ></path>
          </svg>
      </div>`),t.hasArrows=!0}format_textdiff(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(t,e[0]),t.out("</div>")}}function ts(t){let e=t,i=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]];for(let t=0;t<i.length;t++)e=e.replace(i[t][0],i[t][1]);return e}let ta=function(t){let e=t=>{let{textContent:e,innerText:i}=t;return e||i},i=(t,e)=>{let{children:i}=t;for(let t=0,n=i.length;t<n;t++)e(i[t],t)};((t,e,i)=>{let n=t.querySelectorAll(e);for(let t=0,e=n.length;t<e;t++)i(n[t])})(t||document,".jsondiffpatch-arrow",t=>{let n,{parentNode:r,children:s,style:a}=t,o=s[0],h=o.children[1];o.style.display="none";let l=e(r.querySelector(".jsondiffpatch-moved-destination"));if(i(r.parentNode,t=>{t.getAttribute("data-key")===l&&(n=t)}),n)try{let t=n.offsetTop-r.offsetTop;o.setAttribute("height",Math.abs(t)+6),a.top=`${-8+(t>0?0:t)}px`;let e=t>0?`M30,0 Q-10,${Math.round(t/2)} 26,${t-4}`:`M30,${-t} Q-10,${Math.round(-t/2)} 26,4`;h.setAttribute("d",e),o.style.display=""}catch(t){}})},to=(t,e,i)=>{let n=e||document.body,r="jsondiffpatch-unchanged-",s={showing:`${r}showing`,hiding:`${r}hiding`,visible:`${r}visible`,hidden:`${r}hidden`},a=n.classList;if(!a)return;if(!i){a.remove(s.showing),a.remove(s.hiding),a.remove(s.visible),a.remove(s.hidden),!1===t&&a.add(s.hidden);return}!1===t?(a.remove(s.showing),a.add(s.visible),setTimeout(()=>{a.add(s.hiding)},10)):(a.remove(s.hiding),a.add(s.showing),a.remove(s.hidden));let o=setInterval(()=>{ta(n)},100);setTimeout(()=>{a.remove(s.showing),a.remove(s.hiding),!1===t?(a.add(s.hidden),a.remove(s.visible)):(a.add(s.visible),a.remove(s.hidden)),setTimeout(()=>{a.remove(s.visible),clearInterval(o)},i+400)},i)};var th=Object.freeze({__proto__:null,default:tr,format:function(t,e){return i||(i=new tr),i.format(t,e)},hideUnchanged:(t,e)=>to(!1,t,e),showUnchanged:to});class tl extends ti{constructor(){super(),this.includeMoveDestinations=!1}prepareContext(t){super.prepareContext(t),t.indent=function(t){this.indentLevel=(this.indentLevel||0)+(void 0===t?1:t),this.indentPad=Array(this.indentLevel+1).join("&nbsp;&nbsp;")},t.row=(e,i)=>{t.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),t.out(t.indentPad),t.out('</pre><pre style="display: inline-block">'),t.out(e),t.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),t.out(i),t.out("</div></td></tr>")}}typeFormattterErrorFormatter(t,e){t.row("",`<pre class="jsondiffpatch-error">${e}</pre>`)}formatTextDiffString(t,e){let i=this.parseTextDiff(e);t.out('<ul class="jsondiffpatch-textdiff">');for(let e=0,n=i.length;e<n;e++){let n=i[e];t.out(`<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">${n.location.line}</span><span class="jsondiffpatch-textdiff-char">${n.location.chr}</span></div><div class="jsondiffpatch-textdiff-line">`);let r=n.pieces;for(let e=0,i=r.length;e<i;e++){let i=r[e];t.out(`<span class="jsondiffpatch-textdiff-${i.type}">${i.text}</span>`)}t.out("</div></li>")}t.out("</ul>")}rootBegin(t,e,i){t.out('<table class="jsondiffpatch-annotated-delta">'),"node"===e&&(t.row("{"),t.indent()),"array"===i&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")}rootEnd(t,e){"node"===e&&(t.indent(-1),t.row("}")),t.out("</table>")}nodeBegin(t,e,i,n,r){t.row(`&quot;${e}&quot;: {`),"node"===n&&t.indent(),"array"===r&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")}nodeEnd(t,e,i,n,r,s){"node"===n&&t.indent(-1),t.row(`}${s?"":","}`)}format_unchanged(){}format_movedestination(){}format_node(t,e,i){this.formatDeltaChildren(t,e,i)}}let tu=t=>`<pre style="display:inline-block">&quot;${t}&quot;</pre>`,tc={added(t,e,i,n){let r=" <pre>([newValue])</pre>";return void 0===n?`new value${r}`:"number"==typeof n?`insert at index ${n}${r}`:`add property ${tu(n)}${r}`},modified(t,e,i,n){let r=" <pre>([previousValue, newValue])</pre>";return void 0===n?`modify value${r}`:"number"==typeof n?`modify at index ${n}${r}`:`modify property ${tu(n)}${r}`},deleted(t,e,i,n){let r=" <pre>([previousValue, 0, 0])</pre>";return void 0===n?`delete value${r}`:"number"==typeof n?`remove index ${n}${r}`:`delete property ${tu(n)}${r}`},moved:(t,e,i,n)=>`move from <span title="(position to remove at original state)">index ${n}</span> to <span title="(position to insert at final state)">index ${t[1]}</span>`,textdiff(t,e,i,n){let r=void 0===n?"":"number"==typeof n?` at index ${n}`:` at property ${tu(n)}`;return`text diff${r}, format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>`}},td=function(t,e){let i=this.getDeltaType(e),n=tc[i],r=n&&n.apply(n,Array.prototype.slice.call(arguments,1)),s=JSON.stringify(e,null,2);"textdiff"===i&&(s=s.split("\\n").join('\\n"+\n   "')),t.indent(),t.row(s,r),t.indent(-1)};tl.prototype.format_added=td,tl.prototype.format_modified=td,tl.prototype.format_deleted=td,tl.prototype.format_moved=td,tl.prototype.format_textdiff=td;var tf=Object.freeze({__proto__:null,default:tl,format:function(t,e){return n||(n=new tl),n.format(t,e)}});class tp extends ti{constructor(){super(),this.includeMoveDestinations=!0}prepareContext(t){super.prepareContext(t),t.result=[],t.path=[],t.pushCurrentOp=function(t){let{op:e,value:i}=t,n={op:e,path:this.currentPath()};void 0!==i&&(n.value=i),this.result.push(n)},t.pushMoveOp=function(t){let e=this.currentPath();this.result.push({op:"move",from:e,path:this.toPath(t)})},t.currentPath=function(){return`/${this.path.join("/")}`},t.toPath=function(t){let e=this.path.slice();return e[e.length-1]=t,`/${e.join("/")}`}}typeFormattterErrorFormatter(t,e){t.out(`[ERROR] ${e}`)}rootBegin(){}rootEnd(){}nodeBegin(t,e,i){let{path:n}=t;n.push(i)}nodeEnd(t){let{path:e}=t;e.pop()}format_unchanged(){}format_movedestination(){}format_node(t,e,i){this.formatDeltaChildren(t,e,i)}format_added(t,e){t.pushCurrentOp({op:"add",value:e[0]})}format_modified(t,e){t.pushCurrentOp({op:"replace",value:e[1]})}format_deleted(t){t.pushCurrentOp({op:"remove"})}format_moved(t,e){let i=e[1];t.pushMoveOp(i)}format_textdiff(){throw Error("Not implemented")}format(t,e){let i={};return this.prepareContext(i),this.recurse(i,t,e),i.result}}let tg=t=>t[t.length-1],tm=(t,e)=>(t.sort(e),t),t_=(t,e)=>{let i=parseInt(t,10),n=parseInt(e,10);return isNaN(i)||isNaN(n)?0:n-i},tv=t=>tm(t,(t,e)=>{let i=t.path.split("/"),n=e.path.split("/");return i.length!==n.length?i.length-n.length:t_(tg(i),tg(n))}),ty=(t,e)=>{let i=Array(e.length+1).fill().map(()=>[]);return t.map(t=>{let i=e.map(e=>e(t)).indexOf(!0);return i<0&&(i=e.length),{item:t,position:i}}).reduce((t,e)=>(t[e.position].push(e.item),t),i)},tb=t=>{let{op:e}=t;return"move"===e},tx=t=>{let{op:e}=t;return"remove"===e},tw=t=>{let[e,i,n]=ty(t,[tb,tx]);return[...tv(i),...e,...n]},tk=(t,e)=>(r||(r=new tp),tw(r.format(t,e)));var tC=Object.freeze({__proto__:null,default:tp,format:tk,log:(t,e)=>{console.log(tk(t,e))},partitionOps:ty});function tS(t){return e&&e[t]||function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return e}}let tI={added:tS("green"),deleted:tS("red"),movedestination:tS("gray"),moved:tS("yellow"),unchanged:tS("gray"),error:tS("white.bgRed"),textDiffLine:tS("gray")};class tE extends ti{constructor(){super(),this.includeMoveDestinations=!1}prepareContext(t){super.prepareContext(t),t.indent=function(t){this.indentLevel=(this.indentLevel||0)+(void 0===t?1:t),this.indentPad=Array(this.indentLevel+1).join("  "),this.outLine()},t.outLine=function(){this.buffer.push(`
${this.indentPad||""}`)},t.out=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(let t=0,i=e.length;t<i;t++){let i=e[t].split("\n").join(`
${this.indentPad||""}`);this.color&&this.color[0]&&(i=this.color[0](i)),this.buffer.push(i)}},t.pushColor=function(t){this.color=this.color||[],this.color.unshift(t)},t.popColor=function(){this.color=this.color||[],this.color.shift()}}typeFormattterErrorFormatter(t,e){t.pushColor(tI.error),t.out(`[ERROR]${e}`),t.popColor()}formatValue(t,e){t.out(JSON.stringify(e,null,2))}formatTextDiffString(t,e){let i=this.parseTextDiff(e);t.indent();for(let e=0,n=i.length;e<n;e++){let r=i[e];t.pushColor(tI.textDiffLine),t.out(`${r.location.line},${r.location.chr} `),t.popColor();let s=r.pieces;for(let e=0,i=s.length;e<i;e++){let i=s[e];t.pushColor(tI[i.type]),t.out(i.text),t.popColor()}e<n-1&&t.outLine()}t.indent(-1)}rootBegin(t,e,i){t.pushColor(tI[e]),"node"===e&&(t.out("array"===i?"[":"{"),t.indent())}rootEnd(t,e,i){"node"===e&&(t.indent(-1),t.out("array"===i?"]":"}")),t.popColor()}nodeBegin(t,e,i,n,r){t.pushColor(tI[n]),t.out(`${i}: `),"node"===n&&(t.out("array"===r?"[":"{"),t.indent())}nodeEnd(t,e,i,n,r,s){"node"===n&&(t.indent(-1),t.out("array"===r?"]":`}${s?"":","}`)),s||t.outLine(),t.popColor()}format_unchanged(t,e,i){void 0!==i&&this.formatValue(t,i)}format_movedestination(t,e,i){void 0!==i&&this.formatValue(t,i)}format_node(t,e,i){this.formatDeltaChildren(t,e,i)}format_added(t,e){this.formatValue(t,e[0])}format_modified(t,e){t.pushColor(tI.deleted),this.formatValue(t,e[0]),t.popColor(),t.out(" => "),t.pushColor(tI.added),this.formatValue(t,e[1]),t.popColor()}format_deleted(t,e){this.formatValue(t,e[0])}format_moved(t,e){t.out(`==> ${e[1]}`)}format_textdiff(t,e){this.formatTextDiffString(t,e[0])}}let tT=(t,e)=>(s||(s=new tE),s.format(t,e));var tA=Object.freeze({__proto__:null,default:tE,format:tT,log:function(t,e){console.log(tT(t,e))}}),tP=Object.freeze({__proto__:null,annotated:tf,base:tn,console:tA,html:th,jsonpatch:tC});t.DiffPatcher=Y,t.clone=function(){return a||(a=new Y),a.clone.apply(a,arguments)},t.console=tA,t.create=function(t){return new Y(t)},t.dateReviver=function(t,e){let i;return"string"==typeof e&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+-])(\d{2}):(\d{2}))$/.exec(e))?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6],+(i[7]||0))):e},t.diff=function(){return a||(a=new Y),a.diff.apply(a,arguments)},t.formatters=tP,t.patch=function(){return a||(a=new Y),a.patch.apply(a,arguments)},t.reverse=function(){return a||(a=new Y),a.reverse.apply(a,arguments)},t.unpatch=function(){return a||(a=new Y),a.unpatch.apply(a,arguments)}}(g,u("7yz2R"));const _=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),v=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),y=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),b=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),x=Array(576);m(x);const w=Array(60);m(w);const k=Array(512);m(k);const C=Array(256);m(C);const S=Array(29);m(S);const I=Array(30);function E(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function T(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}m(I);const A=t=>t<256?k[t]:k[256+(t>>>7)],P=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},M=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,P(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},O=(t,e,i)=>{M(t,i[2*e],i[2*e+1])},L=(t,e)=>{let i=0;do i|=1&t,t>>>=1,i<<=1;while(--e>0)return i>>>1},N=t=>{16===t.bi_valid?(P(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},R=(t,e)=>{let i,n,r,s,a,o;let h=e.dyn_tree,l=e.max_code,u=e.stat_desc.static_tree,c=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(s=0;s<=15;s++)t.bl_count[s]=0;for(h[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<573;i++)(s=h[2*h[2*(n=t.heap[i])+1]+1]+1)>p&&(s=p,g++),h[2*n+1]=s,!(n>l)&&(t.bl_count[s]++,a=0,n>=f&&(a=d[n-f]),o=h[2*n],t.opt_len+=o*(s+a),c&&(t.static_len+=o*(u[2*n+1]+a)));if(0!==g){do{for(s=p-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,g-=2}while(g>0)for(s=p;0!==s;s--)for(n=t.bl_count[s];0!==n;)!((r=t.heap[--i])>l)&&(h[2*r+1]!==s&&(t.opt_len+=(s-h[2*r+1])*h[2*r],h[2*r+1]=s),n--)}},z=(t,e,i)=>{let n,r;let s=Array(16),a=0;for(n=1;n<=15;n++)a=a+i[n-1]<<1,s[n]=a;for(r=0;r<=e;r++){let e=t[2*r+1];0!==e&&(t[2*r]=L(s[e]++,e))}},D=()=>{let n,r,s,a,o;let h=Array(16);for(a=0,s=0;a<28;a++)for(n=0,S[a]=s;n<1<<_[a];n++)C[s++]=a;for(C[s-1]=a,o=0,a=0;a<16;a++)for(n=0,I[a]=o;n<1<<v[a];n++)k[o++]=a;for(o>>=7;a<30;a++)for(n=0,I[a]=o<<7;n<1<<v[a]-7;n++)k[256+o++]=a;for(r=0;r<=15;r++)h[r]=0;for(n=0;n<=143;)x[2*n+1]=8,n++,h[8]++;for(;n<=255;)x[2*n+1]=9,n++,h[9]++;for(;n<=279;)x[2*n+1]=7,n++,h[7]++;for(;n<=287;)x[2*n+1]=8,n++,h[8]++;for(z(x,287,h),n=0;n<30;n++)w[2*n+1]=5,w[2*n]=L(n,5);t=new E(x,_,257,286,15),e=new E(w,v,0,30,15),i=new E([],y,0,19,7)},B=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},j=t=>{t.bi_valid>8?P(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},V=(t,e,i,n)=>{let r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]},F=(t,e,i)=>{let n=t.heap[i],r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&V(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!V(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},U=(t,e,i)=>{let n,r,s,a;let o=0;if(0!==t.sym_next)do n=(255&t.pending_buf[t.sym_buf+o++])+((255&t.pending_buf[t.sym_buf+o++])<<8),r=t.pending_buf[t.sym_buf+o++],0===n?O(t,r,e):(O(t,(s=C[r])+256+1,e),0!==(a=_[s])&&M(t,r-=S[s],a),O(t,s=A(--n),i),0!==(a=v[s])&&M(t,n-=I[s],a));while(o<t.sym_next)O(t,256,e)},q=(t,e)=>{let i,n,r;let s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,h=e.stat_desc.elems,l=-1;for(i=0,t.heap_len=0,t.heap_max=573;i<h;i++)0!==s[2*i]?(t.heap[++t.heap_len]=l=i,t.depth[i]=0):s[2*i+1]=0;for(;t.heap_len<2;)s[2*(r=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=a[2*r+1]);for(e.max_code=l,i=t.heap_len>>1;i>=1;i--)F(t,s,i);r=h;do i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],F(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,s[2*r]=s[2*i]+s[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,s[2*i+1]=s[2*n+1]=r,t.heap[1]=r++,F(t,s,1);while(t.heap_len>=2)t.heap[--t.heap_max]=t.heap[1],R(t,e),z(s,l,t.bl_count)},$=(t,e,i)=>{let n,r;let s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),e[(i+1)*2+1]=65535,n=0;n<=i;n++)r=a,a=e[(n+1)*2+1],++o<h&&r===a||(o<l?t.bl_tree[2*r]+=o:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=r,0===a?(h=138,l=3):r===a?(h=6,l=3):(h=7,l=4))},Z=(t,e,i)=>{let n,r;let s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),n=0;n<=i;n++)if(r=a,a=e[(n+1)*2+1],!(++o<h)||r!==a){if(o<l)do O(t,r,t.bl_tree);while(0!=--o)else 0!==r?(r!==s&&(O(t,r,t.bl_tree),o--),O(t,16,t.bl_tree),M(t,o-3,2)):o<=10?(O(t,17,t.bl_tree),M(t,o-3,3)):(O(t,18,t.bl_tree),M(t,o-11,7));o=0,s=r,0===a?(h=138,l=3):r===a?(h=6,l=3):(h=7,l=4)}},H=t=>{let e;for($(t,t.dyn_ltree,t.l_desc.max_code),$(t,t.dyn_dtree,t.d_desc.max_code),q(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*b[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e},G=(t,e,i,n)=>{let r;for(M(t,e-257,5),M(t,i-1,5),M(t,n-4,4),r=0;r<n;r++)M(t,t.bl_tree[2*b[r]+1],3);Z(t,t.dyn_ltree,e-1),Z(t,t.dyn_dtree,i-1)},W=t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0};let K=!1;const Y=(t,e,i,n)=>{M(t,0+(n?1:0),3),j(t),P(t,i),P(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var Q={_tr_init:n=>{K||(D(),K=!0),n.l_desc=new T(n.dyn_ltree,t),n.d_desc=new T(n.dyn_dtree,e),n.bl_desc=new T(n.bl_tree,i),n.bi_buf=0,n.bi_valid=0,B(n)},_tr_stored_block:Y,_tr_flush_block:(t,e,i,n)=>{let r,s;let a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=W(t)),q(t,t.l_desc),q(t,t.d_desc),a=H(t),r=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=r&&(r=s)):r=s=i+5,i+4<=r&&-1!==e?Y(t,e,i,n):4===t.strategy||s===r?(M(t,2+(n?1:0),3),U(t,x,w)):(M(t,4+(n?1:0),3),G(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),U(t,t.dyn_ltree,t.dyn_dtree)),B(t),n&&j(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[(C[i]+256+1)*2]++,t.dyn_dtree[2*A(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{M(t,2,3),O(t,256,x),N(t)}},X=(t,e,i,n)=>{let r=65535&t|0,s=t>>>16&65535|0,a=0;for(;0!==i;){a=i>2e3?2e3:i,i-=a;do s=s+(r=r+e[n++]|0)|0;while(--a)r%=65521,s%=65521}return r|s<<16|0};const J=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var tt=(t,e,i,n)=>{let r=n+i;t^=-1;for(let i=n;i<r;i++)t=t>>>8^J[(t^e[i])&255];return -1^t},te={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ti={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:tn,_tr_stored_block:tr,_tr_flush_block:ts,_tr_tally:ta,_tr_align:to}=Q,{Z_NO_FLUSH:th,Z_PARTIAL_FLUSH:tl,Z_FULL_FLUSH:tu,Z_FINISH:tc,Z_BLOCK:td,Z_OK:tf,Z_STREAM_END:tp,Z_STREAM_ERROR:tg,Z_DATA_ERROR:tm,Z_BUF_ERROR:t_,Z_DEFAULT_COMPRESSION:tv,Z_FILTERED:ty,Z_HUFFMAN_ONLY:tb,Z_RLE:tx,Z_FIXED:tw,Z_DEFAULT_STRATEGY:tk,Z_UNKNOWN:tC,Z_DEFLATED:tS}=ti,tI=(t,e)=>(t.msg=te[e],e),tE=t=>2*t-(t>4?9:0),tT=t=>{let e=t.length;for(;--e>=0;)t[e]=0},tA=t=>{let e,i,n;let r=t.w_size;n=e=t.hash_size;do i=t.head[--n],t.head[n]=i>=r?i-r:0;while(--e)n=e=r;do i=t.prev[--n],t.prev[n]=i>=r?i-r:0;while(--e)};let tP=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const tM=t=>{let e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},tO=(t,e)=>{ts(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tM(t.strm)},tL=(t,e)=>{t.pending_buf[t.pending++]=e},tN=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},tR=(t,e,i,n)=>{let r=t.avail_in;return(r>n&&(r=n),0===r)?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),1===t.state.wrap?t.adler=X(t.adler,e,r,i):2===t.state.wrap&&(t.adler=tt(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},tz=(t,e)=>{let i,n,r=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,h=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,l=t.window,u=t.w_mask,c=t.prev,d=t.strstart+258,f=l[s+a-1],p=l[s+a];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(l[(i=e)+a]!==p||l[i+a-1]!==f||l[i]!==l[s]||l[++i]!==l[s+1])continue;s+=2,i++;do;while(l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&s<d)if(n=258-(d-s),s=d-258,n>a){if(t.match_start=e,a=n,n>=o)break;f=l[s+a-1],p=l[s+a]}}while((e=c[e&u])>h&&0!=--r)return a<=t.lookahead?a:t.lookahead},tD=t=>{let e,i,n;let r=t.w_size;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-262)&&(t.window.set(t.window.subarray(r,r+r-i),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),tA(t),i+=r),0===t.strm.avail_in)break;if(e=tR(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=tP(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=tP(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},tB=(t,e)=>{let i=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,n,r,s,a=0,o=t.strm.avail_in;do{if(n=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s||(s=t.strm.avail_out-s,n>(r=t.strstart-t.block_start)+t.strm.avail_in&&(n=r+t.strm.avail_in),n>s&&(n=s),n<i&&(0===n&&e!==tc||e===th||n!==r+t.strm.avail_in)))break;a=e===tc&&n===r+t.strm.avail_in?1:0,tr(t,0,0,a),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,tM(t.strm),r&&(r>n&&(r=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,n-=r),n&&(tR(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===a)return((o-=t.strm.avail_in)&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a)?4:e!==th&&e!==tc&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(tR(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,i=(s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s)>t.w_size?t.w_size:s,((r=t.strstart-t.block_start)>=i||(r||e===tc)&&e!==th&&0===t.strm.avail_in&&r<=s)&&(n=r>s?s:r,a=e===tc&&0===t.strm.avail_in&&n===r?1:0,tr(t,t.block_start,n,a),t.block_start+=n,tM(t.strm)),a?3:1)},tj=(t,e)=>{let i,n;for(;;){if(t.lookahead<262){if(tD(t),t.lookahead<262&&e===th)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=tP(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-262&&(t.match_length=tz(t,i)),t.match_length>=3){if(n=ta(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do t.strstart++,t.ins_h=tP(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!=--t.match_length)t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=tP(t,t.ins_h,t.window[t.strstart+1])}else n=ta(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(tO(t,!1),0===t.strm.avail_out))return 1}return(t.insert=t.strstart<2?t.strstart:2,e===tc)?(tO(t,!0),0===t.strm.avail_out)?3:4:t.sym_next&&(tO(t,!1),0===t.strm.avail_out)?1:2},tV=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<262){if(tD(t),t.lookahead<262&&e===th)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=tP(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-262&&(t.match_length=tz(t,i),t.match_length<=5&&(t.strategy===ty||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=ta(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=tP(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!=--t.prev_length)if(t.match_available=0,t.match_length=2,t.strstart++,n&&(tO(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=ta(t,0,t.window[t.strstart-1]))&&tO(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return(t.match_available&&(n=ta(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===tc)?(tO(t,!0),0===t.strm.avail_out)?3:4:t.sym_next&&(tO(t,!1),0===t.strm.avail_out)?1:2},tF=(t,e)=>{let i,n,r,s;let a=t.window;for(;;){if(t.lookahead<=258){if(tD(t),t.lookahead<=258&&e===th)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=a[r=t.strstart-1])===a[++r]&&n===a[++r]&&n===a[++r]){s=t.strstart+258;do;while(n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&r<s)t.match_length=258-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=ta(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=ta(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(tO(t,!1),0===t.strm.avail_out))return 1}return(t.insert=0,e===tc)?(tO(t,!0),0===t.strm.avail_out)?3:4:t.sym_next&&(tO(t,!1),0===t.strm.avail_out)?1:2},tU=(t,e)=>{let i;for(;;){if(0===t.lookahead&&(tD(t),0===t.lookahead)){if(e===th)return 1;break}if(t.match_length=0,i=ta(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(tO(t,!1),0===t.strm.avail_out))return 1}return(t.insert=0,e===tc)?(tO(t,!0),0===t.strm.avail_out)?3:4:t.sym_next&&(tO(t,!1),0===t.strm.avail_out)?1:2};function tq(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const t$=[new tq(0,0,0,0,tB),new tq(4,4,8,4,tj),new tq(4,5,16,8,tj),new tq(4,6,32,32,tj),new tq(4,4,16,16,tV),new tq(8,16,32,32,tV),new tq(8,16,128,128,tV),new tq(8,32,128,256,tV),new tq(32,128,258,1024,tV),new tq(32,258,258,4096,tV)],tZ=t=>{t.window_size=2*t.w_size,tT(t.head),t.max_lazy_match=t$[t.level].max_lazy,t.good_match=t$[t.level].good_length,t.nice_match=t$[t.level].nice_length,t.max_chain_length=t$[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0};function tH(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=tS,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),tT(this.dyn_ltree),tT(this.dyn_dtree),tT(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),tT(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),tT(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const tG=t=>{if(!t)return 1;let e=t.state;return e&&e.strm===t&&(42===e.status||57===e.status||69===e.status||73===e.status||91===e.status||103===e.status||113===e.status||666===e.status)?0:1},tW=t=>{if(tG(t))return tI(t,tg);t.total_in=t.total_out=0,t.data_type=tC;let e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=-2,tn(e),tf},tK=t=>{let e=tW(t);return e===tf&&tZ(t.state),e},tY=(t,e,i,n,r,s)=>{if(!t)return tg;let a=1;if(e===tv&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),r<1||r>9||i!==tS||n<8||n>15||e<0||e>9||s<0||s>tw||8===n&&1!==a)return tI(t,tg);8===n&&(n=9);let o=new tH;return t.state=o,o.strm=t,o.status=42,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=s,o.method=i,tK(t)};var tQ={deflateInit:(t,e)=>tY(t,e,tS,15,8,tk),deflateInit2:tY,deflateReset:tK,deflateResetKeep:tW,deflateSetHeader:(t,e)=>tG(t)||2!==t.state.wrap?tg:(t.state.gzhead=e,tf),deflate:(t,e)=>{if(tG(t)||e>td||e<0)return t?tI(t,tg):tg;let i=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===i.status&&e!==tc)return tI(t,0===t.avail_out?t_:tg);let n=i.last_flush;if(i.last_flush=e,0!==i.pending){if(tM(t),0===t.avail_out)return i.last_flush=-1,tf}else if(0===t.avail_in&&tE(e)<=tE(n)&&e!==tc)return tI(t,t_);if(666===i.status&&0!==t.avail_in)return tI(t,t_);if(42===i.status&&0===i.wrap&&(i.status=113),42===i.status){let e=tS+(i.w_bits-8<<4)<<8;if(e|=(i.strategy>=tb||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(e|=32),tN(i,e+=31-e%31),0!==i.strstart&&(tN(i,t.adler>>>16),tN(i,65535&t.adler)),t.adler=1,i.status=113,tM(t),0!==i.pending)return i.last_flush=-1,tf}if(57===i.status){if(t.adler=0,tL(i,31),tL(i,139),tL(i,8),i.gzhead)tL(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),tL(i,255&i.gzhead.time),tL(i,i.gzhead.time>>8&255),tL(i,i.gzhead.time>>16&255),tL(i,i.gzhead.time>>24&255),tL(i,9===i.level?2:i.strategy>=tb||i.level<2?4:0),tL(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(tL(i,255&i.gzhead.extra.length),tL(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=tt(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(tL(i,0),tL(i,0),tL(i,0),tL(i,0),tL(i,0),tL(i,9===i.level?2:i.strategy>=tb||i.level<2?4:0),tL(i,3),i.status=113,tM(t),0!==i.pending)return i.last_flush=-1,tf}if(69===i.status){if(i.gzhead.extra){let e=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let r=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=tt(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=r,tM(t),0!==i.pending)return i.last_flush=-1,tf;e=0,n-=r}let r=new Uint8Array(i.gzhead.extra);i.pending_buf.set(r.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>e&&(t.adler=tt(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=tt(t.adler,i.pending_buf,i.pending-n,n)),tM(t),0!==i.pending)return i.last_flush=-1,tf;n=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,tL(i,e)}while(0!==e)i.gzhead.hcrc&&i.pending>n&&(t.adler=tt(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=tt(t.adler,i.pending_buf,i.pending-n,n)),tM(t),0!==i.pending)return i.last_flush=-1,tf;n=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,tL(i,e)}while(0!==e)i.gzhead.hcrc&&i.pending>n&&(t.adler=tt(t.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(tM(t),0!==i.pending))return i.last_flush=-1,tf;tL(i,255&t.adler),tL(i,t.adler>>8&255),t.adler=0}if(i.status=113,tM(t),0!==i.pending)return i.last_flush=-1,tf}if(0!==t.avail_in||0!==i.lookahead||e!==th&&666!==i.status){let n=0===i.level?tB(i,e):i.strategy===tb?tU(i,e):i.strategy===tx?tF(i,e):t$[i.level].func(i,e);if((3===n||4===n)&&(i.status=666),1===n||3===n)return 0===t.avail_out&&(i.last_flush=-1),tf;if(2===n&&(e===tl?to(i):e!==td&&(tr(i,0,0,!1),e===tu&&(tT(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tM(t),0===t.avail_out))return i.last_flush=-1,tf}return e!==tc?tf:i.wrap<=0?tp:(2===i.wrap?(tL(i,255&t.adler),tL(i,t.adler>>8&255),tL(i,t.adler>>16&255),tL(i,t.adler>>24&255),tL(i,255&t.total_in),tL(i,t.total_in>>8&255),tL(i,t.total_in>>16&255),tL(i,t.total_in>>24&255)):(tN(i,t.adler>>>16),tN(i,65535&t.adler)),tM(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?tf:tp)},deflateEnd:t=>{if(tG(t))return tg;let e=t.state.status;return t.state=null,113===e?tI(t,tm):tf},deflateSetDictionary:(t,e)=>{let i=e.length;if(tG(t))return tg;let n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return tg;if(1===r&&(t.adler=X(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===r&&(tT(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}let s=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,tD(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do n.ins_h=tP(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++;while(--e)n.strstart=t,n.lookahead=2,tD(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,n.wrap=r,tf},deflateInfo:"pako deflate (from Nodeca project)"};const tX=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var tJ={assign:function(t){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let i=e.shift();if(i){if("object"!=typeof i)throw TypeError(i+"must be non-object");for(let e in i)tX(i,e)&&(t[e]=i[e])}}return t},flattenChunks:t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;let i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i}};let t0=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){t0=!1}const t1=new Uint8Array(256);for(let t=0;t<256;t++)t1[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;t1[254]=t1[254]=1;const t2=(t,e)=>{if(e<65534&&t.subarray&&t0)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i};var t5={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,i,n,r,s,a=t.length,o=0;for(r=0;r<a;r++)(64512&(i=t.charCodeAt(r)))==55296&&r+1<a&&(64512&(n=t.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(n-56320),r++),o+=i<128?1:i<2048?2:i<65536?3:4;for(s=0,e=new Uint8Array(o),r=0;s<o;r++)(64512&(i=t.charCodeAt(r)))==55296&&r+1<a&&(64512&(n=t.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?e[s++]=i:(i<2048?e[s++]=192|i>>>6:(i<65536?e[s++]=224|i>>>12:(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63),e[s++]=128|i>>>6&63),e[s++]=128|63&i);return e},buf2string:(t,e)=>{let i,n;let r=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let s=Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){s[n++]=e;continue}let a=t1[e];if(a>4){s[n++]=65533,i+=a-1;continue}for(e&=2===a?31:3===a?15:7;a>1&&i<r;)e=e<<6|63&t[i++],a--;if(a>1){s[n++]=65533;continue}e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}return t2(s,n)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&(192&t[i])==128;)i--;return i<0||0===i?e:i+t1[t[i]]>e?i:e}},t3=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const t6=Object.prototype.toString,{Z_NO_FLUSH:t4,Z_SYNC_FLUSH:t9,Z_FULL_FLUSH:t8,Z_FINISH:t7,Z_OK:et,Z_STREAM_END:ee,Z_DEFAULT_COMPRESSION:ei,Z_DEFAULT_STRATEGY:en,Z_DEFLATED:er}=ti;function es(t){this.options=tJ.assign({level:ei,method:er,chunkSize:16384,windowBits:15,memLevel:8,strategy:en},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new t3,this.strm.avail_out=0;let i=tQ.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==et)throw Error(te[i]);if(e.header&&tQ.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?t5.string2buf(e.dictionary):"[object ArrayBuffer]"===t6.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=tQ.deflateSetDictionary(this.strm,t))!==et)throw Error(te[i]);this._dict_set=!0}}function ea(t,e){let i=new es(e);if(i.push(t,!0),i.err)throw i.msg||te[i.err];return i.result}es.prototype.push=function(t,e){let i,n;let r=this.strm,s=this.options.chunkSize;if(this.ended)return!1;for(n=e===~~e?e:!0===e?t7:t4,"string"==typeof t?r.input=t5.string2buf(t):"[object ArrayBuffer]"===t6.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(0===r.avail_out&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(n===t9||n===t8)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if((i=tQ.deflate(r,n))===ee)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=tQ.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===et;if(0===r.avail_out){this.onData(r.output);continue}if(n>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(0===r.avail_in)break}return!0},es.prototype.onData=function(t){this.chunks.push(t)},es.prototype.onEnd=function(t){t===et&&(this.result=tJ.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var eo=function(t,e){let i,n,r,s,a,o,h,l,u,c,d,f,p,g,m,_,v,y,b,x,w,k,C,S;let I=t.state;i=t.next_in,C=t.input,n=i+(t.avail_in-5),r=t.next_out,S=t.output,s=r-(e-t.avail_out),a=r+(t.avail_out-257),o=I.dmax,h=I.wsize,l=I.whave,u=I.wnext,c=I.window,d=I.hold,f=I.bits,p=I.lencode,g=I.distcode,m=(1<<I.lenbits)-1,_=(1<<I.distbits)-1;i:do for(f<15&&(d+=C[i++]<<f,f+=8,d+=C[i++]<<f,f+=8),v=p[d&m];;){if(d>>>=y=v>>>24,f-=y,0==(y=v>>>16&255))S[r++]=65535&v;else if(16&y)for(b=65535&v,(y&=15)&&(f<y&&(d+=C[i++]<<f,f+=8),b+=d&(1<<y)-1,d>>>=y,f-=y),f<15&&(d+=C[i++]<<f,f+=8,d+=C[i++]<<f,f+=8),v=g[d&_];;){if(d>>>=y=v>>>24,f-=y,16&(y=v>>>16&255)){if(x=65535&v,f<(y&=15)&&(d+=C[i++]<<f,(f+=8)<y&&(d+=C[i++]<<f,f+=8)),(x+=d&(1<<y)-1)>o){t.msg="invalid distance too far back",I.mode=16209;break i}if(d>>>=y,f-=y,x>(y=r-s)){if((y=x-y)>l&&I.sane){t.msg="invalid distance too far back",I.mode=16209;break i}if(w=0,k=c,0===u){if(w+=h-y,y<b){b-=y;do S[r++]=c[w++];while(--y)w=r-x,k=S}}else if(u<y){if(w+=h+u-y,(y-=u)<b){b-=y;do S[r++]=c[w++];while(--y)if(w=0,u<b){b-=y=u;do S[r++]=c[w++];while(--y)w=r-x,k=S}}}else if(w+=u-y,y<b){b-=y;do S[r++]=c[w++];while(--y)w=r-x,k=S}for(;b>2;)S[r++]=k[w++],S[r++]=k[w++],S[r++]=k[w++],b-=3;b&&(S[r++]=k[w++],b>1&&(S[r++]=k[w++]))}else{w=r-x;do S[r++]=S[w++],S[r++]=S[w++],S[r++]=S[w++],b-=3;while(b>2)b&&(S[r++]=S[w++],b>1&&(S[r++]=S[w++]))}}else if((64&y)==0){v=g[(65535&v)+(d&(1<<y)-1)];continue}else{t.msg="invalid distance code",I.mode=16209;break i}break}else if((64&y)==0){v=p[(65535&v)+(d&(1<<y)-1)];continue}else if(32&y){I.mode=16191;break i}else{t.msg="invalid literal/length code",I.mode=16209;break i}break}while(i<n&&r<a)i-=b=f>>3,f-=b<<3,d&=(1<<f)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?5+(n-i):5-(i-n),t.avail_out=r<a?257+(a-r):257-(r-a),I.hold=d,I.bits=f};const eh=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),el=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),eu=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ec=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ed=(t,e,i,n,r,s,a,o)=>{let h,l,u,c,d,f,p,g,m;let _=o.bits,v=0,y=0,b=0,x=0,w=0,k=0,C=0,S=0,I=0,E=0,T=null,A=new Uint16Array(16),P=new Uint16Array(16),M=null;for(v=0;v<=15;v++)A[v]=0;for(y=0;y<n;y++)A[e[i+y]]++;for(x=15,w=_;x>=1&&0===A[x];x--);if(w>x&&(w=x),0===x)return r[s++]=20971520,r[s++]=20971520,o.bits=1,0;for(b=1;b<x&&0===A[b];b++);for(w<b&&(w=b),S=1,v=1;v<=15;v++)if(S<<=1,(S-=A[v])<0)return -1;if(S>0&&(0===t||1!==x))return -1;for(v=1,P[1]=0;v<15;v++)P[v+1]=P[v]+A[v];for(y=0;y<n;y++)0!==e[i+y]&&(a[P[e[i+y]]++]=y);if(0===t?(T=M=a,f=20):1===t?(T=eh,M=el,f=257):(T=eu,M=ec,f=0),E=0,y=0,v=b,d=s,k=w,C=0,u=-1,c=(I=1<<w)-1,1===t&&I>852||2===t&&I>592)return 1;for(;;){p=v-C,a[y]+1<f?(g=0,m=a[y]):a[y]>=f?(g=M[a[y]-f],m=T[a[y]-f]):(g=96,m=0),h=1<<v-C,b=l=1<<k;do r[d+(E>>C)+(l-=h)]=p<<24|g<<16|m|0;while(0!==l)for(h=1<<v-1;E&h;)h>>=1;if(0!==h?(E&=h-1,E+=h):E=0,y++,0==--A[v]){if(v===x)break;v=e[i+a[y]]}if(v>w&&(E&c)!==u){for(0===C&&(C=w),d+=b,S=1<<(k=v-C);k+C<x&&!((S-=A[k+C])<=0);)k++,S<<=1;if(I+=1<<k,1===t&&I>852||2===t&&I>592)return 1;r[u=E&c]=w<<24|k<<16|d-s|0}}return 0!==E&&(r[d+E]=v-C<<24|4194304),o.bits=w,0};const{Z_FINISH:ef,Z_BLOCK:ep,Z_TREES:eg,Z_OK:em,Z_STREAM_END:e_,Z_NEED_DICT:ev,Z_STREAM_ERROR:ey,Z_DATA_ERROR:eb,Z_MEM_ERROR:ex,Z_BUF_ERROR:ew,Z_DEFLATED:ek}=ti,eC=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function eS(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const eI=t=>{if(!t)return 1;let e=t.state;return!e||e.strm!==t||e.mode<16180||e.mode>16211?1:0},eE=t=>{if(eI(t))return ey;let e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=16180,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,em},eT=t=>{if(eI(t))return ey;let e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,eE(t)},eA=(t,e)=>{let i;if(eI(t))return ey;let n=t.state;return(e<0?(i=0,e=-e):(i=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15))?ey:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,eT(t))},eP=(t,e)=>{if(!t)return ey;let i=new eS;t.state=i,i.strm=t,i.window=null,i.mode=16180;let n=eA(t,e);return n!==em&&(t.state=null),n};let eM=!0;const eO=t=>{if(eM){n=new Int32Array(512),r=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ed(1,t.lens,0,288,n,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ed(2,t.lens,0,32,r,0,t.work,{bits:5}),eM=!1}t.lencode=n,t.lenbits=9,t.distcode=r,t.distbits=5},eL=(t,e,i,n)=>{let r;let s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):((r=s.wsize-s.wnext)>n&&(r=n),s.window.set(e.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var eN={inflateReset:eT,inflateReset2:eA,inflateResetKeep:eE,inflateInit:t=>eP(t,15),inflateInit2:eP,inflate:(t,e)=>{let i,n,r,s,a,o,h,l,u,c,d,f,p,g,m,_,v,y,b,x,w,k,C,S;let I=0,E=new Uint8Array(4),T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(eI(t)||!t.output||!t.input&&0!==t.avail_in)return ey;16191===(i=t.state).mode&&(i.mode=16192),a=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,n=t.input,o=t.avail_in,l=i.hold,u=i.bits,c=o,d=h,k=em;n:for(;;)switch(i.mode){case 16180:if(0===i.wrap){i.mode=16192;break}for(;u<16;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(2&i.wrap&&35615===l){0===i.wbits&&(i.wbits=15),i.check=0,E[0]=255&l,E[1]=l>>>8&255,i.check=tt(i.check,E,2,0),l=0,u=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",i.mode=16209;break}if((15&l)!==ek){t.msg="unknown compression method",i.mode=16209;break}if(l>>>=4,u-=4,w=(15&l)+8,0===i.wbits&&(i.wbits=w),w>15||w>i.wbits){t.msg="invalid window size",i.mode=16209;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&l?16189:16191,l=0,u=0;break;case 16181:for(;u<16;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(i.flags=l,(255&i.flags)!==ek){t.msg="unknown compression method",i.mode=16209;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=16209;break}i.head&&(i.head.text=l>>8&1),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=tt(i.check,E,2,0)),l=0,u=0,i.mode=16182;case 16182:for(;u<32;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.head&&(i.head.time=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,E[2]=l>>>16&255,E[3]=l>>>24&255,i.check=tt(i.check,E,4,0)),l=0,u=0,i.mode=16183;case 16183:for(;u<16;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.head&&(i.head.xflags=255&l,i.head.os=l>>8),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=tt(i.check,E,2,0)),l=0,u=0,i.mode=16184;case 16184:if(1024&i.flags){for(;u<16;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.length=l,i.head&&(i.head.extra_len=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=tt(i.check,E,2,0)),l=0,u=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&((f=i.length)>o&&(f=o),f&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(s,s+f),w)),512&i.flags&&4&i.wrap&&(i.check=tt(i.check,n,f,s)),o-=f,s+=f,i.length-=f),i.length))break n;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===o)break n;f=0;do w=n[s+f++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w));while(w&&f<o)if(512&i.flags&&4&i.wrap&&(i.check=tt(i.check,n,f,s)),o-=f,s+=f,w)break n}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===o)break n;f=0;do w=n[s+f++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w));while(w&&f<o)if(512&i.flags&&4&i.wrap&&(i.check=tt(i.check,n,f,s)),o-=f,s+=f,w)break n}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;u<16;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(4&i.wrap&&l!==(65535&i.check)){t.msg="header crc mismatch",i.mode=16209;break}l=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=16191;break;case 16189:for(;u<32;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}t.adler=i.check=eC(l),l=0,u=0,i.mode=16190;case 16190:if(0===i.havedict)return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,i.hold=l,i.bits=u,ev;t.adler=i.check=1,i.mode=16191;case 16191:if(e===ep||e===eg)break n;case 16192:if(i.last){l>>>=7&u,u-=7&u,i.mode=16206;break}for(;u<3;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}switch(i.last=1&l,u-=1,3&(l>>>=1)){case 0:i.mode=16193;break;case 1:if(eO(i),i.mode=16199,e===eg){l>>>=2,u-=2;break n}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=16209}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",i.mode=16209;break}if(i.length=65535&l,l=0,u=0,i.mode=16194,e===eg)break n;case 16194:i.mode=16195;case 16195:if(f=i.length){if(f>o&&(f=o),f>h&&(f=h),0===f)break n;r.set(n.subarray(s,s+f),a),o-=f,s+=f,h-=f,a+=f,i.length-=f;break}i.mode=16191;break;case 16196:for(;u<14;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(i.nlen=(31&l)+257,l>>>=5,u-=5,i.ndist=(31&l)+1,l>>>=5,u-=5,i.ncode=(15&l)+4,l>>>=4,u-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=16209;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;u<3;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.lens[T[i.have++]]=7&l,l>>>=3,u-=3}for(;i.have<19;)i.lens[T[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},k=ed(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,k){t.msg="invalid code lengths set",i.mode=16209;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;m=(I=i.lencode[l&(1<<i.lenbits)-1])>>>24,_=I>>>16&255,v=65535&I,!(m<=u);){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(v<16)l>>>=m,u-=m,i.lens[i.have++]=v;else{if(16===v){for(S=m+2;u<S;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(l>>>=m,u-=m,0===i.have){t.msg="invalid bit length repeat",i.mode=16209;break}w=i.lens[i.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===v){for(S=m+3;u<S;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}l>>>=m,u-=m,w=0,f=3+(7&l),l>>>=3,u-=3}else{for(S=m+7;u<S;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}l>>>=m,u-=m,w=0,f=11+(127&l),l>>>=7,u-=7}if(i.have+f>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=16209;break}for(;f--;)i.lens[i.have++]=w}}if(16209===i.mode)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=16209;break}if(i.lenbits=9,C={bits:i.lenbits},k=ed(1,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,k){t.msg="invalid literal/lengths set",i.mode=16209;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},k=ed(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,k){t.msg="invalid distances set",i.mode=16209;break}if(i.mode=16199,e===eg)break n;case 16199:i.mode=16200;case 16200:if(o>=6&&h>=258){t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,i.hold=l,i.bits=u,eo(t,d),a=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,n=t.input,o=t.avail_in,l=i.hold,u=i.bits,16191===i.mode&&(i.back=-1);break}for(i.back=0;m=(I=i.lencode[l&(1<<i.lenbits)-1])>>>24,_=I>>>16&255,v=65535&I,!(m<=u);){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(_&&(240&_)==0){for(y=m,b=_,x=v;m=(I=i.lencode[x+((l&(1<<y+b)-1)>>y)])>>>24,_=I>>>16&255,v=65535&I,!(y+m<=u);){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}l>>>=y,u-=y,i.back+=y}if(l>>>=m,u-=m,i.back+=m,i.length=v,0===_){i.mode=16205;break}if(32&_){i.back=-1,i.mode=16191;break}if(64&_){t.msg="invalid literal/length code",i.mode=16209;break}i.extra=15&_,i.mode=16201;case 16201:if(i.extra){for(S=i.extra;u<S;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;m=(I=i.distcode[l&(1<<i.distbits)-1])>>>24,_=I>>>16&255,v=65535&I,!(m<=u);){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if((240&_)==0){for(y=m,b=_,x=v;m=(I=i.distcode[x+((l&(1<<y+b)-1)>>y)])>>>24,_=I>>>16&255,v=65535&I,!(y+m<=u);){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}l>>>=y,u-=y,i.back+=y}if(l>>>=m,u-=m,i.back+=m,64&_){t.msg="invalid distance code",i.mode=16209;break}i.offset=v,i.extra=15&_,i.mode=16203;case 16203:if(i.extra){for(S=i.extra;u<S;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=16209;break}i.mode=16204;case 16204:if(0===h)break n;if(f=d-h,i.offset>f){if((f=i.offset-f)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=16209;break}f>i.wnext?(f-=i.wnext,p=i.wsize-f):p=i.wnext-f,f>i.length&&(f=i.length),g=i.window}else g=r,p=a-i.offset,f=i.length;f>h&&(f=h),h-=f,i.length-=f;do r[a++]=g[p++];while(--f)0===i.length&&(i.mode=16200);break;case 16205:if(0===h)break n;r[a++]=i.length,h--,i.mode=16200;break;case 16206:if(i.wrap){for(;u<32;){if(0===o)break n;o--,l|=n[s++]<<u,u+=8}if(d-=h,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?tt(i.check,r,d,a-d):X(i.check,r,d,a-d)),d=h,4&i.wrap&&(i.flags?l:eC(l))!==i.check){t.msg="incorrect data check",i.mode=16209;break}l=0,u=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;u<32;){if(0===o)break n;o--,l+=n[s++]<<u,u+=8}if(4&i.wrap&&l!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=16209;break}l=0,u=0}i.mode=16208;case 16208:k=e_;break n;case 16209:k=eb;break n;case 16210:return ex;default:return ey}return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,i.hold=l,i.bits=u,(i.wsize||d!==t.avail_out&&i.mode<16209&&(i.mode<16206||e!==ef))&&eL(t,t.output,t.next_out,d-t.avail_out),c-=t.avail_in,d-=t.avail_out,t.total_in+=c,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?tt(i.check,r,d,t.next_out-d):X(i.check,r,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(16191===i.mode?128:0)+(16199===i.mode||16194===i.mode?256:0),(0===c&&0===d||e===ef)&&k===em&&(k=ew),k},inflateEnd:t=>{if(eI(t))return ey;let e=t.state;return e.window&&(e.window=null),t.state=null,em},inflateGetHeader:(t,e)=>{if(eI(t))return ey;let i=t.state;return(2&i.wrap)==0?ey:(i.head=e,e.done=!1,em)},inflateSetDictionary:(t,e)=>{let i;let n=e.length;return eI(t)||0!==(i=t.state).wrap&&16190!==i.mode?ey:16190===i.mode&&X(1,e,n,0)!==i.check?eb:eL(t,e,n,n)?(i.mode=16210,ex):(i.havedict=1,em)},inflateInfo:"pako inflate (from Nodeca project)"},eR=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ez=Object.prototype.toString,{Z_NO_FLUSH:eD,Z_FINISH:eB,Z_OK:ej,Z_STREAM_END:eV,Z_NEED_DICT:eF,Z_STREAM_ERROR:eU,Z_DATA_ERROR:eq,Z_MEM_ERROR:e$}=ti;function eZ(t){this.options=tJ.assign({chunkSize:65536,windowBits:15,to:""},t||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(15&e.windowBits)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new t3,this.strm.avail_out=0;let i=eN.inflateInit2(this.strm,e.windowBits);if(i!==ej||(this.header=new eR,eN.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=t5.string2buf(e.dictionary):"[object ArrayBuffer]"===ez.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=eN.inflateSetDictionary(this.strm,e.dictionary))!==ej)))throw Error(te[i])}function eH(t,e){let i=new eZ(e);if(i.push(t),i.err)throw i.msg||te[i.err];return i.result}eZ.prototype.push=function(t,e){let i,n,r;let s=this.strm,a=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(n=e===~~e?e:!0===e?eB:eD,"[object ArrayBuffer]"===ez.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(i=eN.inflate(s,n))===eF&&o&&((i=eN.inflateSetDictionary(s,o))===ej?i=eN.inflate(s,n):i===eq&&(i=eF));s.avail_in>0&&i===eV&&s.state.wrap>0&&0!==t[s.next_in];)eN.inflateReset(s),i=eN.inflate(s,n);switch(i){case eU:case eq:case eF:case e$:return this.onEnd(i),this.ended=!0,!1}if(r=s.avail_out,s.next_out&&(0===s.avail_out||i===eV)){if("string"===this.options.to){let t=t5.utf8border(s.output,s.next_out),e=s.next_out-t,i=t5.buf2string(s.output,t);s.next_out=e,s.avail_out=a-e,e&&s.output.set(s.output.subarray(t,t+e),0),this.onData(i)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out))}if(i!==ej||0!==r){if(i===eV)return i=eN.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},eZ.prototype.onData=function(t){this.chunks.push(t)},eZ.prototype.onEnd=function(t){t===ej&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=tJ.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const{Deflate:eG,deflate:eW,deflateRaw:eK,gzip:eY}={Deflate:es,deflate:ea,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ea(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ea(t,e)},constants:ti},{Inflate:eQ,inflate:eX,inflateRaw:eJ,ungzip:e0}={Inflate:eZ,inflate:eH,inflateRaw:function(t,e){return(e=e||{}).raw=!0,eH(t,e)},ungzip:eH,constants:ti};var e1={Deflate:eG,deflate:eW,deflateRaw:eK,gzip:eY,Inflate:eQ,inflate:eX,inflateRaw:eJ,ungzip:e0,constants:ti},e2={};e2=function(){for(var t=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),t<e?e:t>i?i:t},e={},i=0,n=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<n.length;i+=1){var r=n[i];e["[object "+r+"]"]=r.toLowerCase()}var s=function(t){return e[Object.prototype.toString.call(t)]||"object"},a=Math.PI,o={clip_rgb:function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var i=0;i<=3;i++)i<3?((e[i]<0||e[i]>255)&&(e._clipped=!0),e[i]=t(e[i],0,255)):3===i&&(e[i]=t(e[i],0,1));return e},limit:t,type:s,unpack:function(t,e){return(void 0===e&&(e=null),t.length>=3)?Array.prototype.slice.call(t):"object"==s(t[0])&&e?e.split("").filter(function(e){return void 0!==t[0][e]}).map(function(e){return t[0][e]}):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==s(t[e])?t[e].toLowerCase():null},TWOPI:2*a,PITHIRD:a/3,DEG2RAD:a/180,RAD2DEG:180/a},h={format:{},autodetect:[]},l=o.last,u=o.clip_rgb,c=o.type,d=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("object"===c(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var i=l(t),n=!1;if(!i){n=!0,h.sorted||(h.autodetect=h.autodetect.sort(function(t,e){return e.p-t.p}),h.sorted=!0);for(var r=0,s=h.autodetect;r<s.length;r+=1){var a=s[r];if(i=a.test.apply(a,t))break}}if(h.format[i]){var o=h.format[i].apply(null,n?t:t.slice(0,-1));this._rgb=u(o)}else throw Error("unknown format: "+t);3===this._rgb.length&&this._rgb.push(1)};d.prototype.toString=function(){return"function"==c(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var f=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f.Color,[null].concat(t)))};f.Color=d,f.version="2.4.2";var p=o.unpack,g=Math.max,m=o.unpack,_=o.unpack,v=o.type,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=p(t,"rgb"),n=i[0],r=i[1],s=i[2],a=1-g(n/=255,g(r/=255,s/=255)),o=a<1?1/(1-a):0;return[(1-n-a)*o,(1-r-a)*o,(1-s-a)*o,a]};d.prototype.cmyk=function(){return y(this._rgb)},f.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["cmyk"])))},h.format.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=m(t,"cmyk"))[0],n=t[1],r=t[2],s=t[3],a=t.length>4?t[4]:1;return 1===s?[0,0,0,a]:[i>=1?0:255*(1-i)*(1-s),n>=1?0:255*(1-n)*(1-s),r>=1?0:255*(1-r)*(1-s),a]},h.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===v(t=_(t,"cmyk"))&&4===t.length)return"cmyk"}});var b=o.unpack,x=o.last,w=function(t){return Math.round(100*t)/100},k=o.unpack,C=function(){for(var t,e,i=[],n=arguments.length;n--;)i[n]=arguments[n];var r=(i=k(i,"rgba"))[0],s=i[1],a=i[2],o=Math.min(r/=255,s/=255,a/=255),h=Math.max(r,s,a),l=(h+o)/2;return(h===o?(t=0,e=Number.NaN):t=l<.5?(h-o)/(h+o):(h-o)/(2-h-o),r==h?e=(s-a)/(h-o):s==h?e=2+(a-r)/(h-o):a==h&&(e=4+(r-s)/(h-o)),(e*=60)<0&&(e+=360),i.length>3&&void 0!==i[3])?[e,t,l,i[3]]:[e,t,l]},S=o.unpack,I=o.last,E=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=b(t,"hsla"),n=x(t)||"lsa";return i[0]=w(i[0]||0),i[1]=w(100*i[1])+"%",i[2]=w(100*i[2])+"%","hsla"===n||i.length>3&&i[3]<1?(i[3]=i.length>3?i[3]:1,n="hsla"):i.length=3,n+"("+i.join(",")+")"},T=Math.round,A=o.unpack,P=Math.round,M=function(){for(var t,e,i,n,r=[],s=arguments.length;s--;)r[s]=arguments[s];var a=(r=A(r,"hsl"))[0],o=r[1],h=r[2];if(0===o)e=i=n=255*h;else{var l=[0,0,0],u=[0,0,0],c=h<.5?h*(1+o):h+o-h*o,d=2*h-c,f=a/360;l[0]=f+1/3,l[1]=f,l[2]=f-1/3;for(var p=0;p<3;p++)l[p]<0&&(l[p]+=1),l[p]>1&&(l[p]-=1),6*l[p]<1?u[p]=d+(c-d)*6*l[p]:2*l[p]<1?u[p]=c:3*l[p]<2?u[p]=d+(c-d)*(2/3-l[p])*6:u[p]=d;e=(t=[P(255*u[0]),P(255*u[1]),P(255*u[2])])[0],i=t[1],n=t[2]}return r.length>3?[e,i,n,r[3]]:[e,i,n,1]},O=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,L=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,N=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,R=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,z=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,D=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,B=Math.round,j=function(t){if(t=t.toLowerCase().trim(),h.format.named)try{return h.format.named(t)}catch(t){}if(e=t.match(O)){for(var e,i=e.slice(1,4),n=0;n<3;n++)i[n]=+i[n];return i[3]=1,i}if(e=t.match(L)){for(var r=e.slice(1,5),s=0;s<4;s++)r[s]=+r[s];return r}if(e=t.match(N)){for(var a=e.slice(1,4),o=0;o<3;o++)a[o]=B(2.55*a[o]);return a[3]=1,a}if(e=t.match(R)){for(var l=e.slice(1,5),u=0;u<3;u++)l[u]=B(2.55*l[u]);return l[3]=+l[3],l}if(e=t.match(z)){var c=e.slice(1,4);c[1]*=.01,c[2]*=.01;var d=M(c);return d[3]=1,d}if(e=t.match(D)){var f=e.slice(1,4);f[1]*=.01,f[2]*=.01;var p=M(f);return p[3]=+e[4],p}};j.test=function(t){return O.test(t)||L.test(t)||N.test(t)||R.test(t)||z.test(t)||D.test(t)};var V=o.type,F=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=S(t,"rgba"),n=I(t)||"rgb";return"hsl"==n.substr(0,3)?E(C(i),n):(i[0]=T(i[0]),i[1]=T(i[1]),i[2]=T(i[2]),("rgba"===n||i.length>3&&i[3]<1)&&(i[3]=i.length>3?i[3]:1,n="rgba"),n+"("+i.slice(0,"rgb"===n?3:4).join(",")+")")};d.prototype.css=function(t){return F(this._rgb,t)},f.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["css"])))},h.format.css=j,h.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===V(t)&&j.test(t))return"css"}});var U=o.unpack;h.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=U(t,"rgba");return i[0]*=255,i[1]*=255,i[2]*=255,i},f.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["gl"])))},d.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var q=o.unpack,$=o.unpack,Z=Math.floor,H=o.unpack,G=o.type,W=function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];var n=q(e,"rgb"),r=n[0],s=n[1],a=n[2],o=Math.min(r,s,a),h=Math.max(r,s,a),l=h-o;return 0===l?t=Number.NaN:(r===h&&(t=(s-a)/l),s===h&&(t=2+(a-r)/l),a===h&&(t=4+(r-s)/l),(t*=60)<0&&(t+=360)),[t,100*l/255,o/(255-l)*100]};d.prototype.hcg=function(){return W(this._rgb)},f.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hcg"])))},h.format.hcg=function(){for(var t,e,i,n,r,s,a,o,h,l=[],u=arguments.length;u--;)l[u]=arguments[u];var c=(l=$(l,"hcg"))[0],d=l[1],f=l[2];f*=255;var p=255*d;if(0===d)a=o=h=f;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var g=Z(c/=60),m=c-g,_=f*(1-d),v=_+p*(1-m),y=_+p*m,b=_+p;switch(g){case 0:a=(t=[b,y,_])[0],o=t[1],h=t[2];break;case 1:a=(e=[v,b,_])[0],o=e[1],h=e[2];break;case 2:a=(i=[_,b,y])[0],o=i[1],h=i[2];break;case 3:a=(n=[_,v,b])[0],o=n[1],h=n[2];break;case 4:a=(r=[y,_,b])[0],o=r[1],h=r[2];break;case 5:a=(s=[b,_,v])[0],o=s[1],h=s[2]}}return[a,o,h,l.length>3?l[3]:1]},h.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===G(t=H(t,"hcg"))&&3===t.length)return"hcg"}});var K=o.unpack,Y=o.last,Q=Math.round,X=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=K(t,"rgba"),n=i[0],r=i[1],s=i[2],a=i[3],o=Y(t)||"auto";void 0===a&&(a=1),"auto"===o&&(o=a<1?"rgba":"rgb");var h="000000"+((n=Q(n))<<16|(r=Q(r))<<8|(s=Q(s))).toString(16);h=h.substr(h.length-6);var l="0"+Q(255*a).toString(16);switch(l=l.substr(l.length-2),o.toLowerCase()){case"rgba":return"#"+h+l;case"argb":return"#"+l+h;default:return"#"+h}},J=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,tt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,te=function(t){if(t.match(J)){(4===t.length||7===t.length)&&(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(tt)){(5===t.length||9===t.length)&&(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var i=parseInt(t,16),n=Math.round((255&i)/255*100)/100;return[i>>24&255,i>>16&255,i>>8&255,n]}throw Error("unknown hex color: "+t)},ti=o.type;d.prototype.hex=function(t){return X(this._rgb,t)},f.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hex"])))},h.format.hex=te,h.autodetect.push({p:4,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===ti(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var tn=o.unpack,tr=o.TWOPI,ts=Math.min,ta=Math.sqrt,to=Math.acos,th=o.unpack,tl=o.limit,tu=o.TWOPI,tc=o.PITHIRD,td=Math.cos,tf=o.unpack,tp=o.type,tg=function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];var n=tn(e,"rgb"),r=n[0],s=n[1],a=n[2],o=ts(r/=255,s/=255,a/=255),h=(r+s+a)/3,l=h>0?1-o/h:0;return 0===l?t=NaN:(t=to(t=(r-s+(r-a))/2/ta((r-s)*(r-s)+(r-a)*(s-a))),a>s&&(t=tr-t),t/=tr),[360*t,l,h]};d.prototype.hsi=function(){return tg(this._rgb)},f.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hsi"])))},h.format.hsi=function(){for(var t,e,i,n=[],r=arguments.length;r--;)n[r]=arguments[r];var s=(n=th(n,"hsi"))[0],a=n[1],o=n[2];return isNaN(s)&&(s=0),isNaN(a)&&(a=0),s>360&&(s-=360),s<0&&(s+=360),(s/=360)<1/3?e=1-((i=(1-a)/3)+(t=(1+a*td(tu*s)/td(tc-tu*s))/3)):s<2/3?(s-=1/3,i=1-((t=(1-a)/3)+(e=(1+a*td(tu*s)/td(tc-tu*s))/3))):(s-=2/3,t=1-((e=(1-a)/3)+(i=(1+a*td(tu*s)/td(tc-tu*s))/3))),[255*(t=tl(o*t*3)),255*(e=tl(o*e*3)),255*(i=tl(o*i*3)),n.length>3?n[3]:1]},h.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===tp(t=tf(t,"hsi"))&&3===t.length)return"hsi"}});var tm=o.unpack,t_=o.type;d.prototype.hsl=function(){return C(this._rgb)},f.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hsl"])))},h.format.hsl=M,h.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===t_(t=tm(t,"hsl"))&&3===t.length)return"hsl"}});var tv=o.unpack,ty=Math.min,tb=Math.max,tx=o.unpack,tw=Math.floor,tk=o.unpack,tC=o.type,tS=function(){for(var t,e,i=[],n=arguments.length;n--;)i[n]=arguments[n];var r=(i=tv(i,"rgb"))[0],s=i[1],a=i[2],o=ty(r,s,a),h=tb(r,s,a),l=h-o;return 0===h?(t=Number.NaN,e=0):(e=l/h,r===h&&(t=(s-a)/l),s===h&&(t=2+(a-r)/l),a===h&&(t=4+(r-s)/l),(t*=60)<0&&(t+=360)),[t,e,h/255]};d.prototype.hsv=function(){return tS(this._rgb)},f.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hsv"])))},h.format.hsv=function(){for(var t,e,i,n,r,s,a,o,h,l=[],u=arguments.length;u--;)l[u]=arguments[u];var c=(l=tx(l,"hsv"))[0],d=l[1],f=l[2];if(f*=255,0===d)a=o=h=f;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var p=tw(c/=60),g=c-p,m=f*(1-d),_=f*(1-d*g),v=f*(1-d*(1-g));switch(p){case 0:a=(t=[f,v,m])[0],o=t[1],h=t[2];break;case 1:a=(e=[_,f,m])[0],o=e[1],h=e[2];break;case 2:a=(i=[m,f,v])[0],o=i[1],h=i[2];break;case 3:a=(n=[m,_,f])[0],o=n[1],h=n[2];break;case 4:a=(r=[v,m,f])[0],o=r[1],h=r[2];break;case 5:a=(s=[f,m,_])[0],o=s[1],h=s[2]}}return[a,o,h,l.length>3?l[3]:1]},h.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===tC(t=tk(t,"hsv"))&&3===t.length)return"hsv"}});var tI={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},tE=o.unpack,tT=Math.pow,tA=function(t){return(t/=255)<=.04045?t/12.92:tT((t+.055)/1.055,2.4)},tP=function(t){return t>tI.t3?tT(t,1/3):t/tI.t2+tI.t0},tM=function(){for(var t,e,i,n=[],r=arguments.length;r--;)n[r]=arguments[r];var s=tE(n,"rgb"),a=(t=s[0],e=s[1],i=s[2],[tP((.4124564*(t=tA(t))+.3575761*(e=tA(e))+.1804375*(i=tA(i)))/tI.Xn),tP((.2126729*t+.7151522*e+.072175*i)/tI.Yn),tP((.0193339*t+.119192*e+.9503041*i)/tI.Zn)]),o=a[0],h=a[1],l=a[2],u=116*h-16;return[u<0?0:u,500*(o-h),200*(h-l)]},tO=o.unpack,tL=Math.pow,tN=function(t){return 255*(t<=.00304?12.92*t:1.055*tL(t,1/2.4)-.055)},tR=function(t){return t>tI.t1?t*t*t:tI.t2*(t-tI.t0)},tz=function(){for(var t,e,i,n=[],r=arguments.length;r--;)n[r]=arguments[r];var s=(n=tO(n,"lab"))[0],a=n[1],o=n[2];return e=(s+16)/116,t=isNaN(a)?e:e+a/500,i=isNaN(o)?e:e-o/200,e=tI.Yn*tR(e),[tN(3.2404542*(t=tI.Xn*tR(t))-1.5371385*e-.4985314*(i=tI.Zn*tR(i))),tN(-.969266*t+1.8760108*e+.041556*i),tN(.0556434*t-.2040259*e+1.0572252*i),n.length>3?n[3]:1]},tD=o.unpack,tB=o.type;d.prototype.lab=function(){return tM(this._rgb)},f.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["lab"])))},h.format.lab=tz,h.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===tB(t=tD(t,"lab"))&&3===t.length)return"lab"}});var tj=o.unpack,tV=o.RAD2DEG,tF=Math.sqrt,tU=Math.atan2,tq=Math.round,t$=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tj(t,"lab"),n=i[0],r=i[1],s=i[2],a=tF(r*r+s*s),o=(tU(s,r)*tV+360)%360;return 0===tq(1e4*a)&&(o=Number.NaN),[n,a,o]},tZ=o.unpack,tH=o.unpack,tG=o.DEG2RAD,tW=Math.sin,tK=Math.cos,tY=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tH(t,"lch"),n=i[0],r=i[1],s=i[2];return isNaN(s)&&(s=0),[n,tK(s*=tG)*r,tW(s)*r]},tQ=o.unpack,tX=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tY((t=tQ(t,"lch"))[0],t[1],t[2]),n=tz(i[0],i[1],i[2]);return[n[0],n[1],n[2],t.length>3?t[3]:1]},tJ=o.unpack,t0=o.unpack,t1=o.type,t2=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tZ(t,"rgb"),n=tM(i[0],i[1],i[2]);return t$(n[0],n[1],n[2])};d.prototype.lch=function(){return t2(this._rgb)},d.prototype.hcl=function(){return t2(this._rgb).reverse()},f.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["lch"])))},f.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["hcl"])))},h.format.lch=tX,h.format.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tJ(t,"hcl").reverse();return tX.apply(void 0,i)},["lch","hcl"].forEach(function(t){return h.autodetect.push({p:2,test:function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];if("array"===t1(e=t0(e,t))&&3===e.length)return t}})});var t5={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},t3=o.type;d.prototype.name=function(){for(var t=X(this._rgb,"rgb"),e=0,i=Object.keys(t5);e<i.length;e+=1){var n=i[e];if(t5[n]===t)return n.toLowerCase()}return t},h.format.named=function(t){if(t5[t=t.toLowerCase()])return te(t5[t]);throw Error("unknown color name: "+t)},h.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===t3(t)&&t5[t.toLowerCase()])return"named"}});var t6=o.unpack,t4=o.type,t9=o.type,t8=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=t6(t,"rgb");return(i[0]<<16)+(i[1]<<8)+i[2]};d.prototype.num=function(){return t8(this._rgb)},f.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["num"])))},h.format.num=function(t){if("number"==t4(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw Error("unknown num color: "+t)},h.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===t9(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var t7=o.unpack,et=o.type,ee=Math.round;d.prototype.rgb=function(t){return(void 0===t&&(t=!0),!1===t)?this._rgb.slice(0,3):this._rgb.slice(0,3).map(ee)},d.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map(function(e,i){return i<3?!1===t?e:ee(e):e})},f.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["rgb"])))},h.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=t7(t,"rgba");return void 0===i[3]&&(i[3]=1),i},h.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===et(t=t7(t,"rgba"))&&(3===t.length||4===t.length&&"number"==et(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var ei=Math.log,en=function(t){var e,i,n,r=t/100;return r<66?(e=255,i=r<6?0:-155.25485562709179-.44596950469579133*(i=r-2)+104.49216199393888*ei(i),n=r<20?0:-254.76935184120902+.8274096064007395*(n=r-10)+115.67994401066147*ei(n)):(e=351.97690566805693+.114206453784165*(e=r-55)-40.25366309332127*ei(e),i=325.4494125711974+.07943456536662342*(i=r-50)-28.0852963507957*ei(i),n=255),[e,i,n,1]},er=o.unpack,es=Math.round,ea=function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];for(var n=er(e,"rgb"),r=n[0],s=n[2],a=1e3,o=4e4;o-a>.4;){var h=en(t=(o+a)*.5);h[2]/h[0]>=s/r?o=t:a=t}return es(t)};d.prototype.temp=d.prototype.kelvin=d.prototype.temperature=function(){return ea(this._rgb)},f.temp=f.kelvin=f.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["temp"])))},h.format.temp=h.format.kelvin=h.format.temperature=en;var eo=o.unpack,eh=Math.cbrt,el=Math.pow,eu=Math.sign,ec=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=eo(t,"rgb"),n=i[0],r=i[1],s=i[2],a=[ed(n/255),ed(r/255),ed(s/255)],o=a[0],h=a[1],l=a[2],u=eh(.4122214708*o+.5363325363*h+.0514459929*l),c=eh(.2119034982*o+.6806995451*h+.1073969566*l),d=eh(.0883024619*o+.2817188376*h+.6299787005*l);return[.2104542553*u+.793617785*c-.0040720468*d,1.9779984951*u-2.428592205*c+.4505937099*d,.0259040371*u+.7827717662*c-.808675766*d]};function ed(t){var e=Math.abs(t);return e<.04045?t/12.92:(eu(t)||1)*el((e+.055)/1.055,2.4)}var ef=o.unpack,ep=Math.pow,eg=Math.sign,em=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=ef(t,"lab"))[0],n=t[1],r=t[2],s=ep(i+.3963377774*n+.2158037573*r,3),a=ep(i-.1055613458*n-.0638541728*r,3),o=ep(i-.0894841775*n-1.291485548*r,3);return[255*e_(4.0767416621*s-3.3077115913*a+.2309699292*o),255*e_(-1.2684380046*s+2.6097574011*a-.3413193965*o),255*e_(-.0041960863*s-.7034186147*a+1.707614701*o),t.length>3?t[3]:1]};function e_(t){var e=Math.abs(t);return e>.0031308?(eg(t)||1)*(1.055*ep(e,1/2.4)-.055):12.92*t}var ev=o.unpack,ey=o.type;d.prototype.oklab=function(){return ec(this._rgb)},f.oklab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["oklab"])))},h.format.oklab=em,h.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===ey(t=ev(t,"oklab"))&&3===t.length)return"oklab"}});var eb=o.unpack,ex=o.unpack,ew=o.unpack,ek=o.type,eC=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=eb(t,"rgb"),n=ec(i[0],i[1],i[2]);return t$(n[0],n[1],n[2])};d.prototype.oklch=function(){return eC(this._rgb)},f.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(d,[null].concat(t,["oklch"])))},h.format.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tY((t=ex(t,"lch"))[0],t[1],t[2]),n=em(i[0],i[1],i[2]);return[n[0],n[1],n[2],t.length>3?t[3]:1]},h.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("array"===ek(t=ew(t,"oklch"))&&3===t.length)return"oklch"}});var eS=o.type;d.prototype.alpha=function(t,e){return(void 0===e&&(e=!1),void 0!==t&&"number"===eS(t))?e?(this._rgb[3]=t,this):new d([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},d.prototype.clipped=function(){return this._rgb._clipped||!1},d.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=tI.Kn*t,new d(e,"lab").alpha(this.alpha(),!0)},d.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},d.prototype.darker=d.prototype.darken,d.prototype.brighter=d.prototype.brighten,d.prototype.get=function(t){var e=t.split("."),i=e[0],n=e[1],r=this[i]();if(!n)return r;var s=i.indexOf(n)-("ok"===i.substr(0,2)?2:0);if(s>-1)return r[s];throw Error("unknown channel "+n+" in mode "+i)};var eI=o.type,eE=Math.pow;d.prototype.luminance=function(t){if(void 0!==t&&"number"===eI(t)){if(0===t)return new d([0,0,0,this._rgb[3]],"rgb");if(1===t)return new d([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),i=20,n=function(e,r){var s=e.interpolate(r,.5,"rgb"),a=s.luminance();return!(1e-7>Math.abs(t-a))&&i--?a>t?n(e,s):n(s,r):s},r=(e>t?n(new d([0,0,0]),this):n(this,new d([255,255,255]))).rgb();return new d(r.concat([this._rgb[3]]))}return eT.apply(void 0,this._rgb.slice(0,3))};var eT=function(t,e,i){return .2126*(t=eA(t))+.7152*(e=eA(e))+.0722*(i=eA(i))},eA=function(t){return(t/=255)<=.03928?t/12.92:eE((t+.055)/1.055,2.4)},eP={},eM=o.type,eO=function(t,e,i){void 0===i&&(i=.5);for(var n=[],r=arguments.length-3;r-- >0;)n[r]=arguments[r+3];var s=n[0]||"lrgb";if(eP[s]||n.length||(s=Object.keys(eP)[0]),!eP[s])throw Error("interpolation mode "+s+" is not defined");return"object"!==eM(t)&&(t=new d(t)),"object"!==eM(e)&&(e=new d(e)),eP[s](t,e,i).alpha(t.alpha()+i*(e.alpha()-t.alpha()))};d.prototype.mix=d.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];return eO.apply(void 0,[this,t,e].concat(i))},d.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,i=e[3];return t?(this._rgb=[e[0]*i,e[1]*i,e[2]*i,i],this):new d([e[0]*i,e[1]*i,e[2]*i,i],"rgb")},d.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=tI.Kn*t,e[1]<0&&(e[1]=0),new d(e,"lch").alpha(this.alpha(),!0)},d.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var eL=o.type;d.prototype.set=function(t,e,i){void 0===i&&(i=!1);var n=t.split("."),r=n[0],s=n[1],a=this[r]();if(!s)return a;var o=r.indexOf(s)-("ok"===r.substr(0,2)?2:0);if(o>-1){if("string"==eL(e))switch(e.charAt(0)){case"+":case"-":a[o]+=+e;break;case"*":a[o]*=+e.substr(1);break;case"/":a[o]/=+e.substr(1);break;default:a[o]=+e}else if("number"===eL(e))a[o]=e;else throw Error("unsupported value for Color.set");var h=new d(a,r);return i?(this._rgb=h._rgb,this):h}throw Error("unknown channel "+s+" in mode "+r)},eP.rgb=function(t,e,i){var n=t._rgb,r=e._rgb;return new d(n[0]+i*(r[0]-n[0]),n[1]+i*(r[1]-n[1]),n[2]+i*(r[2]-n[2]),"rgb")};var eN=Math.sqrt,eR=Math.pow;eP.lrgb=function(t,e,i){var n=t._rgb,r=n[0],s=n[1],a=n[2],o=e._rgb,h=o[0],l=o[1],u=o[2];return new d(eN(eR(r,2)*(1-i)+eR(h,2)*i),eN(eR(s,2)*(1-i)+eR(l,2)*i),eN(eR(a,2)*(1-i)+eR(u,2)*i),"rgb")},eP.lab=function(t,e,i){var n=t.lab(),r=e.lab();return new d(n[0]+i*(r[0]-n[0]),n[1]+i*(r[1]-n[1]),n[2]+i*(r[2]-n[2]),"lab")};var ez=function(t,e,i,n){var r,s,a,o,h,l,u,c,f,p,g,m,_,v;return"hsl"===n?(a=t.hsl(),o=e.hsl()):"hsv"===n?(a=t.hsv(),o=e.hsv()):"hcg"===n?(a=t.hcg(),o=e.hcg()):"hsi"===n?(a=t.hsi(),o=e.hsi()):"lch"===n||"hcl"===n?(n="hcl",a=t.hcl(),o=e.hcl()):"oklch"===n&&(a=t.oklch().reverse(),o=e.oklch().reverse()),("h"===n.substr(0,1)||"oklch"===n)&&(h=(r=a)[0],u=r[1],f=r[2],l=(s=o)[0],c=s[1],p=s[2]),isNaN(h)||isNaN(l)?isNaN(h)?isNaN(l)?m=Number.NaN:(m=l,(1==f||0==f)&&"hsv"!=n&&(g=c)):(m=h,(1==p||0==p)&&"hsv"!=n&&(g=u)):(v=l>h&&l-h>180?l-(h+360):l<h&&h-l>180?l+360-h:l-h,m=h+i*v),void 0===g&&(g=u+i*(c-u)),_=f+i*(p-f),"oklch"===n?new d([_,g,m],n):new d([m,g,_],n)},eD=function(t,e,i){return ez(t,e,i,"lch")};eP.lch=eD,eP.hcl=eD,eP.num=function(t,e,i){var n=t.num();return new d(n+i*(e.num()-n),"num")},eP.hcg=function(t,e,i){return ez(t,e,i,"hcg")},eP.hsi=function(t,e,i){return ez(t,e,i,"hsi")},eP.hsl=function(t,e,i){return ez(t,e,i,"hsl")},eP.hsv=function(t,e,i){return ez(t,e,i,"hsv")},eP.oklab=function(t,e,i){var n=t.oklab(),r=e.oklab();return new d(n[0]+i*(r[0]-n[0]),n[1]+i*(r[1]-n[1]),n[2]+i*(r[2]-n[2]),"oklab")},eP.oklch=function(t,e,i){return ez(t,e,i,"oklch")};var eB=o.clip_rgb,ej=Math.pow,eV=Math.sqrt,eF=Math.PI,eU=Math.cos,eq=Math.sin,e$=Math.atan2,eZ=function(t,e){for(var i=t.length,n=[0,0,0,0],r=0;r<t.length;r++){var s=t[r],a=e[r]/i,o=s._rgb;n[0]+=ej(o[0],2)*a,n[1]+=ej(o[1],2)*a,n[2]+=ej(o[2],2)*a,n[3]+=o[3]*a}return n[0]=eV(n[0]),n[1]=eV(n[1]),n[2]=eV(n[2]),n[3]>.9999999&&(n[3]=1),new d(eB(n))},eH=o.type,eG=Math.pow,eW=function(t){var e="rgb",i=f("#ccc"),n=0,r=[0,1],s=[],a=[0,0],o=!1,h=[],l=!1,u=0,c=1,d=!1,p={},g=!0,m=1,_=function(t){if("string"===eH(t=t||["#fff","#000"])&&f.brewer&&f.brewer[t.toLowerCase()]&&(t=f.brewer[t.toLowerCase()]),"array"===eH(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=f(t[e]);s.length=0;for(var i=0;i<t.length;i++)s.push(i/(t.length-1))}return w(),h=t},v=function(t){if(null!=o){for(var e=o.length-1,i=0;i<e&&t>=o[i];)i++;return i-1}return 0},y=function(t){return t},b=function(t){return t},x=function(t,n){if(null==n&&(n=!1),isNaN(t)||null===t)return i;if(n)l=t;else if(o&&o.length>2){var r,l;l=v(t)/(o.length-2)}else l=c!==u?(t-u)/(c-u):1;l=b(l),n||(l=y(l)),1!==m&&(l=eG(l,m));var d=Math.floor(1e4*(l=Math.min(1,Math.max(0,l=a[0]+l*(1-a[0]-a[1])))));if(g&&p[d])r=p[d];else{if("array"===eH(h))for(var _=0;_<s.length;_++){var x=s[_];if(l<=x||l>=x&&_===s.length-1){r=h[_];break}if(l>x&&l<s[_+1]){l=(l-x)/(s[_+1]-x),r=f.interpolate(h[_],h[_+1],l,e);break}}else"function"===eH(h)&&(r=h(l));g&&(p[d]=r)}return r},w=function(){return p={}};_(t);var k=function(t){var e=f(x(t));return l&&e[l]?e[l]():e};return k.classes=function(t){if(null!=t){if("array"===eH(t))o=t,r=[t[0],t[t.length-1]];else{var e=f.analyze(r);o=0===t?[e.min,e.max]:f.limits(e,"e",t)}return k}return o},k.domain=function(t){if(!arguments.length)return r;u=t[0],c=t[t.length-1],s=[];var e=h.length;if(t.length===e&&u!==c)for(var i=0,n=Array.from(t);i<n.length;i+=1){var a=n[i];s.push((a-u)/(c-u))}else{for(var o=0;o<e;o++)s.push(o/(e-1));if(t.length>2){var l=t.map(function(e,i){return i/(t.length-1)}),d=t.map(function(t){return(t-u)/(c-u)});d.every(function(t,e){return l[e]===t})||(b=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=d[e+1];)e++;var i=(t-d[e])/(d[e+1]-d[e]);return l[e]+i*(l[e+1]-l[e])})}}return r=[u,c],k},k.mode=function(t){return arguments.length?(e=t,w(),k):e},k.range=function(t,e){return _(t),k},k.out=function(t){return l=t,k},k.spread=function(t){return arguments.length?(n=t,k):n},k.correctLightness=function(t){return null==t&&(t=!0),d=t,w(),y=d?function(t){for(var e=x(0,!0).lab()[0],i=x(1,!0).lab()[0],n=e>i,r=x(t,!0).lab()[0],s=e+(i-e)*t,a=r-s,o=0,h=1,l=20;Math.abs(a)>.01&&l-- >0;)n&&(a*=-1),a<0?(o=t,t+=(h-t)*.5):(h=t,t+=(o-t)*.5),a=(r=x(t,!0).lab()[0])-s;return t}:function(t){return t},k},k.padding=function(t){return null!=t?("number"===eH(t)&&(t=[t,t]),a=t,k):a},k.colors=function(e,i){arguments.length<2&&(i="hex");var n=[];if(0==arguments.length)n=h.slice(0);else if(1===e)n=[k(.5)];else if(e>1){var s=r[0],a=r[1]-s;n=(function(t,e,i){for(var n=[],r=t<e,s=i?r?e+1:e-1:e,a=t;r?a<s:a>s;r?a++:a--)n.push(a);return n})(0,e,!1).map(function(t){return k(s+t/(e-1)*a)})}else{t=[];var l=[];if(o&&o.length>2)for(var u=1,c=o.length,d=1<=c;d?u<c:u>c;d?u++:u--)l.push((o[u-1]+o[u])*.5);else l=r;n=l.map(function(t){return k(t)})}return f[i]&&(n=n.map(function(t){return t[i]()})),n},k.cache=function(t){return null!=t?(g=t,k):g},k.gamma=function(t){return null!=t?(m=t,k):m},k.nodata=function(t){return null!=t?(i=f(t),k):i},k},eK=function(t){for(var e=[1,1],i=1;i<t;i++){for(var n=[1],r=1;r<=e.length;r++)n[r]=(e[r]||0)+e[r-1];e=n}return e},eY=function(t){var e,i,n,r,s,a,o,h,l,u,c;if(2===(t=t.map(function(t){return new d(t)})).length)s=(e=t.map(function(t){return t.lab()}))[0],a=e[1],r=function(t){return new d([0,1,2].map(function(e){return s[e]+t*(a[e]-s[e])}),"lab")};else if(3===t.length)s=(i=t.map(function(t){return t.lab()}))[0],a=i[1],o=i[2],r=function(t){return new d([0,1,2].map(function(e){return(1-t)*(1-t)*s[e]+2*(1-t)*t*a[e]+t*t*o[e]}),"lab")};else if(4===t.length)s=(n=t.map(function(t){return t.lab()}))[0],a=n[1],o=n[2],h=n[3],r=function(t){return new d([0,1,2].map(function(e){return(1-t)*(1-t)*(1-t)*s[e]+3*(1-t)*(1-t)*t*a[e]+3*(1-t)*t*t*o[e]+t*t*t*h[e]}),"lab")};else if(t.length>=5)l=t.map(function(t){return t.lab()}),u=eK(c=t.length-1),r=function(t){var e=1-t;return new d([0,1,2].map(function(i){return l.reduce(function(n,r,s){return n+u[s]*Math.pow(e,c-s)*Math.pow(t,s)*r[i]},0)}),"lab")};else throw RangeError("No point in running bezier with only one color.");return r},eQ=function(t,e,i){if(!eQ[i])throw Error("unknown blend mode "+i);return eQ[i](t,e)},eX=function(t){return function(e,i){var n=f(i).rgb(),r=f(e).rgb();return f.rgb(t(n,r))}},eJ=function(t){return function(e,i){var n=[];return n[0]=t(e[0],i[0]),n[1]=t(e[1],i[1]),n[2]=t(e[2],i[2]),n}};eQ.normal=eX(eJ(function(t){return t})),eQ.multiply=eX(eJ(function(t,e){return t*e/255})),eQ.screen=eX(eJ(function(t,e){return 255*(1-(1-t/255)*(1-e/255))})),eQ.overlay=eX(eJ(function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))})),eQ.darken=eX(eJ(function(t,e){return t>e?e:t})),eQ.lighten=eX(eJ(function(t,e){return t>e?t:e})),eQ.dodge=eX(eJ(function(t,e){return 255===t?255:(t=e/255*255/(1-t/255))>255?255:t})),eQ.burn=eX(eJ(function(t,e){return 255*(1-(1-e/255)/(t/255))}));for(var e0=o.type,e1=o.clip_rgb,e2=o.TWOPI,e5=Math.pow,e3=Math.sin,e6=Math.cos,e4=Math.floor,e9=Math.random,e8=Math.log,e7=Math.pow,it=Math.floor,ie=Math.abs,ii=function(t,e){void 0===e&&(e=null);var i={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===s(t)&&(t=Object.values(t)),t.forEach(function(t){e&&"object"===s(t)&&(t=t[e]),null==t||isNaN(t)||(i.values.push(t),i.sum+=t,t<i.min&&(i.min=t),t>i.max&&(i.max=t),i.count+=1)}),i.domain=[i.min,i.max],i.limits=function(t,e){return ir(i,t,e)},i},ir=function(t,e,i){void 0===e&&(e="equal"),void 0===i&&(i=7),"array"==s(t)&&(t=ii(t));var n=t.min,r=t.max,a=t.values.sort(function(t,e){return t-e});if(1===i)return[n,r];var o=[];if("c"===e.substr(0,1)&&(o.push(n),o.push(r)),"e"===e.substr(0,1)){o.push(n);for(var h=1;h<i;h++)o.push(n+h/i*(r-n));o.push(r)}else if("l"===e.substr(0,1)){if(n<=0)throw Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*e8(n),u=Math.LOG10E*e8(r);o.push(n);for(var c=1;c<i;c++)o.push(e7(10,l+c/i*(u-l)));o.push(r)}else if("q"===e.substr(0,1)){o.push(n);for(var d=1;d<i;d++){var f=(a.length-1)*d/i,p=it(f);if(p===f)o.push(a[p]);else{var g=f-p;o.push(a[p]*(1-g)+a[p+1]*g)}}o.push(r)}else if("k"===e.substr(0,1)){var m,_=a.length,v=Array(_),y=Array(i),b=!0,x=0,w=null;(w=[]).push(n);for(var k=1;k<i;k++)w.push(n+k/i*(r-n));for(w.push(r);b;){for(var C=0;C<i;C++)y[C]=0;for(var S=0;S<_;S++)for(var I=a[S],E=Number.MAX_VALUE,T=void 0,A=0;A<i;A++){var P=ie(w[A]-I);P<E&&(E=P,T=A),y[T]++,v[S]=T}for(var M=Array(i),O=0;O<i;O++)M[O]=null;for(var L=0;L<_;L++)null===M[m=v[L]]?M[m]=a[L]:M[m]+=a[L];for(var N=0;N<i;N++)M[N]*=1/y[N];b=!1;for(var R=0;R<i;R++)if(M[R]!==w[R]){b=!0;break}w=M,++x>200&&(b=!1)}for(var z={},D=0;D<i;D++)z[D]=[];for(var B=0;B<_;B++)z[m=v[B]].push(a[B]);for(var j=[],V=0;V<i;V++)j.push(z[V][0]),j.push(z[V][z[V].length-1]);j=j.sort(function(t,e){return t-e}),o.push(j[0]);for(var F=1;F<j.length;F+=2){var U=j[F];isNaN(U)||-1!==o.indexOf(U)||o.push(U)}}return o},is={analyze:ii,limits:ir},ia=Math.sqrt,io=Math.pow,ih=Math.min,il=Math.max,iu=Math.atan2,ic=Math.abs,id=Math.cos,ip=Math.sin,ig=Math.exp,im=Math.PI,i_={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},iv=0,iy=Object.keys(i_);iv<iy.length;iv+=1){var ib=iy[iv];i_[ib.toLowerCase()]=i_[ib]}return f.average=function(t,e,i){void 0===e&&(e="lrgb"),void 0===i&&(i=null);var n=t.length;i||(i=Array.from(Array(n)).map(function(){return 1}));var r=n/i.reduce(function(t,e){return t+e});if(i.forEach(function(t,e){i[e]*=r}),t=t.map(function(t){return new d(t)}),"lrgb"===e)return eZ(t,i);for(var s=t.shift(),a=s.get(e),o=[],h=0,l=0,u=0;u<a.length;u++)if(a[u]=(a[u]||0)*i[0],o.push(isNaN(a[u])?0:i[0]),"h"===e.charAt(u)&&!isNaN(a[u])){var c=a[u]/180*eF;h+=eU(c)*i[0],l+=eq(c)*i[0]}var f=s.alpha()*i[0];t.forEach(function(t,n){var r=t.get(e);f+=t.alpha()*i[n+1];for(var s=0;s<a.length;s++)if(!isNaN(r[s])){if(o[s]+=i[n+1],"h"===e.charAt(s)){var u=r[s]/180*eF;h+=eU(u)*i[n+1],l+=eq(u)*i[n+1]}else a[s]+=r[s]*i[n+1]}});for(var p=0;p<a.length;p++)if("h"===e.charAt(p)){for(var g=e$(l/o[p],h/o[p])/eF*180;g<0;)g+=360;for(;g>=360;)g-=360;a[p]=g}else a[p]=a[p]/o[p];return f/=n,new d(a,e).alpha(f>.99999?1:f,!0)},f.bezier=function(t){var e=eY(t);return e.scale=function(){return eW(e)},e},f.blend=eQ,f.cubehelix=function(t,e,i,n,r){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=[0,1]);var s,a=0;"array"===e0(r)?s=r[1]-r[0]:(s=0,r=[r,r]);var o=function(o){var h=e2*((t+120)/360+e*o),l=e5(r[0]+s*o,n),u=(0!==a?i[0]+o*a:i)*l*(1-l)/2,c=e6(h),d=e3(h);return f(e1([255*(l+u*(-.14861*c+1.78277*d)),255*(l+u*(-.29227*c-.90649*d)),255*(l+1.97294*c*u),1]))};return o.start=function(e){return null==e?t:(t=e,o)},o.rotations=function(t){return null==t?e:(e=t,o)},o.gamma=function(t){return null==t?n:(n=t,o)},o.hue=function(t){return null==t?i:("array"===e0(i=t)?0==(a=i[1]-i[0])&&(i=i[1]):a=0,o)},o.lightness=function(t){return null==t?r:("array"===e0(t)?(r=t,s=t[1]-t[0]):(r=[t,t],s=0),o)},o.scale=function(){return f.scale(o)},o.hue(i),o},f.mix=f.interpolate=eO,f.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(e4(16*e9()));return new d(t,"hex")},f.scale=eW,f.analyze=is.analyze,f.contrast=function(t,e){t=new d(t),e=new d(e);var i=t.luminance(),n=e.luminance();return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)},f.deltaE=function(t,e,i,n,r){void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=1);var s=function(t){return 360*t/(2*im)},a=function(t){return 2*im*t/360};t=new d(t),e=new d(e);var o=Array.from(t.lab()),h=o[0],l=o[1],u=o[2],c=Array.from(e.lab()),f=c[0],p=c[1],g=c[2],m=(h+f)/2,_=(ia(io(l,2)+io(u,2))+ia(io(p,2)+io(g,2)))/2,v=.5*(1-ia(io(_,7)/(io(_,7)+io(25,7)))),y=l*(1+v),b=p*(1+v),x=ia(io(y,2)+io(u,2)),w=ia(io(b,2)+io(g,2)),k=(x+w)/2,C=s(iu(u,y)),S=s(iu(g,b)),I=C>=0?C:C+360,E=S>=0?S:S+360,T=ic(I-E)>180?(I+E+360)/2:(I+E)/2,A=1-.17*id(a(T-30))+.24*id(a(2*T))+.32*id(a(3*T+6))-.2*id(a(4*T-63)),P=E-I;P=180>=ic(P)?P:E<=I?P+360:P-360,P=2*ia(x*w)*ip(a(P)/2);var M=w-x,O=1+.015*io(m-50,2)/ia(20+io(m-50,2)),L=1+.045*k,N=1+.015*k*A,R=30*ig(-io((T-275)/25,2)),z=-(2*ia(io(k,7)/(io(k,7)+io(25,7))))*ip(2*a(R));return il(0,ih(100,ia(io((f-h)/(i*O),2)+io(M/(n*L),2)+io(P/(r*N),2)+M/(n*L)*z*(P/(r*N)))))},f.distance=function(t,e,i){void 0===i&&(i="lab"),t=new d(t),e=new d(e);var n=t.get(i),r=e.get(i),s=0;for(var a in n){var o=(n[a]||0)-(r[a]||0);s+=o*o}return Math.sqrt(s)},f.limits=is.limits,f.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(d,[null].concat(t))),!0}catch(t){return!1}},f.scales={cool:function(){return eW([f.hsl(180,1,.9),f.hsl(250,.7,.4)])},hot:function(){return eW(["#000","#f00","#ff0","#fff"]).mode("rgb")}},f.colors=t5,f.brewer=i_,f}();const e5=g.create({objectHash:ir});window.jsonDiffPatch=e5;const e3=Object.freeze({Left:0,Right:2});function e6(t){return t.charAt(0).toUpperCase()+t.slice(1)}function e4(...t){return t.findLast(t=>void 0!==t)}function e9(t){let e=document.createElement("span");return e.classList.add("beam"),e.style.backgroundColor=t,e.title=t,e}function e8(t){if(!t.length)return[];let e=a(e2).average(t).hex(),i=[];if(t.some(t=>t!==e)){let e=t.length-1;t.forEach((t,n)=>{if(i.push(e9(t)),n<e){let t=document.createElement("span");t.classList.add("text"),t.textContent="+",i.push(t)}});let n=document.createElement("span");n.classList.add("text"),n.textContent="=",i.push(n)}return i.push(e9(e)),i}function e7(t,e){let i=document.createElement("span");return i.classList.add("icon","material-symbols-outlined"),i.textContent=t,i.title=e??e6(t),i}function it(t){let e=document.createElement("span");return e.classList.add("text"),e.textContent=t.toString(),e}function ie(t){let e=window.atob((t+"===".slice((t.length+3)%4)).replace(/-/g,"+").replace(/_/g,"/"));return new TextDecoder().decode(e1.inflate(Uint8Array.from(e,t=>t.codePointAt(0))))}function ii(t){return window.btoa(String.fromCodePoint(...e1.deflate(new TextEncoder().encode(t)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ir(t,e){return"object"==typeof t&&"object"==typeof e?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every(i=>{let n=t[i],r=e[i];return"function"==typeof n?.equals?n.equals(r):ir(n,r)}):t===e}function is(t,e=null){document.dispatchEvent(new CustomEvent(t,{detail:e}))}function ia(t,e,i=0){return t&&e&&t.round().subtract(e.round()).length<=i}function io(t){return(e,i)=>e.subtract(t).length-i.subtract(t).length}function ih(t,e){let i=t.subtract(e);return i.length=i.length/2,t.subtract(i)}function il(t){return t+(t>=3?-3:3)}function iu(t,e=!0){return(t+=(e?-1:1)*2)<0?t+6:t>5?t-6:t}window.base64decode=ie,window.base64encode=ii;var d=u("hFpCu");class ic{#t={};constructor(t){this.setState(t)}getState(){return structuredClone(this.#t)}setState(t){this.#t=structuredClone(t)}updateState(t,e=!0){return t(this.#t),e&&is(ic.Events.Update,{object:this}),this.getState()}static Events=Object.freeze({Update:"state-update"})}class id extends ic{center;data;group;id=id.uniqueId++;locked;parent;sortOrder=100;type;constructor(t,e,i){super(e),this.type=e?.type||i?.type,this.data=Object.assign({id:this.id,type:this.type},i?.data||{}),this.locked=i?.locked!==!1,t&&(this.center=t.center),this.parent=t,this.group=new d.Group({data:this.data,locked:this.locked})}equals(t){return t instanceof id&&this.id===t.id}getColorElements(){return[]}getCompoundPath(){return new d.CompoundPath({children:this.group.clone({insert:!1}).children.filter(t=>!1!==t.data.collidable)})}getIndex(){return this.group.index}getLayer(){return this.group.parent}onClick(){}onCollision(t,e,i,n,r,s,a,o,h){return h}onDeselected(){}onInitialization(){}onSelected(){}remove(){this.group.remove()}toString(){return`[${this.type}:${this.id}]`}update(){}static Types=Object.freeze(Object.fromEntries(["beam","collision","filter","mask","portal","reflector","terminus","tile","wall"].map(t=>[t,e6(t)])));static uniqueId=0}var d=u("hFpCu");class ip{#e;#i={};constructor(t,e){Object.entries(e).forEach(([e,i])=>{"function"==typeof i&&(i={handler:i}),i.handler=i.handler.bind(t),this.#i[e]=i})}addEventListeners(t){this.#e=t??document,Object.entries(this.#i).forEach(([t,e])=>this.#e.addEventListener(t,e.handler,e.options))}removeEventListeners(){this.#e&&Object.entries(this.#i).forEach(([t,e])=>this.#e.removeEventListener(t,e.handler))}}const ig=document.getElementById("modifiers-immutable"),im=document.getElementById("modifiers-mutable");let i_=0;class iv extends ic{#n;#r;#s;#a=500;#o;configuration;element;disabled=!1;id=i_++;immutable=!1;name;selected=!1;tile;title;type;constructor(t,e){super(e),this.tile=t,this.type=e.type,this.#r=new ip(this,{click:this.#h,deselected:this.onDeselected,mousedown:this.onMouseDown,mouseleave:this.onMouseLeave,mouseup:this.onMouseUp,touchstart:{handler:this.onTouchStart,options:{passive:!1}},touchend:this.onTouchEnd})}attach(){let t=this.#n=document.createElement("li");this.immutable&&(this.disabled=!0);let e=this.element=document.createElement("span");e.classList.add("material-symbols-outlined","fill"),t.append(e),this.update(),this.#r.addEventListeners(t),this.immutable?ig.append(t):im.append(t)}detach(){this.#n&&(iv.deselect(),this.#r.removeEventListeners(),this.#n.remove(),this.selected=!1,this.element=void 0,this.#n=void 0)}dispatchEvent(t,e){is(t,Object.assign({},e||{},{modifier:this,tile:this.tile}))}equals(t){return t instanceof iv&&this.id===t.id}move(t){this.remove(),t.addModifier(this),this.tile=t}moveFilter(t){return t.modifiers.some(t=>t.type===iv.Types.immutable)}onClick(){this.selected=!1}onDeselected(){this.update({selected:!1}),this.tile.afterModify(),this.dispatchEvent(iv.Events.Deselected)}onMouseDown(){this.#s||this.tile.modifiers.some(t=>[iv.Types.immutable,iv.Types.lock].includes(t.type))||(this.#o=setTimeout(this.onSelected.bind(this),this.#a))}onMouseLeave(){clearTimeout(this.#o)}onMouseUp(){clearTimeout(this.#o)}onSelected(){iv.deselect(),this.update({selected:!0}),this.tile.beforeModify();let t=this.#s=new i1.Mask(this.#l.bind(this),{onClick:this.#u.bind(this)});this.dispatchEvent(i1.Events.Mask,{mask:t})}onTouchEnd(t){t.preventDefault(),this.onMouseUp(t),this.#h(t)}onTouchStart(t){t.preventDefault(),this.onMouseDown(t)}remove(){this.detach(),this.tile.removeModifier(this),this.tile=null}update(t){t=Object.assign({disabled:this.disabled,selected:this.selected,name:this.name,title:this.title},t||{}),this.disabled=t.disabled,this.name=t.name,this.title=t.title,this.selected=t.selected,this.#n.classList.toggle("disabled",this.disabled),this.#n.classList.toggle("selected",this.selected),this.element.textContent=this.name,this.element.title=this.title}#u(t,e){if(e&&e!==this.tile){let i=this.tile;this.move(e),t.updateState(),t.updateSelectedTile(e),t.unmask(),this.dispatchEvent(iv.Events.Moved,{fromTile:i})}else iv.deselect(),t.unmask();this.#s=void 0,this.update({selected:!1})}#l(t){return!t.equals(this.tile)&&this.moveFilter(t)}#h(t){if(!this.disabled&&!this.selected)return this.onClick(t)}static deselect(){let t=document.querySelector(".modifiers .selected");t&&t.dispatchEvent(new CustomEvent("deselected"))}static immutable(t){return t.type===iv.Types.immutable}static Events=Object.freeze({Deselected:"modifier-deselected",Invoked:"modifier-invoked",Moved:"modifier-moved"});static Types=Object.freeze(Object.fromEntries(["immutable","lock","move","rotate","swap","toggle"].map(t=>[t,e6(t)])))}class iy extends iv{#s;name="drag_pan";title="Move";attach(){super.attach()}onClick(t){super.onClick(t);let e=this.tile.items.filter(iy.movable);if(this.#s||!e.length)return;this.tile.beforeModify();let i=new i1.Mask(this.tileFilter.bind(this),{onClick:this.#u.bind(this),onUnmask:()=>this.tile.afterModify()});this.#s=i,is(i1.Events.Mask,{mask:i})}moveFilter(t){return super.moveFilter(t)||!t.items.some(t=>t.movable)}moveItems(t){let e=this.tile.items.filter(iy.movable);return e.forEach(e=>e.move(t)),{moved:[iy.data(this.tile,t,e)],tiles:[this.tile,t]}}tileFilter(t){return t.modifiers.some(iv.immutable)||t.items.filter(t=>t.type!==id.Types.beam).length>0&&t!==this.tile}#u(t,e){if(e){let i=this.moveItems(e);t.updateState(),t.updateSelectedTile(e),t.unmask(),this.dispatchEvent(iv.Events.Invoked,i)}else t.unmask();this.#s=void 0}static data(t,e,i){return{fromTile:t,toTile:e,items:i}}static movable(t){return t.movable}}const ib=t=>class extends t{movable;constructor(t,e){super(...arguments),this.movable=!1!==e.movable}move(t){this.parent.removeItem(this);let e=this.parent.center.subtract(t.center);this.group.position=this.group.position.subtract(e),this.parent=t,this.parent.addItem(this),this.center=this.parent.center,this.onMove()}onMove(){}};class ix{color;colors;connected;direction;done;insertAbove;onAdd;onRemove;point;pathIndex;segmentIndex;state;tile;constructor(t,e,i,n,r,s,o,h,l,u,c,d){if(u&&!(u instanceof iw))throw Error("Step.state must be instance of StepState");this.colors=Array.isArray(e)?Array.from(e):[e],this.colors.length&&(this.color=a(e2).average(this.colors).hex()),this.connected=o??!0,this.direction=i,this.done=l??!1,this.insertAbove=h,this.onAdd=c,this.onRemove=d,this.point=n,this.pathIndex=r,this.segmentIndex=s,this.state=u??new iw,this.tile=t}copy(t){return new ix(t.tile??this.tile,t.colors??t.color??this.colors,t.direction??this.direction,t.point??this.point,t.pathIndex??this.pathIndex,t.segmentIndex??this.segmentIndex,t.connected??this.connected,t.insertAbove??this.insertAbove,t.done??this.done,t.state??new iw(this.state),t.onAdd??this.onAdd,t.onRemove??this.onRemove)}equals(t){return ir(this,t)}static Stop=class extends ix{done=!0;constructor(){super(null,[])}}}class iw{#c={};constructor(){let t=Object.assign({},...arguments);Object.keys(t).forEach(e=>{this[e]=t[e]})}copy(...t){return new iw(...[this].concat(t))}get(t){let e=this.#d(t).map(t=>this[t]).filter(t=>t);if(e.length)return Object.assign({},...e)}has(t){return this.#d(t).some(t=>this[t])}#d(t){return this.#c[t.name]??=Object.keys(Reflect.construct(t,[]))}static Collision=class{collision;constructor(t,e){this.collision={point:t,item:e}}};static Filter=class{filter={}};static MergeInto=class{mergeInto;constructor(t){this.mergeInto={beam:t}}};static MergeWith=class{mergeWith;constructor(t){t=Array.isArray(t)?Array.from(t):[t],this.mergeWith={beams:t}}};static Portal=class{portal;constructor(t,e){this.portal={entryPortal:t,exitPortal:e}}};static Reflector=class{reflector;constructor(t){this.reflector={item:t}}};static TerminusConnection=class{terminusConnection;constructor(t,e){this.terminusConnection={terminus:t,opening:e}}}}class ik extends ib(id){constructor(t,{color:e}){super(...arguments),this.color=a(e2).average(Array.isArray(e)?e:[e]).hex();let i=new d.Color(e);i.alpha=.25;let n=new d.Path.RegularPolygon({center:t.center,closed:!0,radius:t.parameters.circumradius/3,sides:3,style:{fillColor:i,strokeColor:e,strokeWidth:2}});this.group.addChild(n)}getColorElements(){return[e9(this.color)]}onCollision(t,e,i,n,r,s,a){return a.copy(s.state.has(iw.Filter)?{colors:a.colors.concat([this.color])}:{state:new iw({insertAbove:this},new iw.Filter)})}}var d=u("hFpCu");class iC extends iv{clockwise;title="Rotate";constructor(t,e,i={}){super(...arguments),this.clockwise=e4(!0,e.clockwise,i.clockwise),this.name=iC.Names[this.clockwise?"right":"left"]}moveFilter(t){return super.moveFilter(t)||!t.items.some(t=>t.rotatable)}onClick(t){super.onClick(t);let e=this.tile.items.filter(t=>t.rotatable);e.forEach(t=>t.rotate(this.clockwise)),this.dispatchEvent(iv.Events.Invoked,{items:e})}onMouseDown(t){t.button===e3.Right?(this.clockwise=!this.clockwise,this.updateState(t=>{t.clockwise=this.clockwise}),this.update({name:iC.Names[this.clockwise?"right":"left"]})):super.onMouseDown(t)}static Names=Object.freeze({left:"rotate_left",right:"rotate_right "})}const iS=t=>class extends t{direction;rotatable;rotation=0;rotationDegrees;constructor(t,e,i={}){super(...arguments),this.direction=e4(e.direction,i.direction),this.rotatable=e4(!0,e.rotatable,i.rotatable),this.rotationDegrees=e4(60,e.rotationDegrees,i.rotationDegrees),this.rotation=e4(0,e.rotation,i.rotation)%this.getMaxRotation()}getDirection(t){return void 0===(t=t??this.direction)?t:(t+this.rotation+6)%6}getMaxRotation(){return 360/this.rotationDegrees}onInitialization(){super.onInitialization(),this.rotateGroup(this.rotation),void 0!==this.direction&&this.rotateGroup(this.direction)}rotateGroup(t){this.rotatable&&this.group.rotate(t*this.rotationDegrees,this.center)}rotate(t){let e=!1===t?-1:1;this.rotation=(e+this.rotation)%this.getMaxRotation(),this.updateState(t=>{t.rotation=this.rotation}),this.rotateGroup(e)}};class iI extends ib(iS(id)){constructor(t,e){super(t,e,{rotatable:void 0!==e.direction}),this.direction=e.direction;let i=t.parameters.circumradius/3,n=t.parameters.circumradius/5,r={fillColor:"black",strokeColor:"white",strokeWidth:2},s=[],a=new d.Path.Ellipse({center:t.center,radius:[n,i],style:r});s.push(a);let o=new d.Path.Ellipse({center:t.center,radius:[n-2*r.strokeWidth,i-2*r.strokeWidth],style:r});if(s.push(o),this.rotatable){let e=new(0,d.Path)({closed:!0,opacity:.25,segments:[t.center.add(new d.Point(0,i)),t.center.subtract(new d.Point(0,i)),t.center.subtract(new d.Point(2.5*n,0))],style:{fillColor:"black"}}).subtract(a);s.unshift(e)}this.group.addChildren(s),this.rotatable&&this.rotateGroup(1)}onCollision(t,e,i,n,r,s,a,o,h){let l=s.state.get(iw.Portal);if(!l)return a.copy({insertAbove:this,state:a.state.copy(new iw.Portal(this))});if(l.exitPortal===this)return a.copy({insertAbove:this});let u=this.getDirection(),c=void 0===u?u:il(this.getDirection()),d=t.getState().collisions?.[this.id],f=e.getItems().filter(t=>t.type===id.Types.portal&&!t.equals(this)&&t.getDirection()===c&&(!d||t.id===d));if(0===f.length)return console.debug("portal has no destinations, stopping"),h;if(1===f.length)return this.#f(f[0],a,l);{let i=f.map(t=>t.parent);return s.tile.beforeModify(),e.mask(new i1.Mask(t=>!(this.parent===t||i.some(e=>e===t)),{beam:t,onClick:(e,i)=>{let n=f.find(t=>t.parent===i);n&&(t.addStep(this.#f(n,a,l)),t.updateState(t=>{t.collisions||(t.collisions={}),t.collisions[this.id]=n.id}),e.unmask())},onUnmask:()=>{s.tile.afterModify()}})),new ix.Stop}}#f(t,e,i){return e.copy({connected:!1,direction:this.rotatable?this.getDirection():e.direction,insertAbove:t,tile:t.parent,point:t.parent.center,state:e.state.copy(new iw.Portal(i.entryPortal,t))})}}var d=u("hFpCu");class iE extends iv{on;title="Toggle";constructor(t,{on:e}){super(...arguments),this.on=e||!1,this.tile.items.forEach(t=>{t.toggled=this.on})}attach(){this.name=iE.Names[this.on?"on":"off"],super.attach()}moveFilter(t){return super.moveFilter(t)||!t.items.some(t=>t.toggleable)}onClick(t){super.onClick(t),this.on=!this.on;let e=this.tile.items.filter(t=>t.toggleable);e.forEach(t=>t.toggle(this.on)),this.update({name:iE.Names[this.on?"on":"off"]}),this.dispatchEvent(iv.Events.Invoked,{items:e})}static Names=Object.freeze({on:"toggle_on",off:"toggle_off "})}const iT=t=>class extends t{toggleable;toggled;constructor(t,e){super(...arguments),this.toggleable=!1!==e.toggleable}onToggle(){}toggle(t){this.toggled=t,this.onToggle()}};var d=u("hFpCu");class iA extends id{done=!1;path=[];sortOrder=3;#p;#g;#m=-1;#_=[];constructor(t,e,i){super(...arguments),this.group=null,this.#p=i.direction,this.#g={closed:!1,data:{id:this.id,type:this.type},locked:!0,strokeJoin:"round",strokeWidth:t.radius/12}}addStep(t){if(this.done=!1,this.#g.strokeColor=t.color,0===this.path.length){let t=new d.Path(this.#g);this.path.push(t),this.getLayer().insertChild(0,t)}let e=this.path[this.path.length-1],i=this.#_[this.#_.length-1];if(!t.connected||i&&(t.color!==i.color||t.insertAbove!==i.insertAbove)){console.debug(this.toString(),"adding new path item for step:",t,"previous step:",i);let e=new d.Path(this.#g),n=[t.point];t.connected&&n.unshift(i.point),e.add(...n),this.path.push(e);let r=t.insertAbove?t.insertAbove.getIndex()+1:0;this.getLayer().insertChild(r,e),t.segmentIndex=0}else e.add(t.point),t.segmentIndex=e.segments.length-1;t.pathIndex=this.path.length-1,this.#_.push(t),t.tile.items.some(t=>t===this)||t.tile.addItem(this),this.#m++,"function"==typeof t.onAdd&&t.onAdd(),console.debug(this.toString(),"added step",this.#m,t),this.#v(t)}getColor(){return this.getStep()?.color||this.getOpening().color}getColorElements(t){let e=this.getSteps(t).find(t=>t.state?.has(iw.MergeWith));return e?e8(e.color):[]}getCompoundPath(){return new d.CompoundPath({children:this.path.map(t=>t.clone({insert:!1}))})}getIndex(){return this.path[this.path.length-1].index}getLayer(){return this.parent.getLayer()}getMergeWithStepIndex(t){return this.getSteps().findIndex(e=>e.state?.get(iw.MergeWith)?.beams.some(e=>e.equals(t)))}getOpening(){return this.parent.getOpening(this.#p)}getState(){return this.parent.getState().openings[this.#p]}getStep(t){return this.#_[t||this.lastStepIndex()]}getSteps(t){return t?this.#_.filter(e=>e.tile===t):this.#_}isComplete(){return this.isOn()&&this.done}isConnected(){let t=this.getStep();return t?.state.has(iw.TerminusConnection)||t?.state.get(iw.MergeInto)?.beam.isConnected()}isOn(){let t=this.getOpening();return t.on&&!t.connected}isPending(){return this.isOn()&&!this.done}lastStepIndex(){return this.length()-1}length(){return this.#_.length}onBeamUpdated(t){let e=t.detail.beam;if(e.isPending())return;console.debug(this.toString(),"onBeamUpdated",t);let i=e.getStep();if(this.isComplete()){let t=this.getStep(),n=t.state.get(iw.Collision);if(n?.item?.equals(e)&&!i?.state.get(iw.Collision)?.point.equals(n.point)){console.debug(this.toString(),"re-evaluating collision with",e.toString()),this.done=!1,this.#m=Math.max(this.#m-1,0);return}let r=t.state.get(iw.MergeInto);if(r?.beam.equals(e)&&0>e.getMergeWithStepIndex(this)){console.debug(this.toString(),"re-evaluating merge into",e.toString()),this.done=!1,this.#m=Math.max(this.#m-1,0);return}}let n=this.getMergeWithStepIndex(e);n>=0&&!i?.state.get(iw.MergeInto)?.beam.equals(this)&&(console.debug(this.toString(),"re-evaluating merge with",e.toString()),this.done=!1,this.#m=Math.max(n-1,0))}onCollision(t,e,i,n,r,s,a,o,h){if(console.debug(this.toString(),"evaluating collision with",t.toString()),t===this&&i.item===this&&this.#m<this.lastStepIndex()){console.debug(this.toString(),"ignoring collision with self while re-evaluating history");return}if(!t.isPending()){console.debug(this.toString(),"ignoring collision with inactive beam",t.toString());return}if(t.parent.equals(this.parent)&&a.direction===t.startDirection()){console.debug(this.toString(),"ignoring collision with sibling beam",t.toString());return}let l=i.points[0],u=this.#_.findLastIndex(t=>ia(l,t.point));if(u<0)throw Error(`Could not find matching step for beam collision between ${this.toString()} and ${t.toString()}`);let c=this.#_[u];if(c.state.get(iw.MergeInto)?.beam.equals(t)){console.debug(this.toString(),"ignoring collision with merged beam",t.toString());return}let d=c.state.get(iw.TerminusConnection);if(d&&d.terminus.equals(t.parent)){console.debug(this.toString(),"ignoring collision with connected beam in parent terminus",t.toString());return}let f=c.state.get(iw.Reflector)??s.state.get(iw.Reflector);if(f){let e=iA.getNextPoint(c.point,1,il(c.direction)),i=iA.getNextPoint(s.point,1,il(s.direction));if(!f.item.isSameSide(e,i)){console.debug(this.toString(),"ignoring collision with beam on opposite side of reflector",t.toString());return}}if(c.direction!==a.direction){let e=t.equals(this);return console.debug(t.toString(),"has collided with",e?"self":this.toString(),"stopping"),e||(this.#y(u),this.addStep(c.copy({done:!0,state:c.state.copy(new iw.Collision(l,t))}))),h.copy({insertAbove:c.insertAbove})}console.debug(this.toString(),"merging with",t.toString()),this.#y(u);let p=[t].concat(c.state.get(iw.MergeWith)?.beams||[]);return this.addStep(c.copy({colors:c.colors.concat([t.getColor()]),state:c.state.copy(new iw.MergeWith(p))})),console.debug(t.toString(),"merging into",this.toString()),a.copy({done:!0,point:s.point,state:a.state.copy(new iw.MergeInto(this))})}onModifierInvoked(t){if(console.debug(this.toString(),"onModifierInvoked",t),!this.isOn()){this.#_.length&&(this.updateState(t=>{delete t.collisions}),this.remove());return}let e=t.detail.tiles||[t.detail.tile],i=this.#_.findIndex(t=>e.some(e=>e.equals(t.tile)));i>=0&&(this.done=!1,this.#m=Math.max(i-1,0))}remove(t=0){this.#y(t)}selected(t=!0){this.path.forEach(e=>{e.selected=t})}startDirection(){return(this.getOpening().direction+this.parent.rotation)%6}step(t){let e;if(!this.isPending())return;if(console.debug(this.toString(),"stepIndex = ",this.#m),0===this.#_.length){let t=this.parent.parent;this.addStep(new ix(t,this.getColor(),this.startDirection(),t.center))}let i=this.#_[this.#m],n=0===this.#m?this.startDirection():i.direction,r=iA.getNextPoint(i.point,i.tile.parameters.inradius,n),s=t.getTile(ih(i.point,r));if(!s){console.debug(this.toString(),"stopping due to out of bounds"),this.#_[this.#m]=i.copy({done:!0,state:new iw(new iw.Collision(i.point))}),this.#v();return}let a=this.#m+1,o=this.#_[a],h=this.path.length-1,l=this.path[h].segments.length-1,u=new ix(s,i.color,n,r,o?.pathIndex||h,o?.segmentIndex||l),c=s.items.concat(i.tile.equals(u.tile)?[]:i.tile.items);console.debug(this.toString(),"collision items:",c);let d=this.#b(c,[i.point,u.point],t);console.debug(this.toString(),"collisions:",d);for(let n=0;n<d.length;n++){let r=d[n],s=r.points[0];if(console.debug(this.toString(),"resolving collision:",r),e=u.copy({done:!0,point:s,state:u.state.copy(new iw.Collision(s,r.item))}),(e=r.item.onCollision(this,t,r,n,d,i,u,o,e))instanceof ix)break}if(e){if(e instanceof ix.Stop){this.done=!0,this.#v();return}u=e}if(o){if(u.equals(o)){this.#m++;let t=this.lastStepIndex();console.debug(this.toString(),"new step is same as existing. new step index:",this.#m,"last step index:",t),this.#m===t&&this.#v();return}console.debug(this.toString(),"is revising history."),console.debug(this.toString(),"existing next step:",o),this.#y(a),u.pathIndex=this.path.length-1,u.segmentIndex=this.path[u.pathIndex].segments.length-1,console.debug(this.toString(),"new next step:",u)}if(i.point.equals(u.point)){console.debug(this.toString(),"next step point is same as current step point, stopping.",u),this.#_[this.#m]=u,this.#v();return}return this.addStep(u),u}toString(){return`[${this.type}:${this.id}:${a(e2)(this.getColor()).name()}]`}updateState(t,e=!0){return this.parent.updateState(e=>t(e.openings[this.#p]),e)}#b(t,e,i){let n=new d.Path({segments:e}),r=e[0];return t.map(t=>{let s=[],a=n.getIntersections(t.getCompoundPath(),e=>!(t===this&&e.point.equals(r)));return s.push(...new Set(a.map(t=>t.point))),s.length||t.type!==id.Types.beam||t===this||s.push(...t.getSteps().map(t=>t.point).filter(t=>e.some(e=>ia(t,e)))),s.sort(io(r)),i.debug&&(i.drawDebugPoint(r),s.forEach(t=>i.drawDebugPoint(t,{fillColor:"black"}))),{item:t,points:s}}).filter(t=>t.points.length).sort((t,e)=>{let i=io(r)(t.points[0],e.points[0]);return 0===i?t.item.sortOrder-e.item.sortOrder:i})}#v(t,e){let i=this.getStep();this.done||(this.done=i?.done??!1),is(iA.Events.Update,{beam:this,state:i?.state,stepAdded:t,stepsDeleted:e})}#y(t){let e=this.lastStepIndex(),i=this.#_[e],n=this.#_[t];if(console.debug(this.toString(),"updateHistory","stepIndex:",t,"lastStepIndex:",e,"step:",n),n){let e=this.path[n.pathIndex];e.removeSegments(n.segmentIndex);let r=n.pathIndex+(0===e.segments.length?0:1);this.path.splice(r).forEach(t=>t.remove());let s=this.#_.splice(t);console.debug(this.toString(),"removed steps: ",s),[...new Set(s.map(t=>t.tile))].forEach(t=>t.removeItem(this)),"function"==typeof i.onRemove&&i.onRemove(),this.done=!1,this.#m=t-1,this.#v(void 0,s)}return n}static getNextPoint(t,e,i){let n=new d.Point(0,0);return n.length=e,n.angle=60*iu(i),t.add(n)}static Events=Object.freeze({Collision:"beam-collision",Connection:"beam-connection",Merge:"beam-merge",Update:"beam-update"})}class iP extends ib(iS(iT(id))){sortOrder=2;#x;constructor(t,e){super(...arguments);let i=e.openings.filter(t=>t?.color).flatMap(t=>Array.isArray(t.color)?t.color:[t.color]),n=a(e2).average(i.length?i:Array.isArray(e.color)?e.color:[e.color]).hex(),r=e.openings.map((t,e)=>t?new iP.#w(t.color||n,e,t.connected,t.on):t).filter(t=>t);this.#x=iP.ui(t,n,r),this.group.addChildren([...this.#x.openings,this.#x.terminus]),this.color=n,this.openings=r,this.radius=this.#x.radius,this.beams=r.map(t=>new iA(this,e.openings[t.direction],t)),this.update()}getColorElements(){return e8(this.openings.map(t=>t.color))}getOpening(t){return this.openings.find(e=>e.direction===t)}onMove(){this.beams.forEach(t=>t.remove())}onCollision(t,e,i,n,r,s,a,o,h){if(console.debug(this.toString(),"collision",t.toString()),t.parent===this&&t.startDirection()===a.direction){console.debug(t.toString(),"ignoring starting terminus collision");return}let l=il(s.direction),u=this.openings.find(t=>this.getDirection(t.direction)===l);return u&&u.color===a.color&&(!u.on||u.connected&&o?.state.get(iw.TerminusConnection)?.terminus.equals(this))?(console.debug(t.toString(),"terminus connection",this.toString(),u),a.copy({done:!0,onAdd:()=>{this.onConnection(u.direction)},onRemove:()=>{this.onDisconnection(u.direction)},state:a.state.copy(new iw.TerminusConnection(this,u))})):h}onConnection(t){let e=this.getOpening(t);e.connect(),this.update(),is(iP.Events.Connection,{terminus:this,opening:e})}onDisconnection(t){let e=this.getOpening(t);e.disconnect(),this.update(),is(iP.Events.Disconnection,{terminus:this,opening:e})}onToggle(){this.updateState(t=>{this.openings.filter(t=>!t.connected).forEach(e=>{e.toggle(),t.openings[e.direction].on=e.on})}),this.update()}update(){this.beams.forEach(t=>{let e=t.getOpening();this.#x.openings.find(t=>t.data.direction===e.direction).opacity=e.on?1:iP.#k})}static #k=.3;static ui(t,e,i){let n=t.parameters.circumradius/2,r=new d.Path.RegularPolygon({center:t.center,fillColor:e,opacity:1,sides:6,radius:n/2});return{openings:i.map(t=>{let e=t.direction,i=r.segments[(e+-1+6)%6].point,n=r.segments[(e+2+6)%6].point,s=n.subtract(i);s.angle+=120;let a=i.subtract(s);return new d.Path({closed:!0,data:{collidable:!1,direction:e},fillColor:t.color,opacity:t.on?1:iP.#k,segments:[i,n,a]})}),radius:n,terminus:r}}static #w=class{constructor(t,e,i,n){this.color=Array.isArray(t)?a(e2).average(t).hex():a(e2)(t).hex(),this.direction=e,this.connected=!0===i,this.on=!0===n}connect(){this.connected=this.on=!0}disconnect(){this.connected=this.on=!1}toggle(){this.on=!this.on}};static Events=Object.freeze({Connection:"terminus-connection",Disconnection:"terminus-disconnection"})}var d=u("hFpCu");class iM extends ib(iS(id)){#C;constructor(t,e){super(t,e,{rotationDegrees:30}),this.color=e.color||"black",this.#C=iM.item(t,this.color),this.group.addChild(this.#C)}midLine(){return[ih(this.#C.segments[3].point,this.#C.segments[0].point),ih(this.#C.segments[1].point,this.#C.segments[2].point)]}getSide(t){return function(t,e){let[i,n]=t;return Math.sign((n.x-i.x)*(e.y-i.y)-(n.y-i.y)*(e.x-i.x))}(this.midLine(),t)}isSameSide(t,e){return this.getSide(t)===this.getSide(e)}onCollision(t,e,i,n,r,s,a,o,h){let l=il(s.direction),u=function(t,e){let i=60*iu(t,!0);return iu(function(t,e){let i=t+e;return i<0?360+i:i>360?i-360:i}(i,(30*e-i)*2)/60%6,!1)}(l,this.rotation);if(u===s.direction)return console.debug(t.toString(),"stopping due to collision with non-reflective side of reflector"),h;if(u===l)return console.debug(t.toString(),"stopping due to reflection back at self"),a.copy({done:!0,state:a.state.copy(new iw.Collision(a.point,this))});if(!s.state.has(iw.Reflector))return a.copy({state:a.state.copy(new iw.Reflector(this))});let c=iA.getNextPoint(s.point,a.tile.parameters.inradius,u);return a.copy({direction:u,point:c})}static item(t,e){let i=t.parameters.circumradius,n=t.parameters.circumradius/12,r=t.center.subtract(new d.Point(n/2,i/2)),s=new d.Size(n,i);return new d.Path.Rectangle({data:{size:s},fillColor:e,point:r,size:s})}}var d=u("hFpCu");class iO extends ib(iS(id)){sortOrder=1;constructor(t,e){super(t,e,{rotationDegrees:60});let i=iO.item(t,e);this.group.addChildren(i)}static item(t,e){let i=t.parameters.circumradius/12,n=t.styles.default.strokeColor;return e.directions.map(e=>{let r=t.hexagon.segments[e].point,s=(e+1+6)%6,a=t.hexagon.segments[s].point;return new d.Path({closed:!0,fillColor:n,segments:[r,t.hexagon.getLocationAt((0===e?t.hexagon.length:t.hexagon.getOffsetOf(r))-i),t.hexagon.getLocationAt((0===s?0:t.hexagon.getOffsetOf(a))+i),a]})})}}class iL extends iv{immutable=!0;name="block";title="Immutable"}class iN extends iv{immutable=!0;name="lock";title="Locked"}class iR extends iy{name="swap_horiz";title="Swap";moveItems(t){let e=t.items.filter(iy.movable),i=this.tile.items.filter(iy.movable);return i.forEach(e=>e.move(t)),e.forEach(t=>t.move(this.tile)),{moved:[iy.data(this.tile,t,i),iy.data(t,this.tile,e)],tiles:[this.tile,t]}}tileFilter(t){return t.modifiers.some(iv.immutable)||!t.items.filter(t=>t.type!==id.Types.beam).length}}class iz extends id{selected=!1;#x;constructor(t,e,i,n){super(null,n,{locked:!1}),this.#x=iz.ui(e,i,n,{coordinates:t,type:this.type}),this.center=this.#x.center,this.coordinates=t,this.hexagon=this.#x.hexagon,this.parameters=i,this.styles=this.#x.styles,this.group.addChild(this.#x.hexagon),this.items=(n.items||[]).map(t=>(function(t,e){let i;switch(e.type){case id.Types.filter:i=new ik(t,e);break;case id.Types.portal:i=new iI(t,e);break;case id.Types.terminus:i=new iP(t,e);break;case id.Types.reflector:i=new iM(t,e);break;case id.Types.wall:i=new iO(t,e);break;default:console.error("Ignoring item with unknown type:",e.type)}return i&&i.onInitialization(),i})(this,t)).filter(t=>void 0!==t),this.modifiers=(n.modifiers||[]).map(t=>(function(t,e){let i;switch(e.type){case iv.Types.immutable:i=new iL(t,e);break;case iv.Types.lock:i=new iN(t,e);break;case iv.Types.move:i=new iy(t,e);break;case iv.Types.rotate:i=new iC(t,e);break;case iv.Types.swap:i=new iR(t,e);break;case iv.Types.toggle:i=new iE(t,e);break;default:console.error("Ignoring modifier with unknown type:",e.type)}return i})(this,t)).filter(t=>void 0!==t)}addItem(t){this.items.unshift(t)}addModifier(t){this.modifiers.unshift(t)}afterModify(){this.setStyle(this.selected?"selected":"default")}beforeModify(){this.group.bringToFront(),this.setStyle("edit")}getState(){let t={type:this.type},e=this.items.filter(t=>t.type!==id.Types.beam).map(t=>t.getState());e.length&&(t.items=e);let i=this.modifiers.map(t=>t.getState());return i.length&&(t.modifiers=i),t}onClick(t){console.debug(this.coordinates.offset.toString(),this),this.items.forEach(e=>e.onClick(t))}onDeselected(t){this.selected=!1,this.#x.hexagon.style=this.styles.default,this.items.forEach(t=>t.onDeselected()),this.modifiers.forEach(t=>t.detach()),is(iz.Events.Deselected,{selectedTile:t,deselectedTile:this})}onSelected(t){this.selected=!0,this.group.bringToFront(),this.#x.hexagon.style=this.styles.selected,this.items.forEach(t=>t.onSelected()),this.modifiers.forEach(t=>t.attach())}removeItem(t){let e=this.items.indexOf(t);e>=0&&this.items.splice(e,1)}removeModifier(t){let e=this.modifiers.indexOf(t);e>=0&&this.modifiers.splice(e,1)}setStyle(t){this.hexagon.set(this.styles[t])}teardown(){this.modifiers.forEach(t=>t.detach())}toString(){return this.coordinates.offset.toString()}static parameters(t){let e=t/2,i=Math.sqrt(3)*e;return{circumradius:e,height:t,inradius:i/2,offsetY:3/4*t,width:i}}static ui(t,e,i,n){let r=new d.Point(t.startingOffsetX+e.inradius+t.column*e.width,t.startingOffsetY+e.circumradius+t.row*e.offsetY),s=e.circumradius/10,a=Object.assign({},iz.Styles,{edit:Object.assign({dashArray:[s,s]},iz.Styles.edit)},i.style||{}),o=new d.Path.RegularPolygon({center:r,closed:!0,data:n,radius:e.circumradius,sides:6,style:a.default});return{center:r,hexagon:o,styles:a}}static Events=Object.freeze({Deselected:"tile-deselected",Selected:"tile-selected"});static Styles=Object.freeze({default:{dashArray:[],fillColor:new d.Color("white"),strokeColor:new d.Color("#666"),strokeWidth:1},edit:{strokeColor:new d.Color("black"),strokeWidth:2},selected:{dashArray:[],strokeColor:new d.Color("black"),strokeWidth:2}})}class iD extends ic{#S=[];#I=[];items=[];layers={};tiles=[];tileSize=120;constructor(t){super(t),this.type=t.type||iD.Types.oddR;let e=a(d).view.center,i=iz.parameters(this.tileSize),n=t.tiles,r=n.length*i.width,s=e.y-r/2;this.layers.tiles=new d.Layer,this.layers.items=new d.Layer;let o=n.reduce((t,e,i)=>{let n=e.length;return n>t.length||n===t.length&&this.#E(i)?{index:i,length:n}:t},{index:0,length:0}),h=o.length*i.width+(this.#E(o.index)?i.inradius:0),l=e.x-h/2;for(let t=0;t<n.length;t++){let e=n[t],r=Array(e.length).fill(null),a=Array(e.length).fill(null),o=Math.floor(t/2);for(let n=0;n<e.length;n++){let h=new p(n-o,t),u=new f(t,n),c={row:t,column:n,startingOffsetX:l+(this.#E(t)?i.inradius:0),startingOffsetY:s},d=e[n];if(!d)continue;let g=new iz({axial:h,offset:u},c,i,d);this.layers.tiles.addChild(g.group),g.items.length&&(this.items.push(...g.items),this.layers.items.addChildren(g.items.map(t=>t.group))),this.tiles.push(g),r[h.q]=g,a[u.c]=g}this.#S.push(r),this.#I.push(a)}}getTileByAxial(t){return(this.#S[t.r]||[])[t.q]}getTileByOffset(t){return this.#I[t.r][t.c]}getState(){return{tiles:this.#I.map(t=>t.map(t=>t?.getState()||null)),type:this.type}}getNeighboringTile(t,e){return this.getTileByAxial(p.neighbor(t,iu(e)))}teardown(){Object.values(this.layers).forEach(t=>t.removeChildren())}#E(t){return t%2==0?this.type===iD.Types.evenR:this.type===iD.Types.oddR}static Types=Object.freeze({evenR:"even-r",oddR:"odd-r"})}var d=(u("hFpCu"),u("hFpCu"));class iB extends id{constructor(t,e){super(null,e,{locked:!1,type:id.Types.mask});let i={type:this.type},n=new d.Path.RegularPolygon({center:t.center,closed:!0,data:i,opacity:.25,radius:t.parameters.circumradius+1,sides:6,style:Object.assign({fillColor:"black"},e)});this.center=t.center,this.group.addChild(n)}}var d=u("hFpCu");class ij extends id{constructor(t){super(null,t,{type:id.Types.collision});let{center:e,color:i}=t;this.center=e,this.color=i;let n=new d.Path.Circle({center:e,closed:!0,radius:4,style:{fillColor:"white",strokeColor:i,strokeWidth:2}});this.group.addChild(n)}}const iV=Object.fromEntries(Object.entries({"001":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,null,{on:!0,type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{type:"Tile"}],[{type:"Tile"},{type:"Tile"},{type:"Tile"}],[{items:[{color:"red",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Toggle"}],type:"Tile"},{items:[{color:"blue",openings:[{type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},"002":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,null,{on:!0,type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{type:"Tile"}],[{type:"Tile"},{type:"Tile"},{type:"Tile"}],[{items:[{color:"red",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{clockwise:!1,type:"Rotate"}],type:"Tile"},{items:[{color:"blue",openings:[{type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},"003":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,null,{on:!0,type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Immutable"}],type:"Tile"},{type:"Tile"}],[{type:"Tile"},{type:"Tile"},{type:"Tile"}],[{items:[{color:"red",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{color:"blue",openings:[{type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{clockwise:!1,type:"Rotate"}],type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},"004":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,null,null,{type:"Beam"},null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Rotate"}],type:"Tile"},{items:[{color:"blue",openings:[null,null,null,null,{on:!0,type:"Beam"},null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"}],[{type:"Tile"},{type:"Tile"},{type:"Tile"}],[{items:[{color:"red",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Swap"}],type:"Tile"},{type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},"005":{layout:{tiles:[[{type:"Tile"},{items:[{color:"blue",openings:[null,null,null,null,null,{on:!0,type:"Beam"}],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"}],[{items:[{color:"blue",openings:[null,{type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{type:"Tile"},{items:[{color:"red",openings:[null,null,null,null,{type:"Beam"},null],type:"Terminus"}],modifiers:[{type:"Immutable"}],type:"Tile"}],[{items:[{color:"red",openings:[null,null,{on:!0,type:"Beam"},null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Swap"},{clockwise:!1,type:"Rotate"}],type:"Tile"},{type:"Tile"}]],type:"even-r"},solution:[{amount:2,type:"Connections"}]},"006":{layout:{tiles:[[{items:[{rotation:2,type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Swap"}],type:"Tile"},{items:[{type:"Reflector"}],modifiers:[{type:"Lock"}],type:"Tile"}],[{items:[{openings:[null,null,null,{color:"red",type:"Beam"},null,{color:"blue",on:!0,type:"Beam"}],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{type:"Tile"},{items:[{openings:[{color:"blue",type:"Beam"},null,{color:"red",on:!0,type:"Beam"},null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"}],[{items:[{type:"Reflector"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{rotation:2,type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Swap"}],type:"Tile"}]],type:"even-r"},solution:[{amount:2,type:"Connections"}]},"007":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,{on:!0,type:"Beam"},{type:"Beam"},null,null],type:"Terminus"}],type:"Tile"},{type:"Tile"},{type:"Tile"},{items:[{color:"blue",openings:[null,null,null,null,{on:!0,type:"Beam"},{type:"Beam"}],type:"Terminus"}],type:"Tile"},{items:[{rotation:3,type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Move"},{type:"Rotate"}],type:"Tile"},{items:[{color:"red",openings:[null,null,{on:!0,type:"Beam"},{type:"Beam"},null,null],type:"Terminus"}],type:"Tile"},{type:"Tile"},{type:"Tile"},{items:[{color:"red",openings:[null,null,null,null,{on:!0,type:"Beam"},{type:"Beam"}],type:"Terminus"}],type:"Tile"}],[{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"}],[null,{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"},{type:"Tile"}],[null,{items:[{color:"blue",openings:[{on:!0,type:"Beam"},{type:"Beam"},null,null,null,null],type:"Terminus"}],type:"Tile"},{items:[{rotation:3,type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"},{type:"Tile"},{type:"Tile"},{items:[{rotation:3,type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"},{items:[{color:"red",openings:[{on:!0,type:"Beam"},{type:"Beam"},null,null,null,null],type:"Terminus"}],type:"Tile"}]]},solution:[{amount:0,type:"Connections"},{amount:4,type:"Moves"}]},"008":{layout:{tiles:[[{items:[{color:"blue",openings:[null,null,null,{type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Swap"}],type:"Tile"},{modifiers:[{type:"Lock"},{type:"Rotate"}],type:"Tile"},{modifiers:[{type:"Lock"},{type:"Toggle"}],type:"Tile"},{items:[{color:["red","blue"],openings:[null,null,null,null,{type:"Beam"},null],type:"Terminus"}],modifiers:[{type:"Immutable"}],type:"Tile"}],[{items:[{type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"},{items:[{color:"blue",type:"Filter"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"},{items:[{color:"red",type:"Filter"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"},{items:[{type:"Reflector"}],modifiers:[{type:"Lock"},{type:"Move"}],type:"Tile"}],[null,{items:[{color:["red","blue"],openings:[null,{type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Immutable"}],type:"Tile"},{modifiers:[{type:"Lock"},{type:"Toggle"}],type:"Tile"},{modifiers:[{type:"Lock"},{type:"Rotate"}],type:"Tile"},{items:[{color:"red",openings:[{type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Swap"}],type:"Tile"}]]},solution:[{amount:2,type:"Connections"}]},"009":{layout:{tiles:[[{type:"Tile"},{type:"Tile"},null,null,{type:"Tile"},{type:"Tile"}],[{items:[{color:"green",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{type:"Portal"}],modifiers:[{type:"Move"}],type:"Tile"},{type:"Tile"},null,{items:[{color:"green",openings:[null,null,null,{type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{type:"Portal"}],type:"Tile"},{items:[{type:"Reflector"}],modifiers:[{type:"Lock"}],type:"Tile"}],[{type:"Tile"},{type:"Tile"},null,null,{modifiers:[{type:"Immutable"}],type:"Tile"},{type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},"010":{layout:{tiles:[[{modifiers:[{type:"Immutable"}],type:"Tile"},{type:"Tile"},null,null,{type:"Tile"},{type:"Tile"}],[{items:[{color:"green",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{type:"Portal"}],modifiers:[{type:"Move"}],type:"Tile"},{type:"Tile"},null,{items:[{color:"green",openings:[null,null,null,{type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Lock"}],type:"Tile"},{items:[{type:"Portal"}],type:"Tile"},{items:[{type:"Reflector"}],modifiers:[{type:"Lock"}],type:"Tile"}],[{type:"Tile"},{type:"Tile"},null,null,{type:"Tile"},{type:"Tile"}]],type:"even-r"},solution:[{amount:1,type:"Connections"}]},test_layout:{layout:{tiles:[["x","x","o","o","x","x"],["x","x","x","o","x","x","x"],["x","x","o","o","x","x"]].map(t=>t.map(t=>"x"===t?{type:"Tile"}:null)),type:"even-r"},solution:[{amount:100,type:"Connections"}]},test_portal:{layout:{tiles:[[{items:[{direction:0,type:"Portal"}],modifiers:[{type:"Immutable"}],type:"Tile"},{items:[{direction:0,type:"Portal"}],modifiers:[{type:"Immutable"}],type:"Tile"},{items:[{openings:[null,null,null,{color:["red","blue"],type:"Beam"},null,null],type:"Terminus"}],modifiers:[{type:"Rotate"}],type:"Tile"},{items:[{openings:[null,null,null,null,{color:"green",type:"Beam"},null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Toggle"}],type:"Tile"}],[{items:[{openings:[{color:"red",type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Rotate"},{type:"Toggle"}],type:"Tile"},{items:[{openings:[{color:"blue",type:"Beam"},null,null,null,null,null],type:"Terminus"}],modifiers:[{type:"Lock"},{type:"Toggle"}],type:"Tile"},{items:[{direction:3,type:"Portal"}],modifiers:[{type:"Immutable"}],type:"Tile"}]]},solution:[{amount:1,type:"Connections"}]},test_reflector:{layout:{tiles:[[{items:[{color:"red",openings:[null,null,null,{on:!0,type:"Beam"},null,null],type:"Terminus"}],type:"Tile"}],[{items:[{type:"Reflector"}],modifiers:[{type:"Rotate"}],type:"Tile"}],[{items:[{color:"green",openings:[null,{on:!0,type:"Beam"},null,null,null,null],type:"Terminus"}],type:"Tile"},{items:[{color:"blue",openings:[{on:!0,type:"Beam"},null,null,null,null,null],type:"Terminus"}],type:"Tile"}]]},solution:[{amount:999,type:"Connections"}]}}).map(([t,e])=>[t,JSON.parse(JSON.stringify(e))]));function iF(t,e,i){let n=t.indexOf(e);return t[n<0?n:n+i]}class iU{ids;constructor(t){this.firstId=t[0],this.ids=t,this.lastId=t[t.length-1]}get(t){if(this.has(t))return structuredClone(iV[t])}has(t){return this.ids.includes(t)}nextId(t){return iF(this.ids,t,1)}previousId(t){return iF(this.ids,t,-1)}}const iq=new iU(Object.keys(iV).sort());iq.hidden=new iU(iq.ids.filter(t=>t.startsWith("test_"))),iq.titles=Object.fromEntries(iq.ids.map(t=>[t,iV[t].title||t])),iq.visible=new iU(iq.ids.filter(t=>!iq.hidden.has(t)));const i$=window.history,iZ=window.location,iH=window.localStorage,iG=new URLSearchParams(iZ.search),iW=new URL(iZ);class iK{#T;#A;#P;#M;#O;#L;constructor(t,e,i,n,r){this.#P=t,this.#O=e,this.#A=i||[],this.#M=n||this.#N(),this.#L=r,this.#T=structuredClone(e),this.#A.filter((t,e)=>e<=this.#M).forEach(t=>this.apply(t)),this.#R(t)}apply(t){return console.debug("StateManager: applying delta",t),e5.patch(this.#T,t)}canRedo(){return this.#M<this.#N()}canUndo(){return this.#M>=0}encode(){return ii(JSON.stringify({id:this.#P,original:iq.has(this.#P)?void 0:this.#O,deltas:this.#A,deltasIndex:this.#M,selectedTile:this.#L}))}getCurrent(){return structuredClone(this.#T)}getId(){return this.#P}getTitle(){return this.getId()+(this.#T.title?` - ${this.#T.title}`:"")}getSelectedTile(){return this.#L}moves(){return this.#M+1}length(){return this.#A.length}redo(){let t=this.#M+1;t<=this.#N()&&(this.#T=structuredClone(this.#O),this.#A.filter((e,i)=>i<=t).forEach(t=>this.apply(t)),this.#M=t,this.#R())}reset(){this.#T=structuredClone(this.#O),this.#A=[],this.#M=this.#N(),iK.clearCache(this.getId()),this.#R()}setSelectedTile(t){let e=t?.coordinates.offset.toString();this.#L!==e&&(this.#L=e,this.#R())}undo(){let t=this.#M-1;t>=-1&&(this.#T=structuredClone(this.#O),this.#A.filter((e,i)=>i<=t).forEach(t=>this.apply(t)),this.#M=t,this.#R())}update(t){let e=e5.diff(this.#T,t);console.debug("State.update",e),void 0!==e&&(this.#M<this.#N()&&this.#A.splice(this.#M+1),this.apply(e),this.#A.push(e),this.#M=this.#N(),this.#R())}#z(t){return iK.key(t,this.getId())}#N(){return this.#A.length-1}#R(){let t=this.getId(),e=this.encode();iW.hash=["",t,e].join("/"),i$.pushState({id:t,state:e},"",iW),iH.setItem(iK.CacheKeys.id,t),iH.setItem(this.#z(iK.CacheKeys.state),e)}static clearCache(t){t?(iW.hash=`/${t}`,i$.pushState({id:t},"",iW),iH.removeItem(iK.key(iK.CacheKeys.state,t))):(iW.hash="",i$.pushState({},"",iW),t=iH.getItem(iK.CacheKeys.id),iH.clear(),iH.setItem(iK.CacheKeys.id,t))}static fromEncoded(t){return(t=JSON.parse(ie(t))).original=t.original||iq.get(t.id),new iK(t.id,t.original,t.deltas,t.deltasIndex,t.selectedTile)}static fromId(t){return new iK(t,iq.get(t))}static resolve(t){let e;iG.has(iK.ParamKeys.clearCache)&&iK.clearCache(iG.get(iK.ParamKeys.clearCache));let i=iW.hash.substring(1).split("/").filter(t=>""!==t);if(t||i.filter(t=>!iq.has(t)).some((i,n)=>{try{t=(e=iK.fromEncoded(i)).getId()}catch(t){console.debug(`Could not parse state from path segment '${n}'`,t)}return void 0!==e}),!e){t=t||i[0]||iH.getItem(iK.CacheKeys.id)||iq.visible.firstId;let n=iH.getItem(iK.key(iK.CacheKeys.state,t));if(n)try{e=iK.fromEncoded(n)}catch(e){console.debug(`Could not parse state with ID '${t}' from localStorage`,e)}}if(e||(e=iK.fromId(t)),!e)throw Error(`Unable to resolve state for ID '${t}'`);return e}static key(t,e){return`${t}:${e}`}static CacheKeys=Object.freeze({center:"center",id:"id",state:"state",zoom:"zoom"});static ParamKeys=Object.freeze({clearCache:"clearCache"})}class iY{#D=[];constructor(t){t.forEach(t=>this.#B(t))}teardown(){this.#D.forEach(t=>t.teardown()),iY.element.replaceChildren()}isSolved(){return this.#D.every(t=>t.isMet())}#B(t){switch(t.type){case iQ.Types.connections:this.#D.push(new iX(t));break;case iQ.Types.moves:this.#D.push(new iJ(t));break;default:console.warn("Ignoring condition with unknown type:",t.type)}}static element=document.getElementById("solution")}class iQ{constructor(t,e){this.state=t;let i=document.createElement("li");i.append(...e),iY.element.append(i)}isMet(){}teardown(){}update(){}static Types=Object.freeze(Object.fromEntries(["connections","moves"].map(t=>[t,e6(t)])))}class iX extends iQ{#j;#r;#V=[];constructor(t){let e=document.createElement("span");e.textContent="0";let i=document.createElement("span");i.textContent=t.amount.toString(),super(t,[e,it("/"),i,e7("link","Connections")]),this.#j=e,this.#r=new ip(this,{[iP.Events.Connection]:this.update,[iP.Events.Disconnection]:this.update}),this.#r.addEventListeners()}isMet(){return this.#V.length===this.state.amount}teardown(){this.#r.removeEventListeners(),super.teardown()}update(t){console.debug("Connections.update",t);let e=t.detail.terminus,i=t.detail.opening,n=`${e.id}:${i.direction}`,r=this.#V.findIndex(t=>t===n);i.connected&&r<0?this.#V.push(n):!i.connected&&r>=0&&this.#V.splice(r,1),this.#j.textContent=this.#V.length.toString()}}class iJ extends iQ{#j;#r;#F=0;constructor(t){if(t.operator??=iJ.Operators.equalTo,!Object.values(iJ.Operators).includes(t.operator))throw Error(`Invalid moves operator: ${t.operator}`);let e=document.createElement("span");e.textContent="0";let i=document.createElement("span");i.textContent=t.amount.toString(),super(t,[e,it(t.operator),i,e7("stacks","Moves")]),this.#j=e,this.#r=new ip(this,{[i1.Events.Updated]:this.update}),this.#r.addEventListeners()}isMet(){switch(this.state.operator){case iJ.Operators.equalTo:return this.#F===this.state.amount;case iJ.Operators.greaterThan:return this.#F>this.state.amount;case iJ.Operators.lessThan:return this.#F<this.state.amount}}teardown(){this.#r.removeEventListeners(),super.teardown()}update(t){console.debug("Moves.update",t),this.#F=t.detail.state.moves(),this.#j.textContent=this.#F.toString()}static Operators=Object.freeze({equalTo:"=",greaterThan:">",lessThan:"<"})}const i0=Object.freeze({beams:document.getElementById("beams"),connections:document.getElementById("connections"),connectionsCompleted:document.getElementById("connections-completed"),connectionsRequired:document.getElementById("connections-required"),message:document.getElementById("message")});class i1{connections=[];debug=!1;layers={};message;selectedTile;solved=!1;#U;#q={};#r;#$=!1;#Z=!1;#s;#H;#t;#G;#W=[];#K;#Y=[];constructor(t){a(d).settings.insertItems=!1,a(d).setup(t),this.layers.mask=new d.Layer,this.layers.collisions=new d.Layer,this.layers.debug=new d.Layer,this.#r=new ip(this,{keyup:this.#Q,[iA.Events.Update]:this.#X,[iv.Events.Invoked]:this.#J,[i1.Events.Mask]:this.#tt,[ic.Events.Update]:this.#te}),this.#K=new d.Tool,this.#K.onMouseDrag=t=>this.#ti(t),this.#K.onMouseUp=t=>this.#tn(t)}drawDebugPoint(t,e={}){let i=new d.Path.Circle(Object.assign({radius:3,fillColor:"red",strokeColor:"white",strokeWidth:1,center:t},e));this.layers.debug.addChild(i)}getItems(t){return(t?this.#W.filter(e=>e===t):this.#W).flatMap(t=>t.items)}getTile(t){let e=a(d).project.hitTest(t.ceil(),{fill:!0,match:t=>t.item.data.type===id.Types.tile,segments:!0,stroke:!0,tolerance:0});return e?this.layout.getTileByAxial(e.item.data.coordinates.axial):e}mask(t){if(this.#s){console.error("Ignoring mask request due to existing mask",t,this.#s);return}this.#s=t;let e=this.#W.filter(t.filter).map(e=>new iB(e,"function"==typeof t.configuration.style?t.configuration.style(e):t.configuration.style));this.layers.mask.addChildren(e.map(t=>t.group)),t.configuration.message&&(i0.message.textContent=t.configuration.message)}next(){let t=iq.visible.nextId(this.#t.getId());t&&this.select(t)}previous(){let t=iq.visible.previousId(this.#t.getId());t&&this.select(t)}redo(){this.#t.redo(),this.#tr()}reset(){this.#t.reset(),this.#tr()}select(t){document.body.classList.remove(i1.Events.Error);try{this.#t=iK.resolve(t)}catch(t){this.#ts(t,"Could not load puzzle.")}is(i1.Events.Updated,{state:this.#t}),this.#tr()}undo(){this.#t.undo(),this.#tr()}unmask(){"function"==typeof this.#s.onUnmask&&this.#s.onUnmask(this),this.#s=void 0,this.layers.mask.removeChildren(),this.#ta(this.selectedTile)}update(){this.#s||this.#Z||(this.#Z=!0,this.#to())}updateSelectedTile(t){let e=this.selectedTile;return this.selectedTile=t,this.#t.setSelectedTile(t),this.#ta(t),e&&e!==t&&e.onDeselected(t),t&&t!==e&&t.onSelected(e),e}updateState(){this.#t.update(Object.assign(this.#t.getCurrent(),{layout:this.layout.getState()})),is(i1.Events.Updated,{state:this.#t})}#th(){[this.layout.layers.tiles,this.layout.layers.items,this.layers.mask,this.layers.collisions,this.layers.debug].forEach(t=>a(d).project.addLayer(t))}#X(t){let e=t.detail.beam,i=t.detail.state;if(i?.has(iw.Collision)){let t=i.get(iw.Collision),n=i1.Collision.id(t.point),r=this.#q[n];r?r.addBeam(e):this.#q[n]=new i1.Collision(this.layers.collisions,[e],t.point);let s=this.#s?.configuration;s?.beam?.equals(e)&&this.unmask()}Object.values(this.#q).forEach(t=>t.update()),this.#U.filter(t=>t!==e).forEach(e=>e.onBeamUpdated(t,this)),setTimeout(()=>this.update(),0)}#h(t){let e;if(this.#$||this.solved)return;let i=a(d).project.hitTest(t.point);switch(i?.item.data.type){case id.Types.mask:return;case id.Types.tile:e=this.layout.getTileByAxial(i.item.data.coordinates.axial)}if(this.#s)this.#s.onClick(this,e);else{let i=this.updateSelectedTile(e);e&&e===i&&e.onClick(t)}}#ts(t,e,i){"string"==typeof t&&(i=e=t,t=void 0),t&&console.error(t),(i=i??t?.cause)&&console.error("cause:",i),e=e??t?.message??"The puzzle has encountered an error, please consider reporting.",i0.message.textContent=e,document.body.classList.add(i1.Events.Error)}#Q(t){this.debug&&"s"===t.key&&this.update()}#tt(t){console.debug("Mask event",t),this.mask(t.detail.mask)}#J(t){let e=t.detail.tile;this.#U.sort(t=>e.items.some(e=>e===t)?-1:0).forEach(e=>e.onModifierInvoked(t,this)),setTimeout(()=>this.update(),0)}#ti(t){let e=t.downPoint.subtract(t.point).add(a(d).view.center);a(d).view.center.subtract(e).length>1&&(this.#$||document.body.classList.add("grab"),this.#$=!0,a(d).view.center=e)}#tn(t){this.#$||this.#h(t),this.#$=!1,document.body.classList.remove("grab")}#tl(){if(this.solved)return;this.solved=!0,this.updateSelectedTile(void 0),this.mask(i1.#tu);let t=document.createElement("span");t.classList.add("material-symbols-outlined"),t.textContent="celebration",t.title="Solved!",i0.message.replaceChildren(t),document.body.classList.add(i1.Events.Solved),is(i1.Events.Solved)}#te(){this.updateState()}#tr(){this.#t&&this.#tc(),this.#td(),is(i1.Events.Updated,{state:this.#t})}#tf(){Object.values(this.layers).forEach(t=>t.removeChildren()),a(d).project.clear()}#td(){id.uniqueId=0;let{layout:t,message:e,solution:i}=this.#t.getCurrent();this.layout=new iD(t),this.message=e,this.#H=new iY(i),this.#W=this.layout.tiles,this.#G=this.layout.items.filter(t=>t.type===id.Types.terminus),this.#U=this.#G.flatMap(t=>t.beams),this.#r.addEventListeners(),this.#th();let n=this.#t.getSelectedTile(),r=n?this.layout.getTileByOffset(new f(...n.split(","))):void 0;this.updateSelectedTile(r),this.update()}#tc(){document.body.classList.remove(...Object.values(i1.Events)),this.#r.removeEventListeners(),this.#tf(),this.#W.forEach(t=>t.teardown()),this.#W=[],this.#H?.teardown(),this.#H=void 0,this.solved=!1,this.layout?.teardown(),this.layout=void 0,this.selectedTile=void 0,this.#U=[],this.#q={},this.#$=!1,this.#Z=!1,this.#s=void 0,this.#G=[]}#to(){let t=this.#U.filter(t=>t.isPending());if(!t.length){this.#Z=!1,setTimeout(()=>{this.#Y=[],this.#H.isSolved()&&this.#tl()},0);return}this.debug&&this.layers.debug.clear();let e=Object.fromEntries(t.map(t=>[t.toString(),t.step(this)]));if(this.#Y.some(t=>ir(t,e)))throw console.debug("updateBeams:",e),this.#ts(),Error("Infinite loop detected, exiting.");this.#Y.push(e),this.#to()}#ta(t){if(t){let e=t.items.map(e=>e.getColorElements(t)).find(t=>t.length>0)||[];i0.message.replaceChildren(...e)}else i0.message.textContent=this.message||"Select a tile"}static Collision=class{constructor(t,e,i,n){this.id=i1.Collision.id(i),this.layer=t,this.beams=e,this.point=i,this.item=n}addBeam(t){return this.beams.some(e=>e.id===t.id)||this.beams.push(t),this.beams}addItem(t){this.item=new ij({center:this.point,color:t}),this.layer.addChild(this.item.group)}getColor(){return this.beams.length?a(e2).average(this.beams.map(t=>t.getColor())).hex():void 0}removeItem(){this.item&&(this.item.remove(),this.item=void 0)}update(){this.beams=this.beams.filter(t=>ia(t.getStep()?.state.get(iw.Collision)?.point,this.point));let t=this.getColor();this.item&&(!this.beams.length||this.item.color!==t)&&this.removeItem(),this.beams.length&&!this.item&&this.addItem(t)}static id(t){let e=t.round();return[e.x,e.y].join(",")}};static Events=Object.freeze({Error:"puzzle-error",Mask:"puzzle-mask",Solved:"puzzle-solved",Updated:"puzzle-updated"});static Mask=class{constructor(t,e={}){e.style=e.style||{},this.configuration=e,this.filter=t,this.onClick=e.onClick,this.onUnmask=e.onUnmask}};static #tp=t=>t.type===id.Types.beam&&t.isConnected();static #tu=new i1.Mask(t=>t.items.some(i1.#tp),{style:t=>{let e=t.items.filter(i1.#tp).flatMap(e=>e.getSteps(t).flatMap(t=>t.color));return{fillColor:a(e2).average(e).hex()}}})}const i2=Object.freeze({dialog:document.getElementById("dialog"),info:document.getElementById("info"),main:document.getElementById("main"),message:document.getElementById("message"),next:document.getElementById("next"),previous:document.getElementById("previous"),puzzle:document.getElementById("puzzle"),puzzleId:document.getElementById("puzzle-id"),redo:document.getElementById("redo"),reset:document.getElementById("reset"),title:document.querySelector("title"),undo:document.getElementById("undo")}),i5=new i1(i2.puzzle);for(const t of(i2.info.addEventListener("click",()=>{i2.dialog.open||i2.dialog.showModal()}),i2.next.addEventListener("click",i5.next.bind(i5)),i2.previous.addEventListener("click",i5.previous.bind(i5)),i2.redo.addEventListener("click",i5.redo.bind(i5)),i2.reset.addEventListener("click",i5.reset.bind(i5)),i2.undo.addEventListener("click",i5.undo.bind(i5)),iq.visible.ids)){let e=document.createElement("option");e.value=t,e.innerText=iq.titles[t],i2.puzzleId.append(e)}function i3(){let{width:t,height:e}=i2.main.getBoundingClientRect();i2.puzzle.style.height=e+"px",i2.puzzle.style.width=t+"px",a(d).view?.viewSize&&(a(d).view.viewSize=new d.Size(t,e))}i2.puzzleId.addEventListener("change",t=>i5.select(t.target.value)),document.addEventListener(i1.Events.Updated,t=>{let e=t.detail.state,i=e.getId(),n=e.getTitle();i2.title.textContent=`Beaming: Puzzle ${n}`,function(t,...e){e.forEach(e=>e.classList.remove(t))}("disabled",...Array.from(document.querySelectorAll("#actions li")));let r=[];e.canUndo()||r.push(i2.undo),e.canRedo()||r.push(i2.redo),iq.visible.has(i)?(i2.puzzleId.value=i,i===iq.visible.firstId?r.push(i2.previous):i===iq.visible.lastId&&r.push(i2.next)):(i2.puzzleId.value="",r.push(i2.previous,i2.next)),function(t,...e){e.forEach(e=>e.classList.add(t))}("disabled",...r)}),window.addEventListener("resize",function(t,e=500){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>{t(...n)},e)}}(i3)),i3(),i2.puzzle.addEventListener("wheel",t=>{t.preventDefault();let e=a(d).view.zoom*(t.deltaY>0?.95:1.05);if(e>2||e<.5)return;let i=a(d).view.viewToProject(new d.Point(t.offsetX,t.offsetY)),n=i.subtract(a(d).view.center),r=i.subtract(n.multiply(a(d).view.zoom/e)).subtract(a(d).view.center);a(d).view.zoom=e,a(d).view.center=a(d).view.center.add(r)},{passive:!1}),document.body.addEventListener("contextmenu",t=>{if(!i2.dialog.open)return t.preventDefault(),!1}),i5.select(),window.beaming={paper:a(d),puzzle:i5},window.beaming.drawDebugPoint=function(t,e,i){return i5.drawDebugPoint(new(a(d)).Point(t,e),i)};
//# sourceMappingURL=index.96003036.js.map
